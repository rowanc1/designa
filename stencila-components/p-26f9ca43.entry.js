import{r as e,c as t,h as i,H as c,a}from"./p-717250b8.js";import{l as o}from"./p-34b40baa.js";const n=class{constructor(c){e(this,c),this.setAllCodeVisibility=t(this,"setAllCodeVisibility",7),this.autofocus=!1,this.isCodeCollapsed=!1,this.isCodeVisible=!1,this.keymap=[],this.executeCodeState="INITIAL",this.isCodeVisibleState=this.isCodeVisible,this.toggleCodeVisibility=e=>{e.shiftKey?this.toggleAllCodeVisibility():this.isCodeVisibleState=!this.isCodeVisibleState},this.toggleAllCodeVisibility=()=>this.setAllCodeVisibilityHandler(!this.isCodeVisibleState),this.onExecuteHandler=async()=>{this.executeCodeState="PENDING";const e=await this.getContents();if(void 0!==this.executeHandler){const t=await this.executeHandler(e);return this.executeCodeState="RESOLVED",this.updateErrors(t.errors),this.outputs=t.outputs,t}return this.executeCodeState="RESOLVED",e},this.executeRef=()=>this.execute(),this.updateErrors=(e=[])=>{this.codeErrors=e.map((e=>i("stencila-code-error",{kind:e.errorType,hasStacktrace:void 0!==e.stackTrace},e.errorMessage,i("pre",{slot:"stacktrace"},e.stackTrace))))},this.setCodeVisibility=e=>{var t;this.isCodeVisibleState=null!==(t=e.detail.isVisible)&&void 0!==t?t:e.detail.isCodeCollapsed}}onSetAllCodeVisibility(e){this.setCodeVisibility(e)}componentDidLoad(){this.editorRef=this.el.querySelector("stencila-editor")}async getContents(){var e;if(this.editorRef){const{text:t,language:i}=await(null===(e=this.editorRef)||void 0===e?void 0:e.getContents());return o({text:t,programmingLanguage:i})}return o({text:""})}async execute(){this.executeCodeState="PENDING";try{const e=await this.onExecuteHandler();return window.setTimeout((()=>this.executeCodeState="RESOLVED"),250),e}catch(e){return console.error(e),this.executeCodeState="RESOLVED",e}}setAllCodeVisibilityHandler(e){this.setAllCodeVisibility.emit({isVisible:e})}render(){return i(c,{class:{isCodeVisible:this.isCodeVisibleState}},i("stencila-action-menu",{expandable:!0},void 0!==this.executeHandler&&i("stencila-button",{icon:"play",minimal:!0,color:"key",class:"run",size:"xsmall",tooltip:"Run",iconOnly:!0,slot:"persistentActions",onClick:this.executeRef,isLoading:"PENDING"===this.executeCodeState}),i("stencila-button",{minimal:!0,color:"key",class:"sourceToggle",onClick:this.toggleCodeVisibility,icon:this.isCodeVisibleState?"eye-off":"eye",iconOnly:!0,size:"xsmall",slot:"persistentActions",tooltip:(this.isCodeVisibleState?"Hide":"Show")+" Code"})),i("div",null,i("div",{class:{editorContainer:!0,hidden:!this.isCodeVisibleState}},i("stencila-editor",{activeLanguage:this.programmingLanguageProp,autofocus:this.autofocus,executeHandler:this.onExecuteHandler,keymap:this.keymap,readOnly:void 0===this.executeHandler},i("slot",{name:n.slots.text}))),i("stencila-node-list",{nodes:this.outputs},i("slot",{name:n.slots.outputs}),this.codeErrors)))}get el(){return a(this)}};n.slots={text:"text",outputs:"outputs"},n.style={default:"*.sc-stencila-code-chunk-default,.sc-stencila-code-chunk-default:after,.sc-stencila-code-chunk-default:before{-webkit-box-sizing:border-box;box-sizing:border-box;border:0 solid}html.sc-stencila-code-chunk-default{font-size:16px}.hidden.sc-stencila-code-chunk-default{display:none}code.sc-stencila-code-chunk-default,code[class*=language-].sc-stencila-code-chunk-default,output.sc-stencila-code-chunk-default{font-family:monospace;font-family:var(--font-family-mono,monospace);font-size:75%}pre.sc-stencila-code-chunk-default{border:1px solid #e2e8f0;border-color:var(--color-neutral-300,#e2e8f0);border-radius:.25rem;padding:.5rem;margin:.5rem;overflow:auto}.preReset.sc-stencila-code-chunk-default{padding:0;margin:0;border-width:0}.sc-stencila-code-chunk-default-h,stencila-code-chunk.sc-stencila-code-chunk-default{--background:var(--color-stock,#fff);--background-editor:var(--color-neutral-200,#edf2f7);--border:var(--color-neutral-300,#e2e8f0);position:relative;display:block;width:100%;margin-top:1rem;margin-bottom:1rem;overflow:hidden;border-width:1px;border-style:solid;border-radius:.25rem;border-color:var(--border)}.sc-stencila-code-chunk-default-h stencila-action-menu.sc-stencila-code-chunk-default,stencila-code-chunk.sc-stencila-code-chunk-default stencila-action-menu.sc-stencila-code-chunk-default{position:relative;display:block;width:100%;padding:0;border-left-width:0;border-right-width:0;border-radius:0}.sc-stencila-code-chunk-default-h stencila-editor.sc-stencila-code-chunk-default,stencila-code-chunk.sc-stencila-code-chunk-default stencila-editor.sc-stencila-code-chunk-default{--border-width:0;-ms-flex-positive:1;flex-grow:1}.sc-stencila-code-chunk-default-h stencila-node-list.sc-stencila-code-chunk-default,stencila-code-chunk.sc-stencila-code-chunk-default stencila-node-list.sc-stencila-code-chunk-default{padding:.5rem;margin:0;background-color:var(--background)}.editorContainer.sc-stencila-code-chunk-default{position:relative;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex:1 1 auto;flex:1 1 auto;margin:0;border-width:0 0 1px;border-radius:0;background:var(--background-editor);border-color:var(--border);height:intrinsic}.editorContainer.sc-stencila-code-chunk-default pre.sc-stencila-code-chunk-default,.editorContainer.sc-stencila-code-chunk-default pre[class*=language-].sc-stencila-code-chunk-default{background-color:transparent}.editorContainer.hidden.sc-stencila-code-chunk-default{display:none}@media (min-width:1024px){.sc-stencila-code-chunk-default-h>div.sc-stencila-code-chunk-default,stencila-code-chunk.sc-stencila-code-chunk-default>div.sc-stencila-code-chunk-default{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-align:stretch;align-items:stretch;width:100%}.editorContainer.sc-stencila-code-chunk-default{width:50%;border-bottom-width:0;border-right-width:1px}stencila-node-list.sc-stencila-code-chunk-default{-ms-flex-positive:1;flex-grow:1;width:50%}}",material:"*.sc-stencila-code-chunk-material,.sc-stencila-code-chunk-material:after,.sc-stencila-code-chunk-material:before{-webkit-box-sizing:border-box;box-sizing:border-box;border:0 solid}html.sc-stencila-code-chunk-material{font-size:16px}.hidden.sc-stencila-code-chunk-material{display:none}code.sc-stencila-code-chunk-material,code[class*=language-].sc-stencila-code-chunk-material,output.sc-stencila-code-chunk-material{font-family:monospace;font-family:var(--font-family-mono,monospace);font-size:75%}pre.sc-stencila-code-chunk-material{border:1px solid #e2e8f0;border-color:var(--color-neutral-300,#e2e8f0);border-radius:.25rem;padding:.5rem;margin:.5rem;overflow:auto}.preReset.sc-stencila-code-chunk-material{padding:0;margin:0;border-width:0}.sc-stencila-code-chunk-material-h,stencila-code-chunk.sc-stencila-code-chunk-material{--background:var(--color-stock,#fff);--background-editor:var(--color-neutral-200,#edf2f7);--border:var(--color-neutral-300,#e2e8f0);position:relative;display:block;width:100%;margin-top:1rem;margin-bottom:1rem;overflow:hidden;border-width:1px;border-style:solid;border-radius:.25rem;border-color:var(--border)}.sc-stencila-code-chunk-material-h stencila-action-menu.sc-stencila-code-chunk-material,stencila-code-chunk.sc-stencila-code-chunk-material stencila-action-menu.sc-stencila-code-chunk-material{position:relative;display:block;width:100%;padding:0;border-left-width:0;border-right-width:0;border-radius:0}.sc-stencila-code-chunk-material-h stencila-editor.sc-stencila-code-chunk-material,stencila-code-chunk.sc-stencila-code-chunk-material stencila-editor.sc-stencila-code-chunk-material{--border-width:0;-ms-flex-positive:1;flex-grow:1}.sc-stencila-code-chunk-material-h stencila-node-list.sc-stencila-code-chunk-material,stencila-code-chunk.sc-stencila-code-chunk-material stencila-node-list.sc-stencila-code-chunk-material{padding:.5rem;margin:0;background-color:var(--background)}.editorContainer.sc-stencila-code-chunk-material{position:relative;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex:1 1 auto;flex:1 1 auto;margin:0;border-width:0 0 1px;border-radius:0;background:var(--background-editor);border-color:var(--border);height:intrinsic}.editorContainer.sc-stencila-code-chunk-material pre.sc-stencila-code-chunk-material,.editorContainer.sc-stencila-code-chunk-material pre[class*=language-].sc-stencila-code-chunk-material{background-color:transparent}.editorContainer.hidden.sc-stencila-code-chunk-material{display:none}@media (min-width:1024px){.sc-stencila-code-chunk-material-h>div.sc-stencila-code-chunk-material,stencila-code-chunk.sc-stencila-code-chunk-material>div.sc-stencila-code-chunk-material{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-align:stretch;align-items:stretch;width:100%}.editorContainer.sc-stencila-code-chunk-material{width:50%;border-bottom-width:0;border-right-width:1px}stencila-node-list.sc-stencila-code-chunk-material{-ms-flex-positive:1;flex-grow:1;width:50%}}"};export{n as stencila_code_chunk}