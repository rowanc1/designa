var __extends=this&&this.__extends||function(){var e=function(t,r){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r))e[r]=t[r]};return e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var __awaiter=this&&this.__awaiter||function(e,t,r,n){function i(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,o){function a(e){try{l(n.next(e))}catch(t){o(t)}}function s(e){try{l(n["throw"](e))}catch(t){o(t)}}function l(e){e.done?r(e.value):i(e.value).then(a,s)}l((n=n.apply(e,t||[])).next())}))};var __generator=this&&this.__generator||function(e,t){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(e){return function(t){return l([e,t])}}function l(a){if(n)throw new TypeError("Generator is already executing.");while(r)try{if(n=1,i&&(o=a[0]&2?i["return"]:a[0]?i["throw"]||((o=i["return"])&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;if(i=0,o)a=[a[0]&2,o.value];switch(a[0]){case 0:case 1:o=a;break;case 4:r.label++;return{value:a[1],done:false};case 5:r.label++;i=a[1];a=[0];continue;case 7:a=r.ops.pop();r.trys.pop();continue;default:if(!(o=r.trys,o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){r.label=a[1];break}if(a[0]===6&&r.label<o[1]){r.label=o[1];o=a;break}if(o&&r.label<o[2]){r.label=o[2];r.ops.push(a);break}if(o[2])r.ops.pop();r.trys.pop();continue}a=t.call(e,r)}catch(s){a=[6,s];i=0}finally{n=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};var __spreadArrays=this&&this.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)n[i]=o[a];return n};var _g;import{r as registerInstance,h,a as getElement,H as Host}from"./index-9edcbeb0.js";import{c as createCommonjsModule,a as commonjsGlobal}from"./_commonjsHelpers-8a9f3b18.js";import{z as zt,U as Ut,N as Nt}from"./schema-ceac4a12.js";import{_ as _function}from"./function-89e98342.js";var defaultActionMenuCss=".sc-stencila-action-menu-default-h{--background:var(--color-neutral-200,#edf2f7);--border:var(--color-neutral-300,#e2e8f0);position:absolute;top:0;right:0;z-index:10;padding:1px .25rem;font-family:monospace;font-family:var(--font-family-mono,monospace);font-size:.75rem;line-height:1;border-width:0 0 1px 1px;border-style:solid;border-bottom-left-radius:.25rem;background-color:var(--background);border-color:var(--border)}.sc-stencila-action-menu-default-h .hidden.sc-stencila-action-menu-default{display:none}.sc-stencila-action-menu-default-h nav.sc-stencila-action-menu-default>*.sc-stencila-action-menu-default{vertical-align:middle}.sc-stencila-action-menu-default-h ul.sc-stencila-action-menu-default{padding:0;margin:0;list-style-type:none}.sc-stencila-action-menu-default-h li.sc-stencila-action-menu-default{display:inline;padding-right:.25rem}.sc-stencila-action-menu-default-h li.sc-stencila-action-menu-default:last-child{padding-right:0}.sc-stencila-action-menu-default-h stencila-button.sc-stencila-action-menu-default{display:inline-block}.sc-stencila-action-menu-default-h .actionContainer.sc-stencila-action-menu-default{display:inline-block;overflow:hidden;white-space:nowrap;vertical-align:middle;width:var(--max-width);-webkit-transition:width .12s ease-in-out;transition:width .12s ease-in-out}.sc-stencila-action-menu-default-h .actionContainer.sc-stencila-action-menu-default:not(.isAnimating):not(.isCollapsed){width:auto}.sc-stencila-action-menu-default-h .secondaryActions.sc-stencila-action-menu-default:not(:hover):not(:focus) .actionContainer.isCollapsed.sc-stencila-action-menu-default{width:0}";var materialActionMenuCss=".sc-stencila-action-menu-material-h{--background:var(--color-neutral-200,#edf2f7);--border:var(--color-neutral-300,#e2e8f0);position:absolute;top:0;right:0;z-index:10;padding:1px .25rem;font-family:monospace;font-family:var(--font-family-mono,monospace);font-size:.75rem;line-height:1;border-width:0 0 1px 1px;border-style:solid;border-bottom-left-radius:.25rem;background-color:var(--background);border-color:var(--border)}.sc-stencila-action-menu-material-h .hidden.sc-stencila-action-menu-material{display:none}.sc-stencila-action-menu-material-h nav.sc-stencila-action-menu-material>*.sc-stencila-action-menu-material{vertical-align:middle}.sc-stencila-action-menu-material-h ul.sc-stencila-action-menu-material{padding:0;margin:0;list-style-type:none}.sc-stencila-action-menu-material-h li.sc-stencila-action-menu-material{display:inline;padding-right:.25rem}.sc-stencila-action-menu-material-h li.sc-stencila-action-menu-material:last-child{padding-right:0}.sc-stencila-action-menu-material-h stencila-button.sc-stencila-action-menu-material{display:inline-block}.sc-stencila-action-menu-material-h .actionContainer.sc-stencila-action-menu-material{display:inline-block;overflow:hidden;white-space:nowrap;vertical-align:middle;width:var(--max-width);-webkit-transition:width .12s ease-in-out;transition:width .12s ease-in-out}.sc-stencila-action-menu-material-h .actionContainer.sc-stencila-action-menu-material:not(.isAnimating):not(.isCollapsed){width:auto}.sc-stencila-action-menu-material-h .secondaryActions.sc-stencila-action-menu-material:not(:hover):not(:focus) .actionContainer.isCollapsed.sc-stencila-action-menu-material{width:0}";var slots={default:"",persistentActions:"persistentActions"};var ActionMenu=function(){function e(e){var t=this;registerInstance(this,e);this.expandable=false;this.isCollapsed=false;this.toggleActionMenu=function(){return t.isCollapsed=!t.isCollapsed};this.width="auto";this.isAnimating=false;this.isTransitioning=false;this.calculateWidth=function(){if(t.actionContainerRef!==null&&t.isTransitioning===false){t.width="auto";var e=t.actionContainerRef.getBoundingClientRect().width;t.width=e+"px"}};this.observer=new window.MutationObserver(this.calculateWidth);this.checkForSecondaryActions=function(){var e;var r=((e=t.el.querySelector(".secondaryActions .actionContainer"))===null||e===void 0?void 0:e.innerHTML.trim())==="";t.hasSecondaryActions=r;return r}}e.prototype.componentDidLoad=function(){var e=this;this.checkForSecondaryActions();if(this.expandable){this.actionContainerRef=this.el.querySelector(".actionContainer");if(this.actionContainerRef!==null){this.actionContainerRef.addEventListener("transitionstart",(function(){return e.isTransitioning=true}));this.actionContainerRef.addEventListener("transitionend",(function(){return e.isTransitioning=false}));this.observer.observe(this.el,{characterData:true,subtree:true});this.calculateWidth();this.isCollapsed=true}}};e.prototype.disconnectedCallback=function(){this.observer.disconnect()};e.prototype.render=function(){return h("nav",null,h("span",{class:{secondaryActions:true,hidden:this.hasSecondaryActions}},h("span",{class:{actionContainer:true,isAnimating:this.isAnimating,isCollapsed:this.isCollapsed},style:{"--max-width":this.width}},h("slot",null)),h("stencila-button",{onClick:this.toggleActionMenu,icon:"more",color:"key",minimal:true,size:"xsmall",iconOnly:true,ariaLabel:"Toggle Action Menu"})),h("span",{class:"persistentActions"},h("slot",{name:slots.persistentActions})))};Object.defineProperty(e.prototype,"el",{get:function(){return getElement(this)},enumerable:false,configurable:true});return e}();ActionMenu.style={default:defaultActionMenuCss,material:materialActionMenuCss};var defaultErrorCss=".sc-stencila-code-error-default-h,stencila-code-error.sc-stencila-code-error-default{position:relative;display:block;width:100%;padding:.5rem;border-radius:.25rem;font-family:sans-serif;font-family:var(--font-family-body,sans-serif);border-color:#ed8936;border-color:var(--color-warn-500,#ed8936);background-color:#fffaf0;background-color:var(--color-warn-100,#fffaf0);color:#7b341e;color:var(--color-warn-900,#7b341e)}.sc-stencila-code-error-default-h .overview.sc-stencila-code-error-default *.sc-stencila-code-error-default,stencila-code-error.sc-stencila-code-error-default .overview.sc-stencila-code-error-default *.sc-stencila-code-error-default{vertical-align:middle}.sc-stencila-code-error-default-h .overview.sc-stencila-code-error-default stencila-icon.sc-stencila-code-error-default,stencila-code-error.sc-stencila-code-error-default .overview.sc-stencila-code-error-default stencila-icon.sc-stencila-code-error-default{margin-right:.5rem}.sc-stencila-code-error-default-h [slot=summary].sc-stencila-code-error-default,stencila-code-error.sc-stencila-code-error-default [slot=summary].sc-stencila-code-error-default{font-size:.75rem;letter-spacing:.05em;text-transform:uppercase}.sc-stencila-code-error-default-h stencila-details.sc-stencila-code-error-default,stencila-code-error.sc-stencila-code-error-default stencila-details.sc-stencila-code-error-default{display:block}.sc-stencila-code-error-default-h [slot=stacktrace].sc-stencila-code-error-default,stencila-code-error.sc-stencila-code-error-default [slot=stacktrace].sc-stencila-code-error-default{margin:0;background-color:#fff;background-color:var(--color-stock,#fff);border-color:#ed8936;border-color:var(--color-warn-500,#ed8936);color:#000;color:var(--color-key,#000)}[kind=error].sc-stencila-code-error-default-h,[kind=incapable].sc-stencila-code-error-default-h,stencila-code-error[kind=error].sc-stencila-code-error-default,stencila-code-error[kind=incapable].sc-stencila-code-error-default{border-color:#f56565;border-color:var(--color-danger-500,#f56565);background-color:#fff5f5;background-color:var(--color-danger-100,#fff5f5);color:#742a2a;color:var(--color-danger-900,#742a2a)}[kind=error].sc-stencila-code-error-default-h [slot=stacktrace].sc-stencila-code-error-default,[kind=incapable].sc-stencila-code-error-default-h [slot=stacktrace].sc-stencila-code-error-default,stencila-code-error[kind=error].sc-stencila-code-error-default [slot=stacktrace].sc-stencila-code-error-default,stencila-code-error[kind=incapable].sc-stencila-code-error-default [slot=stacktrace].sc-stencila-code-error-default{border-color:#f56565;border-color:var(--color-danger-500,#f56565)}";var materialErrorCss=".sc-stencila-code-error-material-h,stencila-code-error.sc-stencila-code-error-material{position:relative;display:block;width:100%;padding:.5rem;border-radius:.25rem;font-family:sans-serif;font-family:var(--font-family-body,sans-serif);border-color:#ed8936;border-color:var(--color-warn-500,#ed8936);background-color:#fffaf0;background-color:var(--color-warn-100,#fffaf0);color:#7b341e;color:var(--color-warn-900,#7b341e)}.sc-stencila-code-error-material-h .overview.sc-stencila-code-error-material *.sc-stencila-code-error-material,stencila-code-error.sc-stencila-code-error-material .overview.sc-stencila-code-error-material *.sc-stencila-code-error-material{vertical-align:middle}.sc-stencila-code-error-material-h .overview.sc-stencila-code-error-material stencila-icon.sc-stencila-code-error-material,stencila-code-error.sc-stencila-code-error-material .overview.sc-stencila-code-error-material stencila-icon.sc-stencila-code-error-material{margin-right:.5rem}.sc-stencila-code-error-material-h [slot=summary].sc-stencila-code-error-material,stencila-code-error.sc-stencila-code-error-material [slot=summary].sc-stencila-code-error-material{font-size:.75rem;letter-spacing:.05em;text-transform:uppercase}.sc-stencila-code-error-material-h stencila-details.sc-stencila-code-error-material,stencila-code-error.sc-stencila-code-error-material stencila-details.sc-stencila-code-error-material{display:block}.sc-stencila-code-error-material-h [slot=stacktrace].sc-stencila-code-error-material,stencila-code-error.sc-stencila-code-error-material [slot=stacktrace].sc-stencila-code-error-material{margin:0;background-color:#fff;background-color:var(--color-stock,#fff);border-color:#ed8936;border-color:var(--color-warn-500,#ed8936);color:#000;color:var(--color-key,#000)}[kind=error].sc-stencila-code-error-material-h,[kind=incapable].sc-stencila-code-error-material-h,stencila-code-error[kind=error].sc-stencila-code-error-material,stencila-code-error[kind=incapable].sc-stencila-code-error-material{border-color:#f56565;border-color:var(--color-danger-500,#f56565);background-color:#fff5f5;background-color:var(--color-danger-100,#fff5f5);color:#742a2a;color:var(--color-danger-900,#742a2a)}[kind=error].sc-stencila-code-error-material-h [slot=stacktrace].sc-stencila-code-error-material,[kind=incapable].sc-stencila-code-error-material-h [slot=stacktrace].sc-stencila-code-error-material,stencila-code-error[kind=error].sc-stencila-code-error-material [slot=stacktrace].sc-stencila-code-error-material,stencila-code-error[kind=incapable].sc-stencila-code-error-material [slot=stacktrace].sc-stencila-code-error-material{border-color:#f56565;border-color:var(--color-danger-500,#f56565)}";var Error$1=function(){function e(e){registerInstance(this,e);this.open=false;this.kind="warning"}e.prototype.render=function(){return h(Host,{kind:this.kind},h("div",{class:"overview"},h("stencila-icon",{icon:"alert"}),h("slot",null)),this.hasStacktrace&&h("stencila-details",null,h("span",{slot:"summary"},"View the stacktrace"),h("slot",{name:"stacktrace"})))};return e}();Error$1.style={default:defaultErrorCss,material:materialErrorCss};var extend="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map((function(e){return e?parseInt(e,36):1}));for(var i_1=1;i_1<extend.length;i_1++)extend[i_1]+=extend[i_1-1];function isExtendingChar(e){for(var t=1;t<extend.length;t+=2)if(extend[t]>e)return extend[t-1]<=e;return false}function isRegionalIndicator(e){return e>=127462&&e<=127487}var ZWJ=8205;function nextClusterBreak(e,t){if(t==e.length)return t;if(t&&surrogateLow(e.charCodeAt(t))&&surrogateHigh(e.charCodeAt(t-1)))t--;var r=codePointAt(e,t);t+=codePointSize(r);while(t<e.length){var n=codePointAt(e,t);if(r==ZWJ||n==ZWJ||isExtendingChar(n)){t+=codePointSize(n);r=n}else if(isRegionalIndicator(n)){var i=0,o=t-2;while(o>=0&&isRegionalIndicator(codePointAt(e,o))){i++;o-=2}if(i%2==0)break;else t+=2}else{break}}return t}function prevClusterBreak(e,t){while(t>0){var r=nextClusterBreak(e,t-2);if(r<t)return r;t--}return 0}function surrogateLow(e){return e>=56320&&e<57344}function surrogateHigh(e){return e>=55296&&e<56320}function codePointAt(e,t){var r=e.charCodeAt(t);if(!surrogateHigh(r)||t+1==e.length)return r;var n=e.charCodeAt(t+1);if(!surrogateLow(n))return r;return(r-55296<<10)+(n-56320)+65536}function fromCodePoint(e){if(e<=65535)return String.fromCharCode(e);e-=65536;return String.fromCharCode((e>>10)+55296,(e&1023)+56320)}function codePointSize(e){return e<65536?1:2}function countColumn(e,t,r){for(var n=0;n<e.length;){if(e.charCodeAt(n)==9){t+=r-t%r;n++}else{t++;n=nextClusterBreak(e,n)}}return t}function findColumn(e,t,r,n){for(var i=0;i<e.length;){if(t>=r)return{offset:i,leftOver:0};t+=e.charCodeAt(i)==9?n-t%n:1;i=nextClusterBreak(e,i)}return{offset:e.length,leftOver:r-t}}var Text=function(){function e(){}e.prototype.lineAt=function(e){if(e<0||e>this.length)throw new RangeError("Invalid position "+e+" in document of length "+this.length);for(var t=0,r=lineCache;t<r.length;t++){var n=r[t];if(n.doc==this&&n.from<=e&&n.to>=e)return n}return cacheLine(this.lineInner(e,false,1,0).finish(this))};e.prototype.line=function(e){if(e<1||e>this.lines)throw new RangeError("Invalid line number "+e+" in "+this.lines+"-line document");for(var t=0,r=lineCache;t<r.length;t++){var n=r[t];if(n.doc==this&&n.number==e)return n}return cacheLine(this.lineInner(e,true,1,0).finish(this))};e.prototype.replace=function(e,t,r){var n=[];this.decompose(0,e,n);n.push(r);this.decompose(t,this.length,n);return TextNode.from(n,this.length-(t-e)+r.length)};e.prototype.append=function(e){return this.length==0?e:e.length==0?this:TextNode.from([this,e],this.length+e.length)};e.prototype.slice=function(e,t){if(t===void 0){t=this.length}var r=[];this.decompose(e,t,r);return TextNode.from(r,t-e)};e.prototype.eq=function(e){return this==e||eqContent(this,e)};e.prototype.iter=function(e){if(e===void 0){e=1}return new RawTextCursor(this,e)};e.prototype.iterRange=function(e,t){if(t===void 0){t=this.length}return new PartialTextCursor(this,e,t)};e.prototype.iterLines=function(e){if(e===void 0){e=0}return new LineCursor(this,e)};e.prototype.toString=function(){return this.sliceString(0)};e.prototype.toJSON=function(){var e=[];for(var t=this.iterLines();!t.next().done;)e.push(t.value);return e};e.of=function(t){if(t.length==0)throw new RangeError("A document must have at least one line");if(t.length==1&&!t[0]&&e.empty)return e.empty;var r=textLength(t);return r<1024?new TextLeaf(t,r):TextNode.from(TextLeaf.split(t,[]),r)};return e}();if(typeof Symbol!="undefined")Text.prototype[Symbol.iterator]=function(){return this.iter()};var lineCache=[],lineCachePos=-1,lineCacheSize=10;function cacheLine(e){return lineCache[lineCachePos=(lineCachePos+1)%lineCacheSize]=e}var TextLeaf=function(e){__extends(t,e);function t(t,r){if(r===void 0){r=textLength(t)}var n=e.call(this)||this;n.text=t;n.length=r;return n}Object.defineProperty(t.prototype,"lines",{get:function(){return this.text.length},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"children",{get:function(){return null},enumerable:false,configurable:true});t.prototype.lineInner=function(e,t,r,n){for(var i=0;;i++){var o=this.text[i],a=n+o.length;if((t?r:a)>=e)return new Line(n,a,r,o);n=a+1;r++}};t.prototype.decompose=function(e,r,n){n.push(new t(sliceText(this.text,e,r),Math.min(r,this.length)-Math.max(0,e)))};t.prototype.lastLineLength=function(){return this.text[this.text.length-1].length};t.prototype.firstLineLength=function(){return this.text[0].length};t.prototype.replace=function(r,n,i){var o=this.length+i.length-(n-r);if(o>=1024||!(i instanceof t))return e.prototype.replace.call(this,r,n,i);return new t(appendText(this.text,appendText(i.text,sliceText(this.text,0,r)),n),o)};t.prototype.sliceString=function(e,t,r){if(t===void 0){t=this.length}if(r===void 0){r="\n"}var n="";for(var i=0,o=0;i<=t&&o<this.text.length;o++){var a=this.text[o],s=i+a.length;if(i>e&&o)n+=r;if(e<s&&t>i)n+=a.slice(Math.max(0,e-i),t-i);i=s+1}return n};t.prototype.flatten=function(e){e[e.length-1]+=this.text[0];for(var t=1;t<this.text.length;t++)e.push(this.text[t])};t.split=function(e,r){var n=[],i=-1;for(var o=0,a=e;o<a.length;o++){var s=a[o];for(;;){var l=i+s.length+1;if(l<512){i=l;n.push(s);break}var c=512-i-1,u=s.charCodeAt(c);if(u>=56320&&u<57344)c++;n.push(s.slice(0,c));r.push(new t(n,512));s=s.slice(c);i=-1;n=[]}}if(i!=-1)r.push(new t(n,i));return r};return t}(Text);var TextNode=function(e){__extends(t,e);function t(t,r){var n=e.call(this)||this;n.children=t;n.length=r;n.lines=1;for(var i=0,o=t;i<o.length;i++){var a=o[i];n.lines+=a.lines-1}return n}t.prototype.lineInner=function(e,t,r,n){for(var i=0;;i++){var o=this.children[i],a=n+o.length,s=r+o.lines-1;if((t?s:a)>=e){var l=o.lineInner(e,t,r,n),c=void 0;if(l.from==n&&(c=this.lineLengthTo(i))){l.from-=c;l.content=null}if(l.to==a&&(c=this.lineLengthFrom(i+1))){l.to+=c;l.content=null}return l}n=a;r=s}};t.prototype.decompose=function(e,t,r){for(var n=0,i=0;i<t&&n<this.children.length;n++){var o=this.children[n],a=i+o.length;if(e<a&&t>i){if(i>=e&&a<=t)r.push(o);else o.decompose(e-i,t-i,r)}i=a}};t.prototype.lineLengthTo=function(e){var t=0;for(var r=e-1;r>=0;r--){var n=this.children[r];if(n.lines>1)return t+n.lastLineLength();t+=n.length}return t};t.prototype.lastLineLength=function(){return this.lineLengthTo(this.children.length)};t.prototype.lineLengthFrom=function(e){var t=0;for(var r=e;r<this.children.length;r++){var n=this.children[r];if(n.lines>1)return t+n.firstLineLength();t+=n.length}return t};t.prototype.firstLineLength=function(){return this.lineLengthFrom(0)};t.prototype.replace=function(r,n,i){if(i.length<512&&n-r<512){var o=i.length-(n-r);for(var a=0,s=0;a<this.children.length;a++){var l=this.children[a],c=s+l.length;if(r>=s&&n<=c&&l.length+o<this.length+o>>3-1&&l.length+o>0){var u=this.children.slice();u[a]=l.replace(r-s,n-s,i);return new t(u,this.length+o)}s=c}}return e.prototype.replace.call(this,r,n,i)};t.prototype.sliceString=function(e,t,r){if(t===void 0){t=this.length}if(r===void 0){r="\n"}var n="";for(var i=0,o=0;o<t&&i<this.children.length;i++){var a=this.children[i],s=o+a.length;if(e<s&&t>o){var l=a.sliceString(e-o,t-o,r);if(e>=o&&t<=s)return l;n+=l}o=s}return n};t.prototype.flatten=function(e){for(var t=0,r=this.children;t<r.length;t++){var n=r[t];n.flatten(e)}};t.from=function(e,r){if(!e.every((function(e){return e instanceof Text})))throw new Error("NOP");if(r<1024){var n=[""];for(var i=0,o=e;i<o.length;i++){var a=o[i];a.flatten(n)}return new TextLeaf(n,r)}var s=Math.max(512,r>>3),l=s<<1,c=s>>1;var u=[],f=0,h=[];function d(e){var r=e.length,n;if(!r)return;if(r>l&&e instanceof t){for(var i=0,o=e.children;i<o.length;i++){var a=o[i];d(a)}}else if(r>c&&(f>c||f==0)){p();u.push(e)}else if(e instanceof TextLeaf&&f>0&&(n=h[h.length-1])instanceof TextLeaf&&e.length+n.length<=512){f+=r;h[h.length-1]=new TextLeaf(appendText(e.text,n.text.slice()),e.length+n.length)}else{if(f+r>s)p();f+=r;h.push(e)}}function p(){if(f==0)return;u.push(h.length==1?h[0]:t.from(h,f));f=0;h.length=0}for(var g=0,m=e;g<m.length;g++){var a=m[g];d(a)}p();return u.length==1?u[0]:new t(u,r)};return t}(Text);Text.empty=Text.of([""]);function textLength(e){var t=-1;for(var r=0,n=e;r<n.length;r++){var i=n[r];t+=i.length+1}return t}function appendText(e,t,r,n){if(r===void 0){r=0}if(n===void 0){n=1e9}for(var i=0,o=0,a=true;o<e.length&&i<=n;o++){var s=e[o],l=i+s.length;if(l>=r){if(l>n)s=s.slice(0,n-i);if(i<r)s=s.slice(r-i);if(a){t[t.length-1]+=s;a=false}else t.push(s)}i=l+1}return t}function sliceText(e,t,r){return appendText(e,[""],t,r)}function eqContent(e,t){if(e.length!=t.length||e.lines!=t.lines)return false;var r=new RawTextCursor(e),n=new RawTextCursor(t);for(var i=0,o=0;;){if(r.lineBreak!=n.lineBreak||r.done!=n.done){return false}else if(r.done){return true}else if(r.lineBreak){r.next();n.next();i=o=0}else{var a=r.value.slice(i),s=n.value.slice(o);if(a.length==s.length){if(a!=s)return false;r.next();n.next();i=o=0}else if(a.length>s.length){if(a.slice(0,s.length)!=s)return false;i+=s.length;n.next();o=0}else{if(s.slice(0,a.length)!=a)return false;o+=a.length;r.next();i=0}}}}var RawTextCursor=function(){function e(e,t){if(t===void 0){t=1}this.dir=t;this.done=false;this.lineBreak=false;this.value="";this.nodes=[e];this.offsets=[t>0?0:e instanceof TextLeaf?e.text.length:e.children.length]}e.prototype.next=function(e){if(e===void 0){e=0}for(;;){var t=this.nodes.length-1;if(t<0){this.done=true;this.value="";this.lineBreak=false;return this}var r=this.nodes[t];var n=this.offsets[t];if(r instanceof TextLeaf){if(n!=(this.dir>0?0:r.text.length)&&!this.lineBreak){this.lineBreak=true;if(e==0){this.value="\n";return this}e--;continue}var i=r.text[n-(this.dir<0?1:0)];this.offsets[t]=n+=this.dir;if(n==(this.dir>0?r.text.length:0)){this.nodes.pop();this.offsets.pop()}this.lineBreak=false;if(i.length>Math.max(0,e)){this.value=e==0?i:this.dir>0?i.slice(e):i.slice(0,i.length-e);return this}e-=i.length}else if(n==(this.dir>0?r.children.length:0)){this.nodes.pop();this.offsets.pop()}else{var i=r.children[this.dir>0?n:n-1],o=i.length;this.offsets[t]=n+this.dir;if(e>o){e-=o}else{this.nodes.push(i);this.offsets.push(this.dir>0?0:i instanceof TextLeaf?i.text.length:i.children.length)}}}};return e}();var PartialTextCursor=function(){function e(e,t,r){this.value="";this.cursor=new RawTextCursor(e,t>r?-1:1);if(t>r){this.skip=e.length-t;this.limit=t-r}else{this.skip=t;this.limit=r-t}}e.prototype.next=function(){if(this.limit<=0){this.limit=-1}else{var e=this.cursor.next(this.skip),t=e.value,r=e.lineBreak,n=e.done;this.skip=0;this.value=t;var i=r?1:t.length;if(i>this.limit)this.value=this.cursor.dir>0?t.slice(0,this.limit):t.slice(i-this.limit);if(n||this.value.length==0)this.limit=-1;else this.limit-=this.value.length}return this};Object.defineProperty(e.prototype,"lineBreak",{get:function(){return this.cursor.lineBreak},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"done",{get:function(){return this.limit<0},enumerable:false,configurable:true});return e}();var LineCursor=function(){function e(e,t){if(t===void 0){t=0}this.value="";this.done=false;this.cursor=e.iter();this.skip=t}e.prototype.next=function(){if(this.cursor.done){this.done=true;this.value="";return this}for(this.value="";;){var e=this.cursor.next(this.skip),t=e.value,r=e.lineBreak,n=e.done;this.skip=0;if(n||r)return this;this.value+=t}};Object.defineProperty(e.prototype,"lineBreak",{get:function(){return false},enumerable:false,configurable:true});return e}();var Line=function(){function e(e,t,r,n){this.from=e;this.to=t;this.number=r;this.content=n}Object.defineProperty(e.prototype,"length",{get:function(){return this.to-this.from},enumerable:false,configurable:true});e.prototype.slice=function(e,t){if(e===void 0){e=0}if(t===void 0){t=this.length}if(e==t)return"";if(typeof this.content=="string")return this.content.slice(e,t);if(!this.content)this.content=new LineContent(this.doc,this.from);var r=this.content.slice(e,t);if(e==0&&t==this.length)this.content=r;return r};e.prototype.finish=function(e){this.doc=e;return this};e.prototype.findClusterBreak=function(e,t){if(e<0||e>this.length)throw new RangeError("Invalid position given to Line.findClusterBreak");var r,n;if(this.content=="string"){r=this.from;n=this.content}else{r=Math.max(0,e-256);n=this.slice(r,Math.min(this.length,r+512))}return(t?nextClusterBreak:prevClusterBreak)(n,e-r)+r};return e}();var LineContent=function(){function e(e,t){this.doc=e;this.start=t;this.cursor=null;this.strings=null}e.prototype.slice=function(e,t){if(!this.cursor){this.cursor=this.doc.iter();this.strings=[this.cursor.next(this.start).value]}for(var r="",n=0,i=0;;i++){if(i==this.strings.length){var o=this.cursor.next().value;if(!o)return r;this.strings.push(o)}var a=this.strings[i],s=n;n+=a.length;if(n<=e)continue;r+=a.slice(Math.max(0,e-s),Math.min(a.length,t-s));if(n>=t)return r}};return e}();var DefaultBufferLength=1024;var nextPropID=0;var CachedNode=new WeakMap;var NodeProp=function(){function e(e){var t=(e===void 0?{}:e).deserialize;this.id=nextPropID++;this.deserialize=t||function(){throw new Error("This node type doesn't define a deserialize function")}}e.string=function(){return new e({deserialize:function(e){return e}})};e.number=function(){return new e({deserialize:Number})};e.flag=function(){return new e({deserialize:function(){return true}})};e.prototype.set=function(e,t){e[this.id]=t;return e};e.prototype.add=function(e){return new NodePropSource(this,typeof e=="function"?e:NodeType.match(e))};e.closedBy=new e({deserialize:function(e){return e.split(" ")}});e.openedBy=new e({deserialize:function(e){return e.split(" ")}});e.group=new e({deserialize:function(e){return e.split(" ")}});return e}();var NodePropSource=function(){function e(e,t){this.prop=e;this.f=t}return e}();var NodeType=function(){function e(e,t,r,n){if(n===void 0){n=0}this.name=e;this.props=t;this.id=r;this.flags=n}e.prototype.prop=function(e){return this.props[e.id]};Object.defineProperty(e.prototype,"isTop",{get:function(){return(this.flags&1)>0},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"isSkipped",{get:function(){return(this.flags&2)>0},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"isError",{get:function(){return(this.flags&4)>0},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"isRepeated",{get:function(){return(this.flags&8)>0},enumerable:true,configurable:true});e.prototype.is=function(e){if(this.name==e)return true;var t=this.prop(NodeProp.group);return t?t.indexOf(e)>-1:false};e.match=function(e){var t=Object.create(null);for(var r in e)for(var n=0,i=r.split(" ");n<i.length;n++){var o=i[n];t[o]=e[r]}return function(e){for(var r=e.prop(NodeProp.group),n=-1;n<(r?r.length:0);n++){var i=t[n<0?e.name:r[n]];if(i)return i}}};e.none=new e("",Object.create(null),0);return e}();var NodeGroup=function(){function e(e){this.types=e;for(var t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node group")}e.prototype.extend=function(){var t=[];for(var r=0;r<arguments.length;r++){t[r]=arguments[r]}var n=[];for(var i=0,o=this.types;i<o.length;i++){var a=o[i];var s=null;for(var l=0,c=t;l<c.length;l++){var u=c[l];var f=u.f(a);if(f!==undefined){if(!s){s=Object.create(null);for(var h in a.props)s[h]=a.props[h]}s[u.prop.id]=f}}n.push(s?new NodeType(a.name,s,a.id,a.flags):a)}return new e(n)};return e}();var Tree=function(){function e(e,t,r,n){this.type=e;this.children=t;this.positions=r;this.length=n}e.prototype.toString=function(){var e=this.children.map((function(e){return e.toString()})).join();return!this.type.name?e:(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(e.length?"("+e+")":"")};e.prototype.partial=function(t,r,n,i,o){for(var a=0;a<this.children.length;a++){var s=this.positions[a];if(s>r)break;var l=this.children[a],c=s+l.length;if(c<t)continue;if(t<=s&&r>=c){i.push(l);o.push(s+n)}else if(l instanceof e){l.partial(t-s,r-s,n+s,i,o)}}};e.prototype.applyChanges=function(t){if(t.length==0)return this;var r=[],n=[];function i(e,t,r){var n=e.cursor(t,-r);for(;;){if(!n.enter(r,t))for(;;){if((r<0?n.to<=t:n.from>=t)&&!n.type.isError)return r<0?Math.min(t,n.to-1):Math.max(t,n.from+1);if(n.sibling(r))break;if(!n.parent())return r<0?0:e.length}}}var o=0;for(var a=0,s=0;;a++){var l=a==t.length?null:t[a];var c=l?i(this,l.fromA,-1):this.length;if(c>s)this.partial(s,c,o,r,n);if(!l)break;s=i(this,l.toA,1);o+=l.toB-l.fromB-(l.toA-l.fromA)}return new e(NodeType.none,r,n,this.length+o)};e.prototype.cut=function(t){if(t>=this.length)return this;var r=[],n=[];for(var i=0;i<this.children.length;i++){var o=this.positions[i];if(o>=t)break;var a=this.children[i],s=o+a.length;r.push(s<=t?a:a.cut(t-o));n.push(o)}return new e(this.type,r,n,t)};e.prototype.cursor=function(e,t){if(t===void 0){t=0}var r=e!=null&&CachedNode.get(this)||this.topNode;var n=new TreeCursor(r);if(e!=null){n.moveTo(e,t);CachedNode.set(this,n.tree)}return n};Object.defineProperty(e.prototype,"topNode",{get:function(){return new TreeNode(this,0,0,null)},enumerable:true,configurable:true});e.prototype.resolve=function(e,t){if(t===void 0){t=0}return this.cursor(e,t).node};e.prototype.iterate=function(e){var t=e.enter,r=e.leave,n=e.from,i=n===void 0?0:n,o=e.to,a=o===void 0?this.length:o;for(var s=this.cursor();;){var l=false;if(s.from<=a&&s.to>=i&&(s.type.isRepeated||t(s.type,s.from,s.to)!==false)){if(s.firstChild())continue;l=true}for(;;){if(l&&r)r(s.type,s.from,s.to);if(s.nextSibling())break;if(!s.parent())return;l=true}}};e.prototype.append=function(t){if(!t.children.length)return this;if(t.positions[0]<this.length)throw new Error("Can't append overlapping trees");return new e(this.type,this.children.concat(t.children),this.positions.concat(t.positions),t.length)};e.prototype.balance=function(e){if(e===void 0){e=DefaultBufferLength}return this.children.length<=BalanceBranchFactor?this:balanceRange(this.type,NodeType.none,this.children,this.positions,0,this.children.length,0,e,this.length)};e.build=function(e){return buildTree(e)};e.empty=new e(NodeType.none,[],[],0);return e}();var TreeBuffer=function(){function e(e,t,r,n){if(n===void 0){n=NodeType.none}this.buffer=e;this.length=t;this.group=r;this.type=n}e.prototype.toString=function(){var e=[];for(var t=0;t<this.buffer.length;){e.push(this.childString(t));t=this.buffer[t+3]}return e.join(",")};e.prototype.childString=function(e){var t=this.buffer[e],r=this.buffer[e+3];var n=this.group.types[t],i=n.name;if(/\W/.test(i)&&!n.isError)i=JSON.stringify(i);e+=4;if(r==e)return i;var o=[];while(e<r){o.push(this.childString(e));e=this.buffer[e+3]}return i+"("+o.join(",")+")"};e.prototype.cut=function(t){var r=0;while(r<this.buffer.length&&this.buffer[r+1]<t)r+=4;var n=new Uint16Array(r);for(var i=0;i<r;i+=4){n[i]=this.buffer[i];n[i+1]=this.buffer[i+1];n[i+2]=Math.min(t,this.buffer[i+2]);n[i+3]=Math.min(this.buffer[i+3],r)}return new e(n,Math.min(t,this.length),this.group)};e.prototype.findChild=function(e,t,r,n){var i=this.buffer,o=-1;for(var a=e;a!=t;a=i[a+3]){if(n!=-1e8){var s=i[a+1],l=i[a+2];if(r>0){if(l>n)o=a;if(l>n)break}else{if(s<n)o=a;if(l>=n)break}}else{o=a;if(r>0)break}}return o};return e}();var TreeNode=function(){function e(e,t,r,n){this.node=e;this.from=t;this.index=r;this._parent=n}Object.defineProperty(e.prototype,"type",{get:function(){return this.node.type},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"name",{get:function(){return this.node.type.name},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"to",{get:function(){return this.from+this.node.length},enumerable:true,configurable:true});e.prototype.nextChild=function(t,r,n){for(var i=this;;){for(var o=i.node,a=o.children,s=o.positions,l=r>0?a.length:-1;t!=l;t+=r){var c=a[t],u=s[t]+i.from;if(n!=-1e8&&(r<0?u>=n:u+c.length<=n))continue;if(c instanceof TreeBuffer){var f=c.findChild(0,c.buffer.length,r,n==-1e8?-1e8:n-u);if(f>-1)return new BufferNode(new BufferContext(i,c,t,u),null,f)}else if(!c.type.isRepeated||hasChild(c)){var h=new e(c,u,t,i);return!h.type.isRepeated?h:h.nextChild(r<0?c.children.length-1:0,r,n)}}if(!i.type.isRepeated)return null;t=i.index+r;i=i._parent}};Object.defineProperty(e.prototype,"firstChild",{get:function(){return this.nextChild(0,1,-1e8)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"lastChild",{get:function(){return this.nextChild(this.node.children.length-1,-1,-1e8)},enumerable:true,configurable:true});e.prototype.childAfter=function(e){return this.nextChild(0,1,e)};e.prototype.childBefore=function(e){return this.nextChild(this.node.children.length-1,-1,e)};e.prototype.nextSignificant=function(){var e=this;while(e.type.isRepeated)e=e._parent;return e};Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent?this._parent.nextSignificant():null},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"nextSibling",{get:function(){return this._parent?this._parent.nextChild(this.index+1,1,-1):null},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"prevSibling",{get:function(){return this._parent?this._parent.nextChild(this.index-1,-1,-1):null},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"cursor",{get:function(){return new TreeCursor(this)},enumerable:true,configurable:true});e.prototype.resolve=function(e,t){if(t===void 0){t=0}return this.cursor.moveTo(e,t).node};e.prototype.getChild=function(e,t,r){if(t===void 0){t=null}if(r===void 0){r=null}var n=getChildren(this,e,t,r);return n.length?n[0]:null};e.prototype.getChildren=function(e,t,r){if(t===void 0){t=null}if(r===void 0){r=null}return getChildren(this,e,t,r)};e.prototype.toString=function(){return this.node.toString()};return e}();function getChildren(e,t,r,n){var i=e.cursor,o=[];if(!i.firstChild())return o;if(r!=null)while(!i.type.is(r))if(!i.nextSibling())return o;for(;;){if(n!=null&&i.type.is(n))return o;if(i.type.is(t))o.push(i.node);if(!i.nextSibling())return n==null?o:[]}}var BufferContext=function(){function e(e,t,r,n){this.parent=e;this.buffer=t;this.index=r;this.start=n}return e}();var BufferNode=function(){function e(e,t,r){this.context=e;this._parent=t;this.index=r;this.type=e.buffer.group.types[e.buffer.buffer[r]]}Object.defineProperty(e.prototype,"name",{get:function(){return this.type.name},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"from",{get:function(){return this.context.start+this.context.buffer.buffer[this.index+1]},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"to",{get:function(){return this.context.start+this.context.buffer.buffer[this.index+2]},enumerable:true,configurable:true});e.prototype.child=function(t,r){var n=this.context.buffer;var i=n.findChild(this.index+4,n.buffer[this.index+3],t,r==-1e8?-1e8:r-this.context.start);return i<0?null:new e(this.context,this,i)};Object.defineProperty(e.prototype,"firstChild",{get:function(){return this.child(1,-1e8)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"lastChild",{get:function(){return this.child(-1,-1e8)},enumerable:true,configurable:true});e.prototype.childAfter=function(e){return this.child(1,e)};e.prototype.childBefore=function(e){return this.child(-1,e)};Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent||this.context.parent.nextSignificant()},enumerable:true,configurable:true});e.prototype.externalSibling=function(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,-1)};Object.defineProperty(e.prototype,"nextSibling",{get:function(){var t=this.context.buffer;var r=t.buffer[this.index+3];if(r<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length))return new e(this.context,this._parent,r);return this.externalSibling(1)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"prevSibling",{get:function(){var t=this.context.buffer;var r=this._parent?this._parent.index+4:0;if(this.index==r)return this.externalSibling(-1);return new e(this.context,this._parent,t.findChild(r,this.index,-1,-1))},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"cursor",{get:function(){return new TreeCursor(this)},enumerable:true,configurable:true});e.prototype.resolve=function(e,t){if(t===void 0){t=0}return this.cursor.moveTo(e,t).node};e.prototype.toString=function(){return this.context.buffer.childString(this.index)};e.prototype.getChild=function(e,t,r){if(t===void 0){t=null}if(r===void 0){r=null}var n=getChildren(this,e,t,r);return n.length?n[0]:null};e.prototype.getChildren=function(e,t,r){if(t===void 0){t=null}if(r===void 0){r=null}return getChildren(this,e,t,r)};return e}();var TreeCursor=function(){function e(e){this.buffer=null;this.stack=[];this.index=0;this.bufferNode=null;if(e instanceof TreeNode){this.yieldNode(e)}else{this.tree=e.context.parent;this.buffer=e.context;for(var t=e._parent;t;t=t._parent)this.stack.unshift(t.index);this.bufferNode=e;this.yieldBuf(e.index)}}Object.defineProperty(e.prototype,"name",{get:function(){return this.type.name},enumerable:true,configurable:true});e.prototype.yieldNode=function(e){if(!e)return false;this.tree=e;this.type=e.type;this.from=e.from;this.to=e.to;return true};e.prototype.yieldBuf=function(e,t){this.index=e;var r=this.buffer,n=r.start,i=r.buffer;this.type=t||i.group.types[i.buffer[e]];this.from=n+i.buffer[e+1];this.to=n+i.buffer[e+2];return true};e.prototype.yield=function(e){if(!e)return false;if(e instanceof TreeNode){this.buffer=null;return this.yieldNode(e)}this.buffer=e.context;return this.yieldBuf(e.index,e.type)};e.prototype.toString=function(){return this.buffer?this.buffer.buffer.childString(this.index):this.tree.toString()};e.prototype.enter=function(e,t){if(!this.buffer)return this.yield(this.tree.nextChild(e<0?this.tree.node.children.length-1:0,e,t));var r=this.buffer.buffer;var n=r.findChild(this.index+4,r.buffer[this.index+3],e,t==-1e8?-1e8:t-this.buffer.start);if(n<0)return false;this.stack.push(this.index);return this.yieldBuf(n)};e.prototype.firstChild=function(){return this.enter(1,-1e8)};e.prototype.lastChild=function(){return this.enter(-1,-1e8)};e.prototype.childAfter=function(e){return this.enter(1,e)};e.prototype.childBefore=function(e){return this.enter(-1,e)};e.prototype.parent=function(){if(!this.buffer)return this.yieldNode(this.tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());var e=this.buffer.parent.nextSignificant();this.buffer=null;return this.yieldNode(e)};e.prototype.sibling=function(e){if(!this.buffer)return this.tree._parent?this.yield(this.tree._parent.nextChild(this.tree.index+e,e,-1e8)):false;var t=this.buffer.buffer,r=this.stack.length-1;if(e<0){var n=r<0?0:this.stack[r]+4;if(this.index!=n)return this.yieldBuf(t.findChild(n,this.index,-1,-1e8))}else{var i=t.buffer[this.index+3];if(i<(r<0?t.buffer.length:t.buffer[this.stack[r]+3]))return this.yieldBuf(i)}return r<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,-1e8)):false};e.prototype.nextSibling=function(){return this.sibling(1)};e.prototype.prevSibling=function(){return this.sibling(-1)};e.prototype.atLastNode=function(e){var t,r;var n,i,o=this.buffer;if(o){if(e>0){if(this.index<o.buffer.buffer.length)return false}else{for(var a=0;a<this.index;a++)if(o.buffer.buffer[a+3]<this.index)return false}n=o.index,i=o.parent}else{t=this.tree,n=t.index,i=t._parent}for(;i;r=i,n=r.index,i=r._parent,r){for(var a=n+e,s=e<0?-1:i.node.children.length;a!=s;a+=e){var l=i.node.children[a];if(!l.type.isRepeated||l instanceof TreeBuffer||hasChild(l))return false}}return true};e.prototype.move=function(e){if(this.enter(e,-1e8))return true;for(;;){if(this.sibling(e))return true;if(this.atLastNode(e)||!this.parent())return false}};e.prototype.next=function(){return this.move(1)};e.prototype.prev=function(){return this.move(-1)};e.prototype.moveTo=function(e,t){if(t===void 0){t=0}while(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))if(!this.parent())break;for(;;){if(t<0?!this.childBefore(e):!this.childAfter(e))break;if(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e)){this.parent();break}}return this};Object.defineProperty(e.prototype,"node",{get:function(){if(!this.buffer)return this.tree;var e=this.bufferNode,t=null,r=0;if(e&&e.context==this.buffer){e:for(var n=this.index,i=this.stack.length;i>=0;){for(var o=e;o;o=o._parent)if(o.index==n){if(n==this.index)return o;t=o;r=i+1;break e}n=this.stack[--i]}}for(var a=r;a<this.stack.length;a++)t=new BufferNode(this.buffer,t,this.stack[a]);return this.bufferNode=new BufferNode(this.buffer,t,this.index)},enumerable:true,configurable:true});return e}();function hasChild(e){return e.children.some((function(e){return!e.type.isRepeated||e instanceof TreeBuffer||hasChild(e)}))}var FlatBufferCursor=function(){function e(e,t){this.buffer=e;this.index=t}Object.defineProperty(e.prototype,"id",{get:function(){return this.buffer[this.index-4]},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"start",{get:function(){return this.buffer[this.index-3]},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"end",{get:function(){return this.buffer[this.index-2]},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"size",{get:function(){return this.buffer[this.index-1]},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"pos",{get:function(){return this.index},enumerable:true,configurable:true});e.prototype.next=function(){this.index-=4};e.prototype.fork=function(){return new e(this.buffer,this.index)};return e}();var BalanceBranchFactor=8;function buildTree(e){var t=e,r=t.buffer,n=t.group,i=t.topID,o=i===void 0?0:i,a=t.maxBufferLength,s=a===void 0?DefaultBufferLength:a,l=t.reused,c=l===void 0?[]:l,u=t.minRepeatType,f=u===void 0?n.types.length:u;var h=Array.isArray(r)?new FlatBufferCursor(r,r.length):r;var d=n.types;function p(e,t,r,i,o){var a=h.id,l=h.start,u=h.end,v=h.size;while(a==o){h.next();a=h.id,l=h.start,u=h.end,v=h.size}var O=l-e;if(v<0){r.push(c[a]);i.push(O);h.next();return}var y=d[a],b,S;if(u-l<=s&&(S=g(h.pos-t,o))){var w=new Uint16Array(S.size-S.skip);var x=h.pos-S.size,k=w.length;while(h.pos>x)k=m(S.start,w,k,o);b=new TreeBuffer(w,u-S.start,n,o<0?NodeType.none:d[o]);O=S.start-e}else{var x=h.pos-v;h.next();var P=[],C=[];var Q=a>=f?a:-1;while(h.pos>x)p(l,x,P,C,Q);P.reverse();C.reverse();if(Q>-1&&P.length>BalanceBranchFactor)b=balanceRange(y,y,P,C,0,P.length,0,s,u-l);else b=new Tree(y,P,C,u-l)}r.push(b);i.push(O)}function g(e,t){var r=h.fork();var n=0,i=0,o=0,a=r.end-s;var l={size:0,start:0,skip:0};e:for(var c=r.pos-e;r.pos>c;){if(r.id==t){l.size=n;l.start=i;l.skip=o;o+=4;n+=4;r.next();continue}var u=r.size,d=r.pos-u;if(u<0||d<c||r.start<a)break;var p=r.id>=f?4:0;var g=r.start;r.next();while(r.pos>d){if(r.size<0)break e;if(r.id>=f)p+=4;r.next()}i=g;n+=u;o+=p}if(t<0||n==e){l.size=n;l.start=i;l.skip=o}return l.size>4?l:undefined}function m(e,t,r,n){var i=h.id,o=h.start,a=h.end,s=h.size;h.next();if(i==n)return r;var l=r;if(s>4){var c=h.pos-(s-4);while(h.pos>c)r=m(e,t,r,n)}if(i<f){t[--r]=l;t[--r]=a-e;t[--r]=o-e;t[--r]=i}return r}var v=[],O=[];while(h.pos>0)p(0,0,v,O,-1);var y=v.length?O[0]+v[0].length:0;return new Tree(n.types[o],v.reverse(),O.reverse(),y)}function balanceRange(e,t,r,n,i,o,a,s,l){var c=[],u=[];if(l<=s){for(var f=i;f<o;f++){c.push(r[f]);u.push(n[f]-a)}}else{var h=Math.max(s,Math.ceil(l*1.5/BalanceBranchFactor));for(var f=i;f<o;){var d=f,p=n[f];f++;for(;f<o;f++){var g=n[f]+r[f].length;if(g-p>h)break}if(f==d+1){var m=r[d];if(m instanceof Tree&&m.type==t&&m.length>h<<1){for(var v=0;v<m.children.length;v++){c.push(m.children[v]);u.push(m.positions[v]+p-a)}continue}c.push(m)}else if(f==d+1){c.push(r[d])}else{var O=balanceRange(t,t,r,n,d,f,p,s,n[f-1]+r[f-1].length-p);if(t!=NodeType.none&&!containsType(O.children,t))O=new Tree(NodeType.none,O.children,O.positions,O.length);c.push(O)}u.push(p-a)}}return new Tree(e,c,u,l)}function containsType(e,t){for(var r=0,n=e;r<n.length;r++){var i=n[r];if(i.type==t)return true}return false}var DefaultSplit=/\r\n?|\n/;var MapMode;(function(e){e[e["Simple"]=0]="Simple";e[e["TrackDel"]=1]="TrackDel";e[e["TrackBefore"]=2]="TrackBefore";e[e["TrackAfter"]=3]="TrackAfter"})(MapMode||(MapMode={}));var ChangeDesc=function(){function e(e){this.sections=e}Object.defineProperty(e.prototype,"length",{get:function(){var e=0;for(var t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"newLength",{get:function(){var e=0;for(var t=0;t<this.sections.length;t+=2){var r=this.sections[t+1];e+=r<0?this.sections[t]:r}return e},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"empty",{get:function(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0},enumerable:false,configurable:true});e.prototype.iterGaps=function(e){for(var t=0,r=0,n=0;t<this.sections.length;){var i=this.sections[t++],o=this.sections[t++];if(o<0){e(r,n,i);n+=i}else{n+=o}r+=i}};e.prototype.iterChangedRanges=function(e,t){if(t===void 0){t=false}iterChanges(this,e,t)};Object.defineProperty(e.prototype,"invertedDesc",{get:function(){var t=[];for(var r=0;r<this.sections.length;){var n=this.sections[r++],i=this.sections[r++];if(i<0)t.push(n,i);else t.push(i,n)}return new e(t)},enumerable:false,configurable:true});e.prototype.composeDesc=function(e){return this.empty?e:e.empty?this:composeSets(this,e)};e.prototype.mapDesc=function(e,t){if(t===void 0){t=false}return e.empty?this:mapSet(this,e,t)};e.prototype.mapPos=function(e,t,r){if(t===void 0){t=-1}if(r===void 0){r=MapMode.Simple}var n=0,i=0;for(var o=0;o<this.sections.length;){var a=this.sections[o++],s=this.sections[o++],l=n+a;if(s<0){if(l>e)return i+(e-n);i+=a}else{if(r!=MapMode.Simple&&l>=e&&(r==MapMode.TrackDel&&n<e&&l>e||r==MapMode.TrackBefore&&n<e||r==MapMode.TrackAfter&&l>e))return null;if(l>e||l==e&&t<0&&!a)return e==n||t<0?i:i+s;i+=s}n=l}if(e>n)throw new RangeError("Position "+e+" is out of range for changeset of length "+n);return i};e.prototype.touchesRange=function(e,t){if(t===void 0){t=e}for(var r=0,n=0;r<this.sections.length&&n<=t;){var i=this.sections[r++],o=this.sections[r++],a=n+i;if(o>=0&&n<=t&&a>=e)return n<e&&a>t?"cover":true;n=a}return false};e.prototype.toString=function(){var e="";for(var t=0;t<this.sections.length;){var r=this.sections[t++],n=this.sections[t++];e+=(e?" ":"")+r+(n>=0?":"+n:"")}return e};return e}();var ChangeSet=function(e){__extends(t,e);function t(t,r){var n=e.call(this,t)||this;n.inserted=r;return n}t.prototype.apply=function(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");iterChanges(this,(function(t,r,n,i,o){return e=e.replace(n,n+(r-t),o)}),false);return e};t.prototype.mapDesc=function(e,t){if(t===void 0){t=false}return mapSet(this,e,t,true)};t.prototype.invert=function(e){var r=this.sections.slice(),n=[];for(var i=0,o=0;i<r.length;i+=2){var a=r[i],s=r[i+1];if(s>=0){r[i]=s;r[i+1]=a;var l=i>>1;while(n.length<l)n.push(Text.empty);n.push(a?e.slice(o,o+a):Text.empty)}o+=a}return new t(r,n)};t.prototype.compose=function(e){return this.empty?e:e.empty?this:composeSets(this,e,true)};t.prototype.map=function(e,t){if(t===void 0){t=false}return e.empty?this:mapSet(this,e,t,true)};t.prototype.iterChanges=function(e,t){if(t===void 0){t=false}iterChanges(this,e,t)};Object.defineProperty(t.prototype,"desc",{get:function(){return new ChangeDesc(this.sections)},enumerable:false,configurable:true});t.prototype.filter=function(e){var r=[],n=[],i=[];var o=new SectionIter(this);e:for(var a=0,s=0;;){var l=a==e.length?1e9:e[a++];while(s<l||s==l&&o.len==0){if(o.done)break e;var c=Math.min(o.len,l-s);addSection(i,c,-1);var u=o.ins==-1?-1:o.off==0?o.ins:0;addSection(r,c,u);if(u>0)addInsert(n,r,o.text);o.forward(c);s+=c}var f=e[a++];while(s<f){if(o.done)break e;var c=Math.min(o.len,f-s);addSection(r,c,-1);addSection(i,c,o.ins==-1?-1:o.off==0?o.ins:0);o.forward(c);s+=c}}return{changes:new t(r,n),filtered:new ChangeDesc(i)}};t.prototype.toJSON=function(){var e=[];for(var t=0;t<this.sections.length;t+=2){var r=this.sections[t],n=this.sections[t+1];if(n<0)e.push(r);else if(n==0)e.push([r]);else e.push([r,this.inserted[t>>1].toJSON()])}return e};t.of=function(e,r,n){var i=[],o=[],a=0;var s=null;function l(e){if(e===void 0){e=false}if(!e&&!i.length)return;if(a<r)addSection(i,r-a,-1);var n=new t(i,o);s=s?s.compose(n.map(s)):n;i=[];o=[];a=0}function c(e){if(Array.isArray(e)){for(var u=0,f=e;u<f.length;u++){var h=f[u];c(h)}}else if(e instanceof t){if(e.length!=r)throw new RangeError("Mismatched change set length (got "+e.length+", expected "+r+")");l();s=s?s.compose(e.map(s)):e}else{var d=e.from,p=e.to,g=p===void 0?d:p,m=e.insert;if(d>g||d<0||g>r)throw new RangeError("Invalid change range "+d+" to "+g+" (in doc of length "+r+")");var v=!m?Text.empty:typeof m=="string"?Text.of(m.split(n||DefaultSplit)):m;var O=v.length;if(d==g&&O==0)return;if(d<a)l();if(d>a)addSection(i,d-a,-1);addSection(i,g-d,O);addInsert(o,i,v);a=g}}c(e);l(!s);return s};t.empty=function(e){return new t(e?[e,-1]:[],[])};t.fromJSON=function(e){var r=[],n=[];for(var i=0;i<e.length;i++){var o=e[i];if(typeof o=="number"){r.push(o,-1)}else if(o.length==1){r.push(o[0],0)}else{while(n.length<i)n.push(Text.empty);n[i]=Text.of(o[1]);r.push(o[0],n[i].length)}}return new t(r,n)};return t}(ChangeDesc);function addSection(e,t,r,n){if(n===void 0){n=false}if(t==0&&r<=0)return;var i=e.length-2;if(i>=0&&r<=0&&r==e[i+1])e[i]+=t;else if(t==0&&e[i]==0)e[i+1]+=r;else if(n){e[i]+=t;e[i+1]+=r}else e.push(t,r)}function addInsert(e,t,r){if(r.length==0)return;var n=t.length-2>>1;if(n<e.length){e[e.length-1]=e[e.length-1].append(r)}else{while(e.length<n)e.push(Text.empty);e.push(r)}}function iterChanges(e,t,r){var n=e.inserted;for(var i=0,o=0,a=0;a<e.sections.length;){var s=e.sections[a++],l=e.sections[a++];if(l<0){i+=s;o+=s}else{var c=i,u=o,f=Text.empty;for(;;){c+=s;u+=l;if(l&&n)f=f.append(n[a-2>>1]);if(r||a==e.sections.length||e.sections[a+1]<0)break;s=e.sections[a++];l=e.sections[a++]}t(i,c,o,u,f);i=c;o=u}}}function mapSet(e,t,r,n){if(n===void 0){n=false}var i=[],o=n?[]:null;var a=new SectionIter(e),s=new SectionIter(t);for(var l=0,c=0;;){if(a.ins==-1){l+=a.len;a.next()}else if(s.ins==-1&&c<l){var u=Math.min(s.len,l-c);s.forward(u);addSection(i,u,-1);c+=u}else if(s.ins>=0&&(a.done||c<l||c==l&&(s.len<a.len||s.len==a.len&&!r))){addSection(i,s.ins,-1);while(l>c&&!a.done&&l+a.len<c+s.len){l+=a.len;a.next()}c+=s.len;s.next()}else if(a.ins>=0){var f=0,h=l+a.len;for(;;){if(s.ins>=0&&c>l&&c+s.len<h){f+=s.ins;c+=s.len;s.next()}else if(s.ins==-1&&c<h){var u=Math.min(s.len,h-c);f+=u;s.forward(u);c+=u}else{break}}addSection(i,f,a.ins);if(o)addInsert(o,i,a.text);l=h;a.next()}else if(a.done&&s.done){return o?new ChangeSet(i,o):new ChangeDesc(i)}else{throw new Error("Mismatched change set lengths")}}}function composeSets(e,t,r){if(r===void 0){r=false}var n=[];var i=r?[]:null;var o=new SectionIter(e),a=new SectionIter(t);for(var s=false;;){if(o.done&&a.done){return i?new ChangeSet(n,i):new ChangeDesc(n)}else if(o.ins==0){addSection(n,o.len,0,s);o.next()}else if(a.len==0&&!a.done){addSection(n,0,a.ins,s);if(i)addInsert(i,n,a.text);a.next()}else if(o.done||a.done){throw new Error("Mismatched change set lengths")}else{var l=Math.min(o.len2,a.len),c=n.length;if(o.ins==-1){var u=a.ins==-1?-1:a.off?0:a.ins;addSection(n,l,u,s);if(i&&u)addInsert(i,n,a.text)}else if(a.ins==-1){addSection(n,o.off?0:o.len,l,s);if(i)addInsert(i,n,o.textBit(l))}else{addSection(n,o.off?0:o.len,a.off?0:a.ins,s);if(i&&!a.off)addInsert(i,n,a.text)}s=(o.ins>l||a.ins>=0&&a.len>l)&&(s||n.length>c);o.forward2(l);a.forward(l)}}}var SectionIter=function(){function e(e){this.set=e;this.i=0;this.next()}e.prototype.next=function(){var e=this.set.sections;if(this.i<e.length){this.len=e[this.i++];this.ins=e[this.i++]}else{this.len=0;this.ins=-2}this.off=0};Object.defineProperty(e.prototype,"done",{get:function(){return this.ins==-2},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"len2",{get:function(){return this.ins<0?this.len:this.ins},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"text",{get:function(){var e=this.set.inserted,t=this.i-2>>1;return t>=e.length?Text.empty:e[t]},enumerable:false,configurable:true});e.prototype.textBit=function(e){var t=this.set.inserted,r=this.i-2>>1;return r>=t.length&&!e?Text.empty:t[r].slice(this.off,e==null?undefined:this.off+e)};e.prototype.forward=function(e){if(e==this.len)this.next();else{this.len-=e;this.off+=e}};e.prototype.forward2=function(e){if(this.ins==-1)this.forward(e);else if(e==this.ins)this.next();else{this.ins-=e;this.off+=e}};return e}();var SelectionRange=function(){function e(e,t,r){this.from=e;this.to=t;this.flags=r}Object.defineProperty(e.prototype,"anchor",{get:function(){return this.flags&16?this.to:this.from},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"head",{get:function(){return this.flags&16?this.from:this.to},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"empty",{get:function(){return this.from==this.to},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"assoc",{get:function(){return this.flags&4?-1:this.flags&8?1:0},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"bidiLevel",{get:function(){var e=this.flags&3;return e==3?null:e},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"goalColumn",{get:function(){var e=this.flags>>5;return e==33554431?undefined:e},enumerable:false,configurable:true});e.prototype.map=function(t){var r=t.mapPos(this.from),n=t.mapPos(this.to);return r==this.from&&n==this.to?this:new e(r,n,this.flags)};e.prototype.extend=function(e,t){if(t===void 0){t=e}if(e<=this.anchor&&t>=this.anchor)return EditorSelection.range(e,t);var r=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return EditorSelection.range(this.anchor,r)};e.prototype.eq=function(e){return this.anchor==e.anchor&&this.head==e.head};e.prototype.toJSON=function(){return{anchor:this.anchor,head:this.head}};e.fromJSON=function(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return EditorSelection.range(e.anchor,e.head)};return e}();var EditorSelection=function(){function e(e,t){if(t===void 0){t=0}this.ranges=e;this.primaryIndex=t}e.prototype.map=function(t){if(t.empty)return this;return e.create(this.ranges.map((function(e){return e.map(t)})),this.primaryIndex)};e.prototype.eq=function(e){if(this.ranges.length!=e.ranges.length||this.primaryIndex!=e.primaryIndex)return false;for(var t=0;t<this.ranges.length;t++)if(!this.ranges[t].eq(e.ranges[t]))return false;return true};Object.defineProperty(e.prototype,"primary",{get:function(){return this.ranges[this.primaryIndex]},enumerable:false,configurable:true});e.prototype.asSingle=function(){return this.ranges.length==1?this:new e([this.primary])};e.prototype.addRange=function(t,r){if(r===void 0){r=true}return e.create([t].concat(this.ranges),r?0:this.primaryIndex+1)};e.prototype.replaceRange=function(t,r){if(r===void 0){r=this.primaryIndex}var n=this.ranges.slice();n[r]=t;return e.create(n,this.primaryIndex)};e.prototype.toJSON=function(){return{ranges:this.ranges.map((function(e){return e.toJSON()})),primaryIndex:this.primaryIndex}};e.fromJSON=function(t){if(!t||!Array.isArray(t.ranges)||typeof t.primaryIndex!="number"||t.primaryIndex>=t.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new e(t.ranges.map((function(e){return SelectionRange.fromJSON(e)})),t.primaryIndex)};e.single=function(t,r){if(r===void 0){r=t}return new e([e.range(t,r)],0)};e.create=function(t,r){if(r===void 0){r=0}if(t.length==0)throw new RangeError("A selection needs at least one range");for(var n=0,i=0;i<t.length;i++){var o=t[i];if(o.empty?o.from<=n:o.from<n)return normalized(t.slice(),r);n=o.to}return new e(t,r)};e.cursor=function(e,t,r,n){if(t===void 0){t=0}return new SelectionRange(e,e,(t==0?0:t<0?4:8)|(r==null?3:Math.min(2,r))|(n!==null&&n!==void 0?n:33554431)<<5)};e.range=function(e,t,r){var n=(r!==null&&r!==void 0?r:33554431)<<5;return t<e?new SelectionRange(t,e,16|n):new SelectionRange(e,t,n)};return e}();function normalized(e,t){if(t===void 0){t=0}var r=e[t];e.sort((function(e,t){return e.from-t.from}));t=e.indexOf(r);for(var n=1;n<e.length;n++){var i=e[n],o=e[n-1];if(i.empty?i.from<=o.to:i.from<o.to){var a=o.from,s=Math.max(i.to,o.to);if(n<=t)t--;e.splice(--n,2,i.anchor>i.head?EditorSelection.range(s,a):EditorSelection.range(a,s))}}return new EditorSelection(e,t)}function checkSelection(e,t){for(var r=0,n=e.ranges;r<n.length;r++){var i=n[r];if(i.to>t)throw new RangeError("Selection points outside of document")}}var nextID=0;var Facet=function(){function e(e,t,r,n){this.combine=e;this.compareInput=t;this.compare=r;this.isStatic=n;this.id=nextID++;this.default=e([])}e.define=function(t){if(t===void 0){t={}}return new e(t.combine||function(e){return e},t.compareInput||function(e,t){return e===t},t.compare||(!t.combine?sameArray:function(e,t){return e===t}),!!t.static)};e.prototype.of=function(e){return new FacetProvider([],this,0,e)};e.prototype.compute=function(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new FacetProvider(e,this,1,t)};e.prototype.computeN=function(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new FacetProvider(e,this,2,t)};e.prototype.from=function(e,t){var r=this;return function(n){return maybePrec(t,r.compute([n],(function(t){return e(t.field(n))})))}};e.prototype.nFrom=function(e,t){var r=this;return function(n){return maybePrec(t,r.computeN([n],(function(t){return e(t.field(n))})))}};return e}();function sameArray(e,t){return e==t||e.length==t.length&&e.every((function(e,r){return e===t[r]}))}var FacetProvider=function(){function e(e,t,r,n){this.dependencies=e;this.facet=t;this.type=r;this.value=n;this.id=nextID++}e.prototype.dynamicSlot=function(e){var t=this.value;var r=this.facet.compareInput;var n=e[this.id]>>1,i=this.type==2;var o=false,a=false,s=[];for(var l=0,c=this.dependencies;l<c.length;l++){var u=c[l];if(u=="doc")o=true;else if(u=="selection")a=true;else if((e[u.id]&1)==0)s.push(e[u.id])}return function(e,l){if(!l||l.reconfigure){e.values[n]=t(e);return 1}else{var c=o&&l.docChanged||a&&(l.docChanged||l.selection)||s.some((function(t){return(ensureAddr(e,t)&1)>0}));if(!c)return 0;var u=t(e),f=l.startState.values[n];if(i?compareArray(u,f,r):r(u,f))return 0;e.values[n]=u;return 1}}};return e}();function compareArray(e,t,r){if(e.length!=t.length)return false;for(var n=0;n<e.length;n++)if(!r(e[n],t[n]))return false;return true}function dynamicFacetSlot(e,t,r){var n=r.map((function(t){return e[t.id]}));var i=r.map((function(e){return e.type}));var o=n.filter((function(e){return!(e&1)}));var a=e[t.id]>>1;return function(e,r){var s=!r?null:r.reconfigure?r.startState.config.address[t.id]:a<<1;var l=s==null;for(var c=0,u=o;c<u.length;c++){var f=u[c];if(ensureAddr(e,f)&1)l=true}if(!l)return 0;var h=[];for(var d=0;d<n.length;d++){var p=getAddr(e,n[d]);if(i[d]==2)for(var g=0,m=p;g<m.length;g++){var v=m[g];h.push(v)}else h.push(p)}var O=t.combine(h);if(s!=null&&t.compare(O,getAddr(r.startState,s)))return 0;e.values[a]=O;return 1}}function maybeIndex(e,t){var r=e.config.address[t];return r==null?null:r>>1}var StateField=function(){function e(e,t,r,n,i){this.id=e;this.createF=t;this.updateF=r;this.compareF=n;this.facets=i}e.define=function(t){var r=[];var n=new e(nextID++,t.create,t.update,t.compare||function(e,t){return e===t},r);if(t.provide)for(var i=0,o=t.provide;i<o.length;i++){var a=o[i];if(a instanceof Facet)r.push(a.compute([n],(function(e){return e.field(n)})));else r.push(a(n))}return n};e.prototype.slot=function(e){var t=this;var r=e[this.id]>>1;return function(e,n){if(!n){e.values[r]=t.createF(e);return 1}var i,o=0;if(n.reconfigure){var a=maybeIndex(n.startState,t.id);i=a==null?t.createF(n.startState):n.startState.values[a];o=1}else{i=n.startState.values[r]}var s=t.updateF(i,n);if(!o&&!t.compareF(i,s))o=1;if(o)e.values[r]=s;return o}};return e}();var Prec={fallback:3,default:2,extend:1,override:0};function precedence(e,t){if(!Prec.hasOwnProperty(t))throw new RangeError("Invalid precedence: "+t);return new PrecExtension(e,Prec[t])}function maybePrec(e,t){return e?precedence(t,e):t}var PrecExtension=function(){function e(e,t){this.e=e;this.prec=t}return e}();var TaggedExtension=function(){function e(e,t){this.tag=e;this.extension=t}return e}();function tagExtension(e,t){return new TaggedExtension(e,t)}var Configuration=function(){function e(e,t,r,n,i){this.source=e;this.replacements=t;this.dynamicSlots=r;this.address=n;this.staticValues=i;this.statusTemplate=[];while(this.statusTemplate.length<i.length)this.statusTemplate.push(0)}e.prototype.staticFacet=function(e){var t=this.address[e.id];return t==null?e.default:this.staticValues[t>>1]};e.resolve=function(t,r,n){if(r===void 0){r=Object.create(null)}var i=[];var o=Object.create(null);for(var a=0,s=flatten(t,r);a<s.length;a++){var l=s[a];if(l instanceof StateField)i.push(l);else(o[l.facet.id]||(o[l.facet.id]=[])).push(l)}var c=Object.create(null);var u=[];var f=[];var h=function(e){c[e.id]=f.length<<1;f.push((function(t){return e.slot(t)}))};for(var d=0,p=i;d<p.length;d++){var g=p[d];h(g)}var m=function(e){var t=o[e],r=t[0].facet;if(t.every((function(e){return e.type==0}))){c[r.id]=u.length<<1|1;var i=r.combine(t.map((function(e){return e.value})));var a=n?n.config.address[r.id]:null;if(a!=null){var s=getAddr(n,a);if(r.compare(i,s))i=s}u.push(i)}else{var l=function(e){if(e.type==0){c[e.id]=u.length<<1|1;u.push(e.value)}else{c[e.id]=f.length<<1;f.push((function(t){return e.dynamicSlot(t)}))}};for(var h=0,d=t;h<d.length;h++){var p=d[h];l(p)}c[r.id]=f.length<<1;f.push((function(e){return dynamicFacetSlot(e,r,t)}))}};for(var v in o){m(v)}return new e(t,r,f.map((function(e){return e(c)})),c,u)};return e}();function allKeys(e){return(Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e):[]).concat(Object.keys(e))}function flatten(e,t){var r=[[],[],[],[]];var n=new Map;var i=Object.create(null);function o(e,a){var s=n.get(e);if(s!=null){if(s>=a)return;var l=r[s].indexOf(e);if(l>-1)r[s].splice(l,1)}n.set(e,a);if(Array.isArray(e)){for(var c=0,u=e;c<u.length;c++){var f=u[c];o(f,a)}}else if(e instanceof TaggedExtension){if(e.tag in i)throw new RangeError("Duplicate use of tag '"+String(e.tag)+"' in extensions");i[e.tag]=true;o(t[e.tag]||e.extension,a)}else if(e.extension){o(e.extension,a)}else if(e instanceof PrecExtension){o(e.e,e.prec)}else{r[a].push(e);if(e instanceof StateField)o(e.facets,a)}}o(e,Prec.default);for(var a=0,s=allKeys(t);a<s.length;a++){var l=s[a];if(!(l in i)&&l!="full"&&t[l]){i[l]=true;o(t[l],Prec.default)}}return r.reduce((function(e,t){return e.concat(t)}))}function ensureAddr(e,t){if(t&1)return 2;var r=t>>1;var n=e.status[r];if(n==4)throw new Error("Cyclic dependency between fields and/or facets");if(n&2)return n;e.status[r]=4;var i=e.config.dynamicSlots[r](e,e.applying);return e.status[r]=2|i}function getAddr(e,t){return t&1?e.config.staticValues[t>>1]:e.values[t>>1]}var allowMultipleSelections=Facet.define({combine:function(e){return e.some((function(e){return e}))},static:true});var lineSeparator=Facet.define({combine:function(e){return e.length?e[0]:undefined},static:true});var changeFilter=Facet.define();var transactionFilter=Facet.define();var languageDataProp=new NodeProp;var globalLanguageData=Facet.define();var IndentContext=function(){function e(e,t){if(t===void 0){t={}}this.state=e;this.options=t}Object.defineProperty(e.prototype,"unit",{get:function(){return this.state.indentUnit},enumerable:false,configurable:true});e.prototype.textAfterPos=function(e){var t,r;var n=(t=this.options)===null||t===void 0?void 0:t.simulateBreak;if(e==n&&((r=this.options)===null||r===void 0?void 0:r.simulateDoubleBreak))return"";return this.state.sliceDoc(e,Math.min(e+100,n!=null&&n>e?n:1e9,this.state.doc.lineAt(e).to))};e.prototype.countColumn=function(e,t){return countColumn(t<0?e:e.slice(0,t),0,this.state.tabSize)};e.prototype.lineIndent=function(e){var t;var r=(t=this.options)===null||t===void 0?void 0:t.overrideIndentation;if(r){var n=r(e.from);if(n>-1)return n}var i=e.slice(0,Math.min(100,e.length));return this.countColumn(i,i.search(/\S/))};e.prototype.column=function(e){var t;var r=this.state.doc.lineAt(e),n=r.slice(0,e-r.from);var i=this.countColumn(n,e-r.from);var o=((t=this.options)===null||t===void 0?void 0:t.overrideIndentation)?this.options.overrideIndentation(r.from):-1;if(o>-1)i+=o-this.countColumn(n,n.search(/\S/));return i};return e}();var Annotation=function(){function e(e,t){this.type=e;this.value=t}e.define=function(){return new AnnotationType};return e}();var AnnotationType=function(){function e(){}e.prototype.of=function(e){return new Annotation(this,e)};return e}();var StateEffect=function(){function e(e,t){this.type=e;this.value=t}e.prototype.map=function(t){var r=this.type.map(this.value,t);return r===undefined?undefined:r==this.value?this:new e(this.type,r)};e.prototype.is=function(e){return this.type==e};e.define=function(e){if(e===void 0){e={}}return new StateEffectType(e.map||function(e){return e})};e.mapEffects=function(e,t){if(!e.length)return e;var r=[];for(var n=0,i=e;n<i.length;n++){var o=i[n];var a=o.map(t);if(a)r.push(a)}return r};return e}();var StateEffectType=function(){function e(e){this.map=e}e.prototype.of=function(e){return new StateEffect(this,e)};return e}();var Transaction=function(){function e(t,r,n,i,o,a,s){this.startState=t;this.changes=r;this.selection=n;this.effects=i;this.annotations=o;this.reconfigure=a;this.scrollIntoView=s;this._doc=null;this._state=null;if(n)checkSelection(n,r.newLength);if(!o.some((function(t){return t.type==e.time})))this.annotations=o.concat(e.time.of(Date.now()))}Object.defineProperty(e.prototype,"newDoc",{get:function(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"newSelection",{get:function(){return this.selection||this.startState.selection.map(this.changes)},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"state",{get:function(){if(!this._state)this.startState.applyTransaction(this);return this._state},enumerable:false,configurable:true});e.prototype.annotation=function(e){for(var t=0,r=this.annotations;t<r.length;t++){var n=r[t];if(n.type==e)return n.value}return undefined};Object.defineProperty(e.prototype,"docChanged",{get:function(){return!this.changes.empty},enumerable:false,configurable:true});return e}();Transaction.time=Annotation.define();Transaction.userEvent=Annotation.define();Transaction.addToHistory=Annotation.define();function joinRanges(e,t){var r=[];for(var n=0,i=0;;){var o=void 0,a=void 0;if(n<e.length&&(i==t.length||t[i]>=e[n])){o=e[n++];a=e[n++]}else if(i<t.length){o=t[i++];a=t[i++]}else return r;if(!r.length||r[r.length-1]<o)r.push(o,a);else if(r[r.length-1]<a)r[r.length-1]=a}}function mergeTransaction(e,t,r){var n;var i,o,a;if(r){i=t.changes;o=ChangeSet.empty(t.changes.length);a=e.changes.compose(t.changes)}else{i=t.changes.map(e.changes);o=e.changes.mapDesc(t.changes,true);a=e.changes.compose(i)}return{changes:a,selection:t.selection?t.selection.map(o):(n=e.selection)===null||n===void 0?void 0:n.map(i),effects:StateEffect.mapEffects(e.effects,i).concat(StateEffect.mapEffects(t.effects,o)),annotations:e.annotations.length?e.annotations.concat(t.annotations):t.annotations,scrollIntoView:e.scrollIntoView||t.scrollIntoView,reconfigure:!t.reconfigure?e.reconfigure:t.reconfigure.full||!e.reconfigure?t.reconfigure:Object.assign({},e.reconfigure,t.reconfigure)}}function resolveTransactionInner(e,t,r){var n=t.reconfigure;if(n&&n.append){n=Object.assign({},n);var i=typeof Symbol=="undefined"?"__append"+Math.floor(Math.random()*4294967295):Symbol("appendConf");n[i]=n.append;n.append=undefined}var o=t.selection;return{changes:t.changes instanceof ChangeSet?t.changes:ChangeSet.of(t.changes||[],r,e.facet(lineSeparator)),selection:o&&(o instanceof EditorSelection?o:EditorSelection.single(o.anchor,o.head)),effects:!t.effects?none:Array.isArray(t.effects)?t.effects:[t.effects],annotations:!t.annotations?none:Array.isArray(t.annotations)?t.annotations:[t.annotations],scrollIntoView:!!t.scrollIntoView,reconfigure:n}}function resolveTransaction(e,t,r){var n=resolveTransactionInner(e,t.length?t[0]:{},e.doc.length);if(t.length&&t[0].filter===false)r=false;for(var i=1;i<t.length;i++){if(t[i].filter===false)r=false;var o=!!t[i].sequential;n=mergeTransaction(n,resolveTransactionInner(e,t[i],o?n.changes.newLength:e.doc.length),o)}var a=new Transaction(e,n.changes,n.selection,n.effects,n.annotations,n.reconfigure,n.scrollIntoView);return r?filterTransaction(a):a}function filterTransaction(e){var t=e.startState;var r=true;for(var n=0,i=t.facet(changeFilter);n<i.length;n++){var o=i[n];var a=o(e);if(a===false){r=false;break}if(Array.isArray(a))r=r===true?a:joinRanges(r,a)}if(r!==true){var s=void 0,l=void 0;if(r===false){l=e.changes.invertedDesc;s=ChangeSet.empty(t.doc.length)}else{var c=e.changes.filter(r);s=c.changes;l=c.filtered.invertedDesc}e=new Transaction(t,s,e.selection&&e.selection.map(l),StateEffect.mapEffects(e.effects,l),e.annotations,e.reconfigure,e.scrollIntoView)}var u=t.facet(transactionFilter);for(var f=u.length-1;f>=0;f--){var c=u[f](e);if(c instanceof Transaction)e=c;else if(Array.isArray(c)&&c.length==1&&c[0]instanceof Transaction)e=c[0];else e=resolveTransaction(t,Array.isArray(c)?c:[c],false)}return e}var none=[];var CharCategory;(function(e){e[e["Word"]=0]="Word";e[e["Space"]=1]="Space";e[e["Other"]=2]="Other"})(CharCategory||(CharCategory={}));var nonASCIISingleCaseWordChar=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;var wordChar;try{wordChar=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch(_){}function hasWordChar(e){if(wordChar)return wordChar.test(e);for(var t=0;t<e.length;t++){var r=e[t];if(/\w/.test(r)||r>""&&(r.toUpperCase()!=r.toLowerCase()||nonASCIISingleCaseWordChar.test(r)))return true}return false}function makeCategorizer(e){return function(t){if(!/\S/.test(t))return CharCategory.Space;if(hasWordChar(t))return CharCategory.Word;for(var r=0;r<e.length;r++)if(t.indexOf(e[r])>-1)return CharCategory.Word;return CharCategory.Other}}var EditorState=function(){function e(e,t,r,n){if(n===void 0){n=null}this.config=e;this.doc=t;this.selection=r;this.applying=null;this.status=e.statusTemplate.slice();if(n&&!n.reconfigure){this.values=n.startState.values.slice()}else{this.values=e.dynamicSlots.map((function(e){return null}));if(n)for(var i in e.address){var o=e.address[i],a=n.startState.config.address[i];if(a!=null&&(o&1)==0)this.values[o>>1]=getAddr(n.startState,a)}}this.applying=n;if(n)n._state=this;for(var s=0;s<this.config.dynamicSlots.length;s++)ensureAddr(this,s<<1);this.applying=null}e.prototype.field=function(e,t){if(t===void 0){t=true}var r=this.config.address[e.id];if(r==null){if(t)throw new RangeError("Field is not present in this state");return undefined}ensureAddr(this,r);return getAddr(this,r)};e.prototype.update=function(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}return resolveTransaction(this,e,true)};e.prototype.applyTransaction=function(t){var r=this.config;if(t.reconfigure)r=Configuration.resolve(t.reconfigure.full||r.source,Object.assign(r.replacements,t.reconfigure,{full:undefined}),this);new e(r,t.newDoc,t.newSelection,t)};e.prototype.replaceSelection=function(e){if(typeof e=="string")e=this.toText(e);return this.changeByRange((function(t){return{changes:{from:t.from,to:t.to,insert:e},range:EditorSelection.cursor(t.from+e.length)}}))};e.prototype.changeByRange=function(e){var t=this.selection;var r=e(t.ranges[0]);var n=this.changes(r.changes),i=[r.range];for(var o=1;o<t.ranges.length;o++){var a=e(t.ranges[o]);var s=this.changes(a.changes),l=s.map(n);for(var c=0;c<o;c++)i[c]=i[c].map(l);i.push(a.range.map(n.mapDesc(s,true)));n=n.compose(l)}return{changes:n,selection:EditorSelection.create(i,t.primaryIndex)}};e.prototype.changes=function(t){if(t===void 0){t=[]}if(t instanceof ChangeSet)return t;return ChangeSet.of(t,this.doc.length,this.facet(e.lineSeparator))};e.prototype.toText=function(t){return Text.of(t.split(this.facet(e.lineSeparator)||DefaultSplit))};e.prototype.sliceDoc=function(e,t){if(e===void 0){e=0}if(t===void 0){t=this.doc.length}return this.doc.sliceString(e,t,this.lineBreak)};e.prototype.facet=function(e){var t=this.config.address[e.id];if(t==null)return e.default;ensureAddr(this,t);return getAddr(this,t)};e.prototype.toJSON=function(){return{doc:this.sliceDoc(),selection:this.selection.toJSON()}};e.fromJSON=function(t,r){if(r===void 0){r={}}if(!t||typeof t.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");return e.create({doc:t.doc,selection:EditorSelection.fromJSON(t.selection),extensions:r.extensions})};e.create=function(t){if(t===void 0){t={}}var r=Configuration.resolve(t.extensions||[]);var n=t.doc instanceof Text?t.doc:Text.of((t.doc||"").split(r.staticFacet(e.lineSeparator)||DefaultSplit));var i=!t.selection?EditorSelection.single(0):t.selection instanceof EditorSelection?t.selection:EditorSelection.single(t.selection.anchor,t.selection.head);checkSelection(i,n.length);if(!r.staticFacet(allowMultipleSelections))i=i.asSingle();return new e(r,n,i)};Object.defineProperty(e.prototype,"tabSize",{get:function(){return this.facet(e.tabSize)},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"lineBreak",{get:function(){return this.facet(e.lineSeparator)||"\n"},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"indentUnit",{get:function(){var t=this.facet(e.indentUnit);return t.charCodeAt(0)==9?this.tabSize*t.length:t.length},enumerable:false,configurable:true});e.prototype.indentString=function(t){var r="";if(this.facet(e.indentUnit).charCodeAt(0)==9)while(t>=this.tabSize){r+="\t";t-=this.tabSize}for(var n=0;n<t;n++)r+=" ";return r};e.prototype.phrase=function(t){for(var r=0,n=this.facet(e.phrases);r<n.length;r++){var i=n[r];if(Object.prototype.hasOwnProperty.call(i,t))return i[t]}return t};e.prototype.charCategorizer=function(e){return makeCategorizer(this.languageDataAt("wordChars",e).join(""))};Object.defineProperty(e.prototype,"tree",{get:function(){var t=this.facet(e.syntax);return t.length?t[0].getTree(this):Tree.empty},enumerable:false,configurable:true});e.prototype.languageDataAt=function(t,r){var n=[];var i=this.facet(e.syntax);for(var o=i.length?0:1;o<2;o++){var a=this.facet(o?globalLanguageData:i[0].languageDataFacetAt(this,r));for(var s=0,l=a;s<l.length;s++){var c=l[s];if(Object.prototype.hasOwnProperty.call(c,t))n.push(c[t])}}return n};return e}();EditorState.allowMultipleSelections=allowMultipleSelections;EditorState.indentation=Facet.define();EditorState.tabSize=Facet.define({combine:function(e){return e.length?e[0]:4}});EditorState.lineSeparator=lineSeparator;EditorState.indentUnit=Facet.define({combine:function(e){if(!e.length)return"  ";if(!/^(?: +|\t+)$/.test(e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(e[0]));return e[0]}});EditorState.phrases=Facet.define();EditorState.syntax=Facet.define();EditorState.globalLanguageData=globalLanguageData;EditorState.foldable=Facet.define();EditorState.changeFilter=changeFilter;EditorState.transactionFilter=transactionFilter;function combineConfig(e,t,r){if(r===void 0){r={}}var n={};for(var i=0,o=e;i<o.length;i++){var a=o[i];for(var s=0,l=Object.keys(a);s<l.length;s++){var c=l[s];var u=a[c],f=n[c];if(f===undefined)n[c]=u;else if(f===u||u===undefined);else if(Object.hasOwnProperty.call(r,c))n[c]=r[c](f,u);else throw new Error("Config merge conflict for field "+c)}}for(var c in t)if(n[c]===undefined)n[c]=t[c];return n}var C="ͼ";var COUNT=typeof Symbol=="undefined"?"__"+C:Symbol.for(C);var SET=typeof Symbol=="undefined"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet");var top=typeof global=="undefined"?window:global;var StyleModule=function(){function e(e,t){this.rules=[];var r=t||{},n=r.process,i=r.extend;function o(e){if(/^@/.test(e))return[e];var t=e.split(",");return n?t.map(n):t}function a(e,t,r){var n=[],s=/^@(\w+)\b/.exec(e[0]);if(s&&t==null)return r.push(e[0]+";");var l=function(l){if(/&/.test(l)){a(e.map((function(e){return i?i(l,e):l.replace(/&/,e)})),t[l],r)}else if(typeof t[l]=="object"){if(!s)throw new RangeError("The value of a property ("+l+") should be a primitive value.");a(s[1]=="keyframes"?[l]:o(l),t[l],n)}else{n.push(l.replace(/_.*/,"").replace(/[A-Z]/g,(function(e){return"-"+e.toLowerCase()}))+": "+t[l]+";")}};for(var c in t){l(c)}if(n.length||s&&s[1]=="keyframes")r.push(e.join(",")+" {"+n.join(" ")+"}")}for(var s in e)a(o(s),e[s],this.rules)}e.newName=function(){var e=top[COUNT]||1;top[COUNT]=e+1;return C+e.toString(36)};e.mount=function(e,t){(e[SET]||new StyleSet(e)).mount(Array.isArray(t)?t:[t])};return e}();var adoptedSet=null;var StyleSet=function(){function e(e){if(e.adoptedStyleSheets&&typeof CSSStyleSheet!="undefined"){if(adoptedSet){e.adoptedStyleSheets=[adoptedSet.sheet].concat(e.adoptedStyleSheets);return e[SET]=adoptedSet}this.sheet=new CSSStyleSheet;e.adoptedStyleSheets=[this.sheet].concat(e.adoptedStyleSheets);adoptedSet=this}else{this.styleTag=(e.ownerDocument||e).createElement("style");var t=e.head||e;t.insertBefore(this.styleTag,t.firstChild)}this.modules=[];e[SET]=this}e.prototype.mount=function(e){var t=this.sheet;var r=0,n=0;for(var i=0;i<e.length;i++){var o=e[i],a=this.modules.indexOf(o);if(a<n&&a>-1){this.modules.splice(a,1);n--;a=-1}if(a==-1){this.modules.splice(n++,0,o);if(t)for(var s=0;s<o.rules.length;s++)t.insertRule(o.rules[s],r++)}else{while(n<a)r+=this.modules[n++].rules.length;r+=o.rules.length;n++}}if(!t){var l="";for(var c=0;c<this.modules.length;c++)l+=this.modules[c].rules.join("\n")+"\n";this.styleTag.textContent=l}};return e}();var RangeValue=function(){function e(){}e.prototype.eq=function(e){return this==e};e.prototype.range=function(e,t){if(t===void 0){t=e}return new Range(e,t,this)};return e}();RangeValue.prototype.startSide=RangeValue.prototype.endSide=0;RangeValue.prototype.point=false;RangeValue.prototype.mapMode=MapMode.TrackDel;var Range=function(){function e(e,t,r){this.from=e;this.to=t;this.value=r}return e}();function cmpRange(e,t){return e.from-t.from||e.value.startSide-t.value.startSide}var ChunkSize=250,BigPointSize=500,Far=1e9;var Chunk=function(){function e(e,t,r,n){this.from=e;this.to=t;this.value=r;this.maxPoint=n}Object.defineProperty(e.prototype,"length",{get:function(){return this.to[this.to.length-1]},enumerable:false,configurable:true});e.prototype.findIndex=function(e,t,r,n){if(r===void 0){r=t*Far}if(n===void 0){n=0}if(e<=0)return n;var i=t<0?this.to:this.from;for(var o=n,a=i.length;;){if(o==a)return o;var s=o+a>>1;var l=i[s]-e||(t<0?this.value[s].startSide:this.value[s].endSide)-r;if(s==o)return l>=0?o:a;if(l>=0)a=s;else o=s+1}};e.prototype.between=function(e,t,r,n){for(var i=this.findIndex(t,-1),o=this.findIndex(r,1,undefined,i);i<o;i++)if(n(this.from[i]+e,this.to[i]+e,this.value[i])===false)return false};e.prototype.map=function(t,r){var n=[],i=[],o=[],a=-1,s=-1;for(var l=0;l<this.value.length;l++){var c=this.value[l],u=this.from[l]+t,f=this.to[l]+t,h=void 0,d=void 0;if(u==f){var p=r.mapPos(u,c.startSide,c.mapMode);if(p==null)continue;h=d=p}else{h=r.mapPos(u,c.startSide);d=r.mapPos(f,c.endSide);if(h>d||h==d&&c.startSide>0&&c.endSide<=0)continue}if((d-h||c.endSide-c.startSide)<0)continue;if(a<0)a=h;if(c.point)s=Math.max(s,d-h);n.push(c);i.push(h-a);o.push(d-a)}return{mapped:n.length?new e(i,o,n,s):null,pos:a}};return e}();var RangeSet=function(){function e(t,r,n,i){if(n===void 0){n=e.empty}this.chunkPos=t;this.chunk=r;this.nextLayer=n;this.maxPoint=i}Object.defineProperty(e.prototype,"length",{get:function(){var e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"size",{get:function(){if(this==e.empty)return 0;var t=this.nextLayer.size;for(var r=0,n=this.chunk;r<n.length;r++){var i=n[r];t+=i.value.length}return t},enumerable:false,configurable:true});e.prototype.chunkEnd=function(e){return this.chunkPos[e]+this.chunk[e].length};e.prototype.update=function(t){var r=t.add,n=r===void 0?[]:r,i=t.sort,o=i===void 0?false:i,a=t.filter,s=t.filterFrom,l=s===void 0?0:s,c=t.filterTo,u=c===void 0?this.length:c;if(n.length==0&&!a)return this;if(o)n.slice().sort(cmpRange);if(this==e.empty)return n.length?e.of(n):this;var f=new LayerCursor(this,null,-1).goto(0),h=0,d=[];var p=new RangeSetBuilder;while(f.value||h<n.length){if(h<n.length&&(f.from-n[h].from||f.startSide-n[h].value.startSide)>=0){var g=n[h++];if(!p.addInner(g.from,g.to,g.value))d.push(g)}else if(f.rangeIndex==1&&f.chunkIndex<this.chunk.length&&(h==n.length||this.chunkEnd(f.chunkIndex)<n[h].from)&&(!a||l>this.chunkEnd(f.chunkIndex)||u<this.chunkPos[f.chunkIndex])&&p.addChunk(this.chunkPos[f.chunkIndex],this.chunk[f.chunkIndex])){f.nextChunk()}else{if(!a||l>f.to||u<f.from||a(f.from,f.to,f.value)){if(!p.addInner(f.from,f.to,f.value))d.push(new Range(f.from,f.to,f.value))}f.next()}}return p.finishInner(this.nextLayer==e.empty&&!d.length?e.empty:this.nextLayer.update({add:d,filter:a,filterFrom:l,filterTo:u}))};e.prototype.map=function(t){if(t.length==0||this==e.empty)return this;var r=[],n=[],i=-1;for(var o=0;o<this.chunk.length;o++){var a=this.chunkPos[o],s=this.chunk[o];var l=t.touchesRange(a,a+s.length);if(l===false){i=Math.max(i,s.maxPoint);r.push(s);n.push(t.mapPos(a))}else if(l===true){var c=s.map(a,t),u=c.mapped,f=c.pos;if(u){i=Math.max(i,u.maxPoint);r.push(u);n.push(f)}}}var h=this.nextLayer.map(t);return r.length==0?h:new e(n,r,h,i)};e.prototype.between=function(t,r,n){if(this==e.empty)return;for(var i=0;i<this.chunk.length;i++){var o=this.chunkPos[i],a=this.chunk[i];if(r>=o&&t<=o+a.length&&a.between(o,t-o,r-o,n)===false)return}this.nextLayer.between(t,r,n)};e.prototype.iter=function(e){if(e===void 0){e=0}return HeapCursor.from([this]).goto(e)};e.iter=function(e,t){if(t===void 0){t=0}return HeapCursor.from(e).goto(t)};e.compare=function(t,r,n,i){var o;var a=(o=i.minPointSize)!==null&&o!==void 0?o:-1;var s=t.filter((function(t){return t.maxPoint>=BigPointSize||t!=e.empty&&r.indexOf(t)<0&&t.maxPoint>=a}));var l=r.filter((function(r){return r.maxPoint>=BigPointSize||r!=e.empty&&t.indexOf(r)<0&&r.maxPoint>=a}));var c=findSharedChunks(s,l);var u=new SpanCursor(s,c,a);var f=new SpanCursor(l,c,a);n.iterGaps((function(e,t,r){return compare(u,e,f,t,r,i)}));if(n.empty&&n.length==0)compare(u,0,f,0,0,i)};e.spans=function(e,t,r,n){var i;var o=new SpanCursor(e,null,(i=n.minPointSize)!==null&&i!==void 0?i:-1).goto(t),a=t;var s=o.openStart;for(;;){var l=Math.min(o.to,r);if(o.point){n.point(a,l,o.point,o.activeForPoint(o.to),s);s=o.openEnd(l)+(o.to>l?1:0)}else if(l>a){n.span(a,l,o.active,s);s=o.openEnd(l)}if(o.to>r)break;a=o.to;o.next()}return s};e.of=function(e,t){if(t===void 0){t=false}var r=new RangeSetBuilder;for(var n=0,i=e instanceof Range?[e]:t?e.slice().sort(cmpRange):e;n<i.length;n++){var o=i[n];r.add(o.from,o.to,o.value)}return r.finish()};return e}();RangeSet.empty=new RangeSet([],[],null,-1);RangeSet.empty.nextLayer=RangeSet.empty;var RangeSetBuilder=function(){function e(){this.chunks=[];this.chunkPos=[];this.chunkStart=-1;this.last=null;this.lastFrom=-Far;this.lastTo=-Far;this.from=[];this.to=[];this.value=[];this.maxPoint=-1;this.setMaxPoint=-1;this.nextLayer=null}e.prototype.finishChunk=function(e){this.chunks.push(new Chunk(this.from,this.to,this.value,this.maxPoint));this.chunkPos.push(this.chunkStart);this.chunkStart=-1;this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint);this.maxPoint=-1;if(e){this.from=[];this.to=[];this.value=[]}};e.prototype.add=function(t,r,n){if(!this.addInner(t,r,n))(this.nextLayer||(this.nextLayer=new e)).add(t,r,n)};e.prototype.addInner=function(e,t,r){var n=e-this.lastTo||r.startSide-this.last.endSide;if(n<=0&&(e-this.lastFrom||r.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");if(n<0)return false;if(this.from.length==ChunkSize)this.finishChunk(true);if(this.chunkStart<0)this.chunkStart=e;this.from.push(e-this.chunkStart);this.to.push(t-this.chunkStart);this.last=r;this.lastFrom=e;this.lastTo=t;this.value.push(r);if(r.point)this.maxPoint=Math.max(this.maxPoint,t-e);return true};e.prototype.addChunk=function(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return false;if(this.from.length)this.finishChunk(true);this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint);this.chunks.push(t);this.chunkPos.push(e);var r=t.value.length-1;this.last=t.value[r];this.lastFrom=t.from[r]+e;this.lastTo=t.to[r]+e;return true};e.prototype.finish=function(){return this.finishInner(RangeSet.empty)};e.prototype.finishInner=function(e){if(this.from.length)this.finishChunk(false);if(this.chunks.length==0)return e;var t=new RangeSet(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);this.from=null;return t};return e}();function findSharedChunks(e,t){var r=new Map;for(var n=0,i=e;n<i.length;n++){var o=i[n];for(var a=0;a<o.chunk.length;a++)if(o.chunk[a].maxPoint<BigPointSize)r.set(o.chunk[a],o.chunkPos[a])}var s=new Set;for(var l=0,c=t;l<c.length;l++){var o=c[l];for(var u=0;u<o.chunk.length;u++)if(r.get(o.chunk[u])==o.chunkPos[u])s.add(o.chunk[u])}return s}var LayerCursor=function(){function e(e,t,r,n){if(n===void 0){n=0}this.layer=e;this.skip=t;this.minPoint=r;this.rank=n}Object.defineProperty(e.prototype,"startSide",{get:function(){return this.value?this.value.startSide:0},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"endSide",{get:function(){return this.value?this.value.endSide:0},enumerable:false,configurable:true});e.prototype.goto=function(e,t){if(t===void 0){t=-Far}this.chunkIndex=this.rangeIndex=0;this.gotoInner(e,t,false);return this};e.prototype.gotoInner=function(e,t,r){while(this.chunkIndex<this.layer.chunk.length){var n=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(n)||this.layer.chunkEnd(this.chunkIndex)<e||n.maxPoint<this.minPoint))break;this.chunkIndex++;r=false}var i=this.chunkIndex==this.layer.chunk.length?0:this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],-1,t);if(!r||this.rangeIndex<i)this.rangeIndex=i;this.next()};e.prototype.forward=function(e,t){if((this.to-e||this.endSide-t)<0)this.gotoInner(e,t,true)};e.prototype.next=function(){for(;;){if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=Far;this.value=null;break}else{var e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex];var r=e+t.from[this.rangeIndex];this.from=r;this.to=e+t.to[this.rangeIndex];this.value=t.value[this.rangeIndex];if(++this.rangeIndex==t.value.length){this.chunkIndex++;if(this.skip){while(this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]))this.chunkIndex++}this.rangeIndex=0}if(this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}};e.prototype.nextChunk=function(){this.chunkIndex++;this.rangeIndex=0;this.next()};e.prototype.compare=function(e){return this.from-e.from||this.startSide-e.startSide||this.to-e.to||this.endSide-e.endSide};return e}();var HeapCursor=function(){function e(e){this.heap=e}e.from=function(t,r,n){if(r===void 0){r=null}if(n===void 0){n=-1}var i=[];for(var o=0;o<t.length;o++){for(var a=t[o];a!=RangeSet.empty;a=a.nextLayer){if(a.maxPoint>=n)i.push(new LayerCursor(a,r,n,o))}}return i.length==1?i[0]:new e(i)};Object.defineProperty(e.prototype,"startSide",{get:function(){return this.value?this.value.startSide:0},enumerable:false,configurable:true});e.prototype.goto=function(e,t){if(t===void 0){t=-Far}for(var r=0,n=this.heap;r<n.length;r++){var i=n[r];i.goto(e,t)}for(var o=this.heap.length>>1;o>=0;o--)heapBubble(this.heap,o);this.next();return this};e.prototype.forward=function(e,t){for(var r=0,n=this.heap;r<n.length;r++){var i=n[r];i.forward(e,t)}for(var o=this.heap.length>>1;o>=0;o--)heapBubble(this.heap,o);if((this.to-e||this.value.endSide-t)<0)this.next()};e.prototype.next=function(){if(this.heap.length==0){this.from=this.to=Far;this.value=null;this.rank=-1}else{var e=this.heap[0];this.from=e.from;this.to=e.to;this.value=e.value;this.rank=e.rank;if(e.value)e.next();heapBubble(this.heap,0)}};return e}();function heapBubble(e,t){for(var r=e[t];;){var n=(t<<1)+1;if(n>=e.length)break;var i=e[n];if(n+1<e.length&&i.compare(e[n+1])>=0){i=e[n+1];n++}if(r.compare(i)<0)break;e[n]=r;e[t]=i;t=n}}var SpanCursor=function(){function e(e,t,r){this.minPoint=r;this.active=[];this.activeTo=[];this.activeRank=[];this.minActive=-1;this.point=null;this.pointFrom=0;this.pointRank=0;this.to=-Far;this.endSide=0;this.openStart=-1;this.cursor=HeapCursor.from(e,t,r)}e.prototype.goto=function(e,t){if(t===void 0){t=-Far}this.cursor.goto(e,t);this.active.length=this.activeTo.length=this.activeRank.length=0;this.minActive=-1;this.to=e;this.endSide=t;this.openStart=-1;this.next();return this};e.prototype.forward=function(e,t){while(this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0)this.removeActive(this.minActive);this.cursor.forward(e,t)};e.prototype.removeActive=function(e){remove(this.active,e);remove(this.activeTo,e);remove(this.activeRank,e);this.minActive=findMinIndex(this.active,this.activeTo)};e.prototype.addActive=function(e){var t=0,r=this.cursor,n=r.value,i=r.to,o=r.rank;while(t<this.activeRank.length&&this.activeRank[t]<=o)t++;insert(this.active,t,n);insert(this.activeTo,t,i);insert(this.activeRank,t,o);if(e)insert(e,t,this.cursor.from);this.minActive=findMinIndex(this.active,this.activeTo)};e.prototype.next=function(){var e=this.to;this.point=null;var t=this.openStart<0?[]:null,r=0;for(;;){var n=this.minActive;if(n>-1&&(this.activeTo[n]-this.cursor.from||this.active[n].endSide-this.cursor.startSide)<0){if(this.activeTo[n]>e){this.to=this.activeTo[n];this.endSide=this.active[n].endSide;break}this.removeActive(n);if(t)remove(t,n)}else if(!this.cursor.value){this.to=this.endSide=Far;break}else if(this.cursor.from>e){this.to=this.cursor.from;this.endSide=this.cursor.startSide;break}else{var i=this.cursor.value;if(!i.point){this.addActive(t);this.cursor.next()}else{this.point=i;this.pointFrom=this.cursor.from;this.pointRank=this.cursor.rank;this.to=this.cursor.to;this.endSide=i.endSide;if(this.cursor.from<e)r=1;this.cursor.next();if(this.to>e)this.forward(this.to,this.endSide);break}}}if(t){var o=0;while(o<t.length&&t[o]<e)o++;this.openStart=o+r}};e.prototype.activeForPoint=function(e){if(!this.active.length)return this.active;var t=[];for(var r=0;r<this.active.length;r++){if(this.activeRank[r]>this.pointRank)break;if(this.activeTo[r]>e||this.activeTo[r]==e&&this.active[r].endSide>this.point.endSide)t.push(this.active[r])}return t};e.prototype.openEnd=function(e){var t=0;while(t<this.activeTo.length&&this.activeTo[t]>e)t++;return t};return e}();function compare(e,t,r,n,i,o){e.goto(t);r.goto(n);var a=n+i;var s=n,l=n-t;for(;;){var c=e.to+l-r.to||e.endSide-r.endSide;var u=c<0?e.to+l:r.to,f=Math.min(u,a);if(e.point||r.point){if(!(e.point&&r.point&&(e.point==r.point||e.point.eq(r.point))))o.comparePoint(s,f,e.point,r.point)}else{if(f>s&&!sameValues(e.active,r.active))o.compareRange(s,f,e.active,r.active)}if(u>a)break;s=u;if(c<=0)e.next();if(c>=0)r.next()}}function sameValues(e,t){if(e.length!=t.length)return false;for(var r=0;r<e.length;r++)if(e[r]!=t[r]&&!e[r].eq(t[r]))return false;return true}function remove(e,t){for(var r=t,n=e.length-1;r<n;r++)e[r]=e[r+1];e.pop()}function insert(e,t,r){for(var n=e.length-1;n>=t;n--)e[n+1]=e[n];e[t]=r}function findMinIndex(e,t){var r=-1,n=Far;for(var i=0;i<t.length;i++)if((t[i]-n||e[i].endSide-e[r].endSide)<0){r=i;n=t[i]}return r}var base={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",229:"q"};var shift={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"',229:"Q"};var chrome=typeof navigator!="undefined"&&/Chrome\/(\d+)/.exec(navigator.userAgent);var safari=typeof navigator!="undefined"&&/Apple Computer/.test(navigator.vendor);var gecko=typeof navigator!="undefined"&&/Gecko\/\d+/.test(navigator.userAgent);var mac=typeof navigator!="undefined"&&/Mac/.test(navigator.platform);var ie=typeof navigator!="undefined"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);var brokenModifierNames=chrome&&(mac||+chrome[1]<57)||gecko&&mac;for(var i=0;i<10;i++)base[48+i]=base[96+i]=String(i);for(var i=1;i<=24;i++)base[i+111]="F"+i;for(var i=65;i<=90;i++){base[i]=String.fromCharCode(i+32);shift[i]=String.fromCharCode(i)}for(var code in base)if(!shift.hasOwnProperty(code))shift[code]=base[code];function keyName(e){var t=brokenModifierNames&&(e.ctrlKey||e.altKey||e.metaKey)||(safari||ie)&&e.shiftKey&&e.key&&e.key.length==1;var r=!t&&e.key||(e.shiftKey?shift:base)[e.keyCode]||e.key||"Unidentified";if(r=="Esc")r="Escape";if(r=="Del")r="Delete";if(r=="Left")r="ArrowLeft";if(r=="Up")r="ArrowUp";if(r=="Right")r="ArrowRight";if(r=="Down")r="ArrowDown";return r}var _h=typeof navigator!="undefined"?[navigator,document]:[{userAgent:"",vendor:"",platform:""},{documentElement:{style:{}}}],nav=_h[0],doc=_h[1];var ie_edge=/Edge\/(\d+)/.exec(nav.userAgent);var ie_upto10=/MSIE \d/.test(nav.userAgent);var ie_11up=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(nav.userAgent);var ie$1=!!(ie_upto10||ie_11up||ie_edge);var gecko$1=!ie$1&&/gecko\/(\d+)/i.test(nav.userAgent);var chrome$1=!ie$1&&/Chrome\/(\d+)/.exec(nav.userAgent);var webkit="webkitFontSmoothing"in doc.documentElement.style;var browser={mac:/Mac/.test(nav.platform),ie:ie$1,ie_version:ie_upto10?doc.documentMode||6:ie_11up?+ie_11up[1]:ie_edge?+ie_edge[1]:0,gecko:gecko$1,gecko_version:gecko$1?+(/Firefox\/(\d+)/.exec(nav.userAgent)||[0,0])[1]:0,chrome:!!chrome$1,chrome_version:chrome$1?+chrome$1[1]:0,ios:!ie$1&&/AppleWebKit/.test(nav.userAgent)&&/Mobile\/\w+/.test(nav.userAgent),android:/Android\b/.test(nav.userAgent),webkit:webkit,safari:/Apple Computer/.test(nav.vendor),webkit_version:webkit?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:doc.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};function getSelection(e){return e.getSelection?e.getSelection():document.getSelection()}function selectionCollapsed(e){var t=e.isCollapsed;if(t&&browser.chrome&&e.rangeCount&&!e.getRangeAt(0).collapsed)t=false;return t}function hasSelection(e,t){if(!t.anchorNode)return false;try{return e.contains(t.anchorNode.nodeType==3?t.anchorNode.parentNode:t.anchorNode)}catch(_){return false}}function clientRectsFor(e){if(e.nodeType==3){var t=tempRange();t.setEnd(e,e.nodeValue.length);t.setStart(e,0);return t.getClientRects()}else if(e.nodeType==1){return e.getClientRects()}else{return[]}}function isEquivalentPosition(e,t,r,n){return r?scanFor(e,t,r,n,-1)||scanFor(e,t,r,n,1):false}function domIndex(e){for(var t=0;;t++){e=e.previousSibling;if(!e)return t}}function scanFor(e,t,r,n,i){for(;;){if(e==r&&t==n)return true;if(t==(i<0?0:maxOffset(e))){if(e.nodeName=="DIV")return false;var o=e.parentNode;if(!o||o.nodeType!=1)return false;t=domIndex(e)+(i<0?0:1);e=o}else if(e.nodeType==1){e=e.childNodes[t+(i<0?-1:0)];t=i<0?maxOffset(e):0}else{return false}}}function maxOffset(e){return e.nodeType==3?e.nodeValue.length:e.childNodes.length}function flattenRect(e,t){var r=t?e.left:e.right;return{left:r,right:r,top:e.top,bottom:e.bottom}}function windowRect(e){return{left:0,right:e.innerWidth,top:0,bottom:e.innerHeight}}var ScrollSpace=5;function scrollRectIntoView(e,t){var r=e.ownerDocument,n=r.defaultView;for(var i=e.parentNode;i;){if(i.nodeType==1){var o=void 0,a=i==document.body;if(a){o=windowRect(n)}else{if(i.scrollHeight<=i.clientHeight&&i.scrollWidth<=i.clientWidth){i=i.parentNode;continue}var s=i.getBoundingClientRect();o={left:s.left,right:s.left+i.clientWidth,top:s.top,bottom:s.top+i.clientHeight}}var l=0,c=0;if(t.top<o.top)c=-(o.top-t.top+ScrollSpace);else if(t.bottom>o.bottom)c=t.bottom-o.bottom+ScrollSpace;if(t.left<o.left)l=-(o.left-t.left+ScrollSpace);else if(t.right>o.right)l=t.right-o.right+ScrollSpace;if(l||c){if(a){n.scrollBy(l,c)}else{if(c){var u=i.scrollTop;i.scrollTop+=c;c=i.scrollTop-u}if(l){var u=i.scrollLeft;i.scrollLeft+=l;l=i.scrollLeft-u}t={left:t.left-l,top:t.top-c,right:t.right-l,bottom:t.bottom-c}}}if(a)break;i=i.parentNode}else if(i.nodeType==11){i=i.host}else{break}}}var DOMSelection=function(){function e(){this.anchorNode=null;this.anchorOffset=0;this.focusNode=null;this.focusOffset=0}e.prototype.eq=function(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset};e.prototype.set=function(e){this.anchorNode=e.anchorNode;this.anchorOffset=e.anchorOffset;this.focusNode=e.focusNode;this.focusOffset=e.focusOffset};return e}();var preventScrollSupported=null;function focusPreventScroll(e){if(e.setActive)return e.setActive();if(preventScrollSupported)return e.focus(preventScrollSupported);var t=[];for(var r=e;r;r=r.parentNode){t.push(r,r.scrollTop,r.scrollLeft);if(r==r.ownerDocument)break}e.focus(preventScrollSupported==null?{get preventScroll(){preventScrollSupported={preventScroll:true};return true}}:undefined);if(!preventScrollSupported){preventScrollSupported=false;for(var n=0;n<t.length;){var i=t[n++],o=t[n++],a=t[n++];if(i.scrollTop!=o)i.scrollTop=o;if(i.scrollLeft!=a)i.scrollLeft=a}}}var scratchRange;function tempRange(){return scratchRange||(scratchRange=document.createRange())}var DOMPos=function(){function e(e,t,r){if(r===void 0){r=true}this.node=e;this.offset=t;this.precise=r}e.before=function(t,r){return new e(t.parentNode,domIndex(t),r)};e.after=function(t,r){return new e(t.parentNode,domIndex(t)+1,r)};return e}();var none$1=[];var ContentView=function(){function e(){this.parent=null;this.dom=null;this.dirty=2}Object.defineProperty(e.prototype,"editorView",{get:function(){if(!this.parent)throw new Error("Accessing view in orphan content view");return this.parent.editorView},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"overrideDOMText",{get:function(){return null},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"posAtStart",{get:function(){return this.parent?this.parent.posBefore(this):0},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"posAtEnd",{get:function(){return this.posAtStart+this.length},enumerable:false,configurable:true});e.prototype.posBefore=function(e){var t=this.posAtStart;for(var r=0,n=this.children;r<n.length;r++){var i=n[r];if(i==e)return t;t+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")};e.prototype.posAfter=function(e){return this.posBefore(e)+e.length};e.prototype.coordsAt=function(e,t){return null};e.prototype.sync=function(t){if(this.dirty&2){var r=this.dom,n=null;for(var i=0,o=this.children;i<o.length;i++){var a=o[i];if(a.dirty){var s=n?n.nextSibling:r.firstChild;if(s&&!a.dom&&!e.get(s))a.reuseDOM(s);a.sync(t);a.dirty=0}if(t&&t.node==r&&n!=a.dom)t.written=true;syncNodeInto(r,n,a.dom);n=a.dom}var l=n?n.nextSibling:r.firstChild;if(l&&t&&t.node==r)t.written=true;while(l)l=rm(l)}else if(this.dirty&1){for(var c=0,u=this.children;c<u.length;c++){var a=u[c];if(a.dirty){a.sync(t);a.dirty=0}}}};e.prototype.reuseDOM=function(e){return false};e.prototype.localPosFromDOM=function(t,r){var n;if(t==this.dom){n=this.dom.childNodes[r]}else{var i=maxOffset(t)==0?0:r==0?-1:1;for(;;){var o=t.parentNode;if(o==this.dom)break;if(i==0&&o.firstChild!=o.lastChild){if(t==o.firstChild)i=-1;else i=1}t=o}if(i<0)n=t;else n=t.nextSibling}if(n==this.dom.firstChild)return 0;while(n&&!e.get(n))n=n.nextSibling;if(!n)return this.length;for(var a=0,s=0;;a++){var l=this.children[a];if(l.dom==n)return s;s+=l.length+l.breakAfter}};e.prototype.domBoundsAround=function(e,t,r){if(r===void 0){r=0}var n=-1,i=-1,o=-1,a=-1;for(var s=0,l=r;s<this.children.length;s++){var c=this.children[s],u=l+c.length;if(l<e&&u>t)return c.domBoundsAround(e,t,l);if(u>=e&&n==-1){n=s;i=l}if(u>=t&&u!=l&&o==-1){o=s;a=u;break}l=u+c.breakAfter}return{from:i,to:a<0?r+this.length:a,startDOM:(n?this.children[n-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length-1&&o>=0?this.children[o+1].dom:null}};e.prototype.markDirty=function(e){if(e===void 0){e=false}if(this.dirty&2)return;this.dirty|=2;this.markParentsDirty(e)};e.prototype.markParentsDirty=function(e){for(var t=this.parent;t;t=t.parent){if(e)t.dirty|=2;if(t.dirty&1)return;t.dirty|=1;e=false}};e.prototype.setParent=function(e){if(this.parent!=e){this.parent=e;if(this.dirty)this.markParentsDirty(true)}};e.prototype.setDOM=function(e){this.dom=e;e.cmView=this};Object.defineProperty(e.prototype,"rootView",{get:function(){for(var e=this;;){var t=e.parent;if(!t)return e;e=t}},enumerable:false,configurable:true});e.prototype.replaceChildren=function(e,t,r){var n;if(r===void 0){r=none$1}this.markDirty();for(var i=e;i<t;i++)this.children[i].parent=null;(n=this.children).splice.apply(n,__spreadArrays([e,t-e],r));for(var o=0;o<r.length;o++)r[o].setParent(this)};e.prototype.ignoreMutation=function(e){return false};e.prototype.ignoreEvent=function(e){return false};e.prototype.childCursor=function(e){if(e===void 0){e=this.length}return new ChildCursor(this.children,e,this.children.length)};e.prototype.childPos=function(e,t){if(t===void 0){t=1}return this.childCursor().findPos(e,t)};e.prototype.toString=function(){var e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")};e.get=function(e){return e.cmView};return e}();ContentView.prototype.breakAfter=0;function rm(e){var t=e.nextSibling;e.parentNode.removeChild(e);return t}function syncNodeInto(e,t,r){var n=t?t.nextSibling:e.firstChild;if(r.parentNode==e)while(n!=r)n=rm(n);else e.insertBefore(r,n)}var ChildCursor=function(){function e(e,t,r){this.children=e;this.pos=t;this.i=r;this.off=0}e.prototype.findPos=function(e,t){if(t===void 0){t=1}for(;;){if(e>this.pos||e==this.pos&&(t>0||this.i==0||this.children[this.i-1].breakAfter)){this.off=e-this.pos;return this}var r=this.children[--this.i];this.pos-=r.length+r.breakAfter}};return e}();var none$1$1=[];var InlineView=function(e){__extends(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.become=function(e){return false};t.prototype.getSide=function(){return 0};return t}(ContentView);InlineView.prototype.children=none$1$1;var MaxJoinLen=256;var TextView=function(e){__extends(t,e);function t(t){var r=e.call(this)||this;r.text=t;return r}Object.defineProperty(t.prototype,"length",{get:function(){return this.text.length},enumerable:false,configurable:true});t.prototype.createDOM=function(e){this.setDOM(e||document.createTextNode(this.text))};t.prototype.sync=function(e){if(!this.dom)this.createDOM();if(this.dom.nodeValue!=this.text){if(e&&e.node==this.dom)e.written=true;this.dom.nodeValue=this.text}};t.prototype.reuseDOM=function(e){if(e.nodeType!=3)return false;this.createDOM(e);return true};t.prototype.merge=function(e,r,n){if(n&&(!(n instanceof t)||this.length-(r-e)+n.length>MaxJoinLen))return false;this.text=this.text.slice(0,e)+(n?n.text:"")+this.text.slice(r);this.markDirty();return true};t.prototype.slice=function(e){return new t(this.text.slice(e))};t.prototype.localPosFromDOM=function(e,t){return e==this.dom?t:t?this.text.length:0};t.prototype.domAtPos=function(e){return new DOMPos(this.dom,e)};t.prototype.domBoundsAround=function(e,t,r){return{from:r,to:r+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}};t.prototype.coordsAt=function(e,t){return textCoords(this.dom,e,t,this.length)};return t}(InlineView);var MarkView=function(e){__extends(t,e);function t(t,r,n){if(r===void 0){r=[]}if(n===void 0){n=0}var i=e.call(this)||this;i.mark=t;i.children=r;i.length=n;for(var o=0,a=r;o<a.length;o++){var s=a[o];s.setParent(i)}return i}t.prototype.createDOM=function(){var e=document.createElement(this.mark.tagName);if(this.mark.class)e.className=this.mark.class;if(this.mark.attrs)for(var t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);this.setDOM(e)};t.prototype.sync=function(t){if(!this.dom)this.createDOM();e.prototype.sync.call(this,t)};t.prototype.merge=function(e,r,n,i,o){if(n&&(!(n instanceof t&&n.mark.eq(this.mark))||e&&i<=0||r<this.length&&o<=0))return false;mergeInlineChildren(this,e,r,n?n.children:none$1$1,i-1,o-1);this.markDirty();return true};t.prototype.slice=function(e){return new t(this.mark,sliceInlineChildren(this.children,e),this.length-e)};t.prototype.domAtPos=function(e){return inlineDOMAtPos(this.dom,this.children,e)};t.prototype.coordsAt=function(e,t){return coordsInChildren(this,e,t)};return t}(InlineView);function textCoords(e,t,r,n){var i=t,o=t,a=0;if(t==0&&r<0||t==n&&r>=0){if(!(browser.chrome||browser.gecko)){if(t){i--;a=1}else{o++;a=-1}}}else{if(r<0)i--;else o++}var s=tempRange();s.setEnd(e,o);s.setStart(e,i);var l=s.getBoundingClientRect();return a?flattenRect(l,a<0):l}var WidgetView=function(e){__extends(t,e);function t(t,r,n){var i=e.call(this)||this;i.widget=t;i.length=r;i.side=n;return i}t.create=function(e,r,n){return new(e.customView||t)(e,r,n)};t.prototype.slice=function(e){return t.create(this.widget,this.length-e,this.side)};t.prototype.sync=function(){if(!this.dom||!this.widget.updateDOM(this.dom)){this.setDOM(this.widget.toDOM(this.editorView));this.dom.contentEditable="false"}};t.prototype.getSide=function(){return this.side};t.prototype.merge=function(e,r,n,i,o){if(n&&(!(n instanceof t)||!this.widget.compare(n.widget)||e>0&&i<=0||r<this.length&&o<=0))return false;this.length=e+(n?n.length:0)+(this.length-r);return true};t.prototype.become=function(e){if(e.length==this.length&&e instanceof t&&e.side==this.side){if(this.widget.constructor==e.widget.constructor){if(!this.widget.eq(e.widget))this.markDirty(true);this.widget=e.widget;return true}}return false};t.prototype.ignoreMutation=function(){return true};t.prototype.ignoreEvent=function(e){return this.widget.ignoreEvent(e)};Object.defineProperty(t.prototype,"overrideDOMText",{get:function(){if(this.length==0)return Text.empty;var e=this;while(e.parent)e=e.parent;var t=e.editorView,r=t&&t.state.doc,n=this.posAtStart;return r?r.slice(n,n+this.length):Text.empty},enumerable:false,configurable:true});t.prototype.domAtPos=function(e){return e==0?DOMPos.before(this.dom):DOMPos.after(this.dom,e==this.length)};t.prototype.domBoundsAround=function(){return null};t.prototype.coordsAt=function(e,t){var r=this.dom.getClientRects(),n=null;for(var i=e>0?r.length-1:0;;i+=e>0?-1:1){n=r[i];if(e>0?i==0:i==r.length-1||n.top<n.bottom)break}return n};return t}(InlineView);var CompositionView=function(e){__extends(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.domAtPos=function(e){return new DOMPos(this.widget.text,e)};t.prototype.sync=function(){if(!this.dom)this.setDOM(this.widget.toDOM())};t.prototype.localPosFromDOM=function(e,t){return!t?0:e.nodeType==3?Math.min(t,this.length):this.length};t.prototype.ignoreMutation=function(){return false};Object.defineProperty(t.prototype,"overrideDOMText",{get:function(){return null},enumerable:false,configurable:true});t.prototype.coordsAt=function(e,t){return textCoords(this.widget.text,e,t,this.length)};return t}(WidgetView);function mergeInlineChildren(e,t,r,n,i,o){var a=e.childCursor();var s=a.findPos(r,1),l=s.i,c=s.off;var u=a.findPos(t,-1),f=u.i,h=u.off;var d=t-r;for(var p=0,g=n;p<g.length;p++){var m=g[p];d+=m.length}e.length+=d;var v=e.children;if(f==l&&h){var O=v[f];if(n.length==1&&O.merge(h,c,n[0],i,o))return;if(n.length==0){O.merge(h,c,null,i,o);return}var y=O.slice(c);if(y.merge(0,0,n[n.length-1],0,o))n[n.length-1]=y;else n.push(y);l++;o=c=0}if(c){var b=v[l];if(n.length&&b.merge(0,c,n[n.length-1],0,o)){n.pop();o=0}else{b.merge(0,c,null,0,0)}}else if(l<v.length&&n.length&&v[l].merge(0,0,n[n.length-1],0,o)){n.pop();o=0}if(h){var O=v[f];if(n.length&&O.merge(h,O.length,n[0],i,0)){n.shift();i=0}else{O.merge(h,O.length,null,0,0)}f++}else if(f&&n.length){var b=v[f-1];if(b.merge(b.length,b.length,n[0],i,0)){n.shift();i=0}}while(f<l&&n.length&&v[l-1].become(n[n.length-1])){n.pop();l--;o=0}while(f<l&&n.length&&v[f].become(n[0])){n.shift();f++;i=0}if(!n.length&&f&&l<v.length&&i&&o&&v[l].merge(0,0,v[f-1],i,o))f--;if(n.length||f!=l)e.replaceChildren(f,l,n)}function sliceInlineChildren(e,t){var r=[],n=0;for(var i=0,o=e;i<o.length;i++){var a=o[i];var s=n+a.length;if(s>t)r.push(n<t?a.slice(t-n):a);n=s}return r}function inlineDOMAtPos(e,t,r){var n=0;for(var i=0;n<t.length;n++){var o=t[n],a=i+o.length;if(a==i&&o.getSide()<=0)continue;if(r>i&&r<a&&o.dom.parentNode==e)return o.domAtPos(r-i);if(r<=i)break;i=a}for(;n>0;n--){var s=t[n-1].dom;if(s.parentNode==e)return DOMPos.after(s)}return new DOMPos(e,0)}function joinInlineInto(e,t,r){var n,i=e.children;if(r>0&&t instanceof MarkView&&i.length&&(n=i[i.length-1])instanceof MarkView&&n.mark.eq(t.mark)){joinInlineInto(n,t.children[0],r-1)}else{i.push(t);t.setParent(e)}e.length+=t.length}function coordsInChildren(e,t,r){for(var n=0,i=0;i<e.children.length;i++){var o=e.children[i],a=n+o.length;if(a==n&&o.getSide()<=0)continue;if(r<=0||a==e.length?a>=t:a>t)return o.coordsAt(t-n,r);n=a}return(e.dom.lastChild||e.dom).getBoundingClientRect()}function combineAttrs(e,t){for(var r in e){if(r=="class"&&t.class)t.class+=" "+e.class;else if(r=="style"&&t.style)t.style+=";"+e.style;else t[r]=e[r]}return t}function attrsEq(e,t){if(e==t)return true;if(!e||!t)return false;var r=Object.keys(e),n=Object.keys(t);if(r.length!=n.length)return false;for(var i=0,o=r;i<o.length;i++){var a=o[i];if(n.indexOf(a)==-1||e[a]!==t[a])return false}return true}function updateAttrs(e,t,r){if(t)for(var n in t)if(!(r&&n in r))e.removeAttribute(n);if(r)for(var n in r)if(!(t&&t[n]==r[n]))e.setAttribute(n,r[n])}var WidgetType=function(){function e(){}e.prototype.eq=function(e){return false};e.prototype.updateDOM=function(e){return false};e.prototype.compare=function(e){return this==e||this.constructor==e.constructor&&this.eq(e)};Object.defineProperty(e.prototype,"estimatedHeight",{get:function(){return-1},enumerable:false,configurable:true});e.prototype.ignoreEvent=function(e){return true};Object.defineProperty(e.prototype,"customView",{get:function(){return null},enumerable:false,configurable:true});return e}();var BlockType;(function(e){e[e["Text"]=0]="Text";e[e["WidgetBefore"]=1]="WidgetBefore";e[e["WidgetAfter"]=2]="WidgetAfter";e[e["WidgetRange"]=3]="WidgetRange"})(BlockType||(BlockType={}));var Decoration=function(e){__extends(t,e);function t(t,r,n,i){var o=e.call(this)||this;o.startSide=t;o.endSide=r;o.widget=n;o.spec=i;return o}Object.defineProperty(t.prototype,"heightRelevant",{get:function(){return false},enumerable:false,configurable:true});t.mark=function(e){return new MarkDecoration(e)};t.widget=function(e){var t=e.side||0;if(e.block)t+=(2e8+1)*(t>0?1:-1);return new PointDecoration(e,t,t,!!e.block,e.widget||null,false)};t.replace=function(e){var t=!!e.block;var r=getInclusive(e),n=r.start,i=r.end;var o=t?-2e8*(n?2:1):1e8*(n?-1:1);var a=t?2e8*(i?2:1):1e8*(i?1:-1);return new PointDecoration(e,o,a,t,e.widget||null,true)};t.line=function(e){return new LineDecoration(e)};t.set=function(e,t){if(t===void 0){t=false}return RangeSet.of(e,t)};t.prototype.hasHeight=function(){return this.widget?this.widget.estimatedHeight>-1:false};return t}(RangeValue);Decoration.none=RangeSet.empty;var MarkDecoration=function(e){__extends(t,e);function t(t){var r=this;var n=getInclusive(t),i=n.start,o=n.end;r=e.call(this,1e8*(i?-1:1),1e8*(o?1:-1),null,t)||this;r.tagName=t.tagName||"span";r.class=t.class||"";r.attrs=t.attributes||null;return r}t.prototype.eq=function(e){return this==e||e instanceof t&&this.tagName==e.tagName&&this.class==e.class&&attrsEq(this.attrs,e.attrs)};t.prototype.range=function(t,r){if(r===void 0){r=t}if(t>=r)throw new RangeError("Mark decorations may not be empty");return e.prototype.range.call(this,t,r)};return t}(Decoration);MarkDecoration.prototype.point=false;var LineDecoration=function(e){__extends(t,e);function t(t){return e.call(this,-1e8,-1e8,null,t)||this}t.prototype.eq=function(e){return e instanceof t&&attrsEq(this.spec.attributes,e.spec.attributes)};t.prototype.range=function(t,r){if(r===void 0){r=t}if(r!=t)throw new RangeError("Line decoration ranges must be zero-length");return e.prototype.range.call(this,t,r)};return t}(Decoration);LineDecoration.prototype.mapMode=MapMode.TrackBefore;LineDecoration.prototype.point=true;var PointDecoration=function(e){__extends(t,e);function t(t,r,n,i,o,a){var s=e.call(this,r,n,o,t)||this;s.block=i;s.isReplace=a;s.mapMode=!i?MapMode.TrackDel:r<0?MapMode.TrackBefore:MapMode.TrackAfter;return s}Object.defineProperty(t.prototype,"type",{get:function(){return this.startSide<this.endSide?BlockType.WidgetRange:this.startSide<0?BlockType.WidgetBefore:BlockType.WidgetAfter},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"heightRelevant",{get:function(){return this.block||!!this.widget&&this.widget.estimatedHeight>=5},enumerable:false,configurable:true});t.prototype.eq=function(e){return e instanceof t&&widgetsEq(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide};t.prototype.range=function(t,r){if(r===void 0){r=t}if(this.isReplace&&(t>r||t==r&&this.startSide>0&&this.endSide<0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&r!=t)throw new RangeError("Widget decorations can only have zero-length ranges");return e.prototype.range.call(this,t,r)};return t}(Decoration);PointDecoration.prototype.point=true;function getInclusive(e){var t=e.inclusiveStart,r=e.inclusiveEnd;if(t==null)t=e.inclusive;if(r==null)r=e.inclusive;return{start:t||false,end:r||false}}function widgetsEq(e,t){return e==t||!!(e&&t&&e.compare(t))}var MinRangeGap=4;function addRange(e,t,r){var n=r.length-1;if(n>=0&&r[n]+MinRangeGap>e)r[n]=Math.max(r[n],t);else r.push(e,t)}var theme=Facet.define({combine:function(e){return e.join(" ")}});var darkTheme=Facet.define({combine:function(e){return e.indexOf(true)>-1}});var baseThemeID=StyleModule.newName();function expandThemeClasses(e){return e.replace(/\$\w[\w\.]*/g,(function(e){var t=e.slice(1).split("."),r="";for(var n=1;n<=t.length;n++)r+=".cm-"+t.slice(0,n).join("-");return r}))}function buildTheme(e,t){return new StyleModule(t,{process:function(t){t=expandThemeClasses(t);return/\$/.test(t)?t.replace(/\$/,e):e+" "+t},extend:function(t,r){t=expandThemeClasses(t);return r.slice(0,e.length+1)==e+" "?e+" "+t.replace(/&/,r.slice(e.length+1)):t.replace(/&/,r)}})}function themeClass(e){if(e.indexOf(".")<0)return"cm-"+e;var t=e.split("."),r="";for(var n=1;n<=t.length;n++)r+=(r?" ":"")+"cm-"+t.slice(0,n).join("-");return r}var baseTheme=buildTheme("."+baseThemeID,{$:{position:"relative !important",boxSizing:"border-box","&$focused":{outline_fallback:"1px dotted #212121",outline:"5px auto -webkit-focus-ring-color"},display:"flex !important",flexDirection:"column"},$scroller:{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},$content:{margin:0,flexGrow:2,minHeight:"100%",display:"block",whiteSpace:"pre",boxSizing:"border-box",padding:"4px 0",outline:"none"},"$$light $content":{caretColor:"black"},"$$dark $content":{caretColor:"white"},$line:{display:"block",padding:"0 2px 0 4px"},$selectionLayer:{zIndex:-1,contain:"size style"},$selectionBackground:{position:"absolute"},"$$light $selectionBackground":{background:"#d9d9d9"},"$$dark $selectionBackground":{background:"#222"},"$$focused$light $selectionBackground":{background:"#d7d4f0"},"$$focused$dark $selectionBackground":{background:"#233"},$cursorLayer:{zIndex:100,contain:"size style",pointerEvents:"none"},"$$focused $cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{visibility:"hidden"},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{visibility:"hidden"},"100%":{}},$cursor:{position:"absolute",borderLeft:"1.2px solid #aaa",marginLeft:"-0.6px",pointerEvents:"none"},"$$focused $cursor":{borderLeft:"1.2px solid black"},$placeholder:{color:"#888",display:"inline-block"},$button:{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"3px"},"$$light $button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"$$dark $button":{backgroundImage:"linear-gradient(#555, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},$textfield:{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"$$light $textfield":{backgroundColor:"white"},"$$dark $textfield":{border:"1px solid #555",backgroundColor:"inherit"}});var LineClass=themeClass("line");var LineView=function(e){__extends(t,e);function t(){var t=e.apply(this,arguments)||this;t.children=[];t.length=0;t.prevAttrs=undefined;t.attrs=null;t.breakAfter=0;return t}t.prototype.merge=function(e,r,n,i,o,a){if(n){if(!(n instanceof t))return false;if(!this.dom)n.transferDOM(this)}if(i)this.setDeco(n?n.attrs:null);mergeInlineChildren(this,e,r,n?n.children:none$2,o,a);return true};t.prototype.split=function(e){var r=new t;r.breakAfter=this.breakAfter;if(this.length==0)return r;var n=this.childPos(e),i=n.i,o=n.off;if(o){r.append(this.children[i].slice(o),0);this.children[i].merge(o,this.children[i].length,null,0,0);i++}for(var a=i;a<this.children.length;a++)r.append(this.children[a],0);while(i>0&&this.children[i-1].length==0){this.children[i-1].parent=null;i--}this.children.length=i;this.markDirty();this.length=e;return r};t.prototype.transferDOM=function(e){if(!this.dom)return;e.setDOM(this.dom);e.prevAttrs=this.prevAttrs===undefined?this.attrs:this.prevAttrs;this.prevAttrs=undefined;this.dom=null};t.prototype.setDeco=function(e){if(!attrsEq(this.attrs,e)){if(this.dom){this.prevAttrs=this.attrs;this.markDirty()}this.attrs=e}};t.prototype.append=function(e,t){joinInlineInto(this,e,t)};t.prototype.addLineDeco=function(e){var t=e.spec.attributes;if(t)this.attrs=combineAttrs(t,this.attrs||{})};t.prototype.domAtPos=function(e){return inlineDOMAtPos(this.dom,this.children,e)};t.prototype.sync=function(t){if(!this.dom){this.setDOM(document.createElement("div"));this.dom.className=LineClass;this.prevAttrs=this.attrs?null:undefined}if(this.prevAttrs!==undefined){updateAttrs(this.dom,this.prevAttrs,this.attrs);this.dom.classList.add(LineClass);this.prevAttrs=undefined}e.prototype.sync.call(this,t);var r=this.dom.lastChild;if(!r||r.nodeName!="BR"&&ContentView.get(r)instanceof WidgetView){var n=document.createElement("BR");n.cmIgnore=true;this.dom.appendChild(n)}};t.prototype.measureTextSize=function(){if(this.children.length==0||this.length>20)return null;var e=0;for(var t=0,r=this.children;t<r.length;t++){var n=r[t];if(!(n instanceof TextView))return null;var i=clientRectsFor(n.dom);if(i.length!=1)return null;e+=i[0].width}return{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length}};t.prototype.coordsAt=function(e,t){return coordsInChildren(this,e,t)};t.prototype.match=function(e){return false};Object.defineProperty(t.prototype,"type",{get:function(){return BlockType.Text},enumerable:false,configurable:true});t.find=function(e,r){for(var n=0,i=0;;n++){var o=e.children[n],a=i+o.length;if(a>=r){if(o instanceof t)return o;if(o.length)return null}i=a+o.breakAfter}};return t}(ContentView);var none$2=[];var BlockWidgetView=function(e){__extends(t,e);function t(t,r,n){var i=e.call(this)||this;i.widget=t;i.length=r;i.type=n;i.breakAfter=0;return i}t.prototype.merge=function(e,r,n,i,o,a){if(n&&(!(n instanceof t)||!this.widget.compare(n.widget)||e>0&&o<=0||r<this.length&&a<=0))return false;this.length=e+(n?n.length:0)+(this.length-r);return true};t.prototype.domAtPos=function(e){return e==0?DOMPos.before(this.dom):DOMPos.after(this.dom,e==this.length)};t.prototype.split=function(e){var r=this.length-e;this.length=e;return new t(this.widget,r,this.type)};Object.defineProperty(t.prototype,"children",{get:function(){return none$2},enumerable:false,configurable:true});t.prototype.sync=function(){if(!this.dom||!this.widget.updateDOM(this.dom)){this.setDOM(this.widget.toDOM(this.editorView));this.dom.contentEditable="false"}};Object.defineProperty(t.prototype,"overrideDOMText",{get:function(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):Text.empty},enumerable:false,configurable:true});t.prototype.domBoundsAround=function(){return null};t.prototype.match=function(e){if(e instanceof t&&e.type==this.type&&e.widget.constructor==this.widget.constructor){if(!e.widget.eq(this.widget))this.markDirty(true);this.widget=e.widget;this.length=e.length;this.breakAfter=e.breakAfter;return true}return false};return t}(ContentView);var ContentBuilder=function(){function e(e,t,r){this.doc=e;this.pos=t;this.end=r;this.content=[];this.curLine=null;this.breakAtStart=0;this.openStart=-1;this.openEnd=-1;this.text="";this.textOff=0;this.cursor=e.iter();this.skip=t}e.prototype.posCovered=function(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;var e=this.content[this.content.length-1];return!e.breakAfter&&!(e instanceof BlockWidgetView&&e.type==BlockType.WidgetBefore)};e.prototype.getLine=function(){if(!this.curLine)this.content.push(this.curLine=new LineView);return this.curLine};e.prototype.addWidget=function(e){this.curLine=null;this.content.push(e)};e.prototype.finish=function(){if(!this.posCovered())this.getLine()};e.prototype.wrapMarks=function(e,t){for(var r=t.length-1;r>=0;r--)e=new MarkView(t[r],[e],e.length);return e};e.prototype.buildText=function(e,t,r){while(e>0){if(this.textOff==this.text.length){var n=this.cursor.next(this.skip),i=n.value,o=n.lineBreak,a=n.done;this.skip=0;if(a)throw new Error("Ran out of text content when drawing inline views");if(o){if(!this.posCovered())this.getLine();if(this.content.length)this.content[this.content.length-1].breakAfter=1;else this.breakAtStart=1;this.curLine=null;e--;continue}else{this.text=i;this.textOff=0}}var s=Math.min(this.text.length-this.textOff,e);this.getLine().append(this.wrapMarks(new TextView(this.text.slice(this.textOff,this.textOff+s)),t),r);e-=s;this.textOff+=s}};e.prototype.span=function(e,t,r,n){this.buildText(t-e,r,n);this.pos=t;if(this.openStart<0)this.openStart=n};e.prototype.point=function(e,t,r,n,i){var o=t-e;if(r instanceof PointDecoration){if(r.block){var a=r.type;if(a==BlockType.WidgetAfter&&!this.posCovered())this.getLine();this.addWidget(new BlockWidgetView(r.widget||new NullWidget("div"),o,a))}else{var s=this.wrapMarks(WidgetView.create(r.widget||new NullWidget("span"),o,r.startSide),n);this.getLine().append(s,i)}}else if(this.doc.lineAt(this.pos).from==this.pos){this.getLine().addLineDeco(r)}if(o){if(this.textOff+o<=this.text.length){this.textOff+=o}else{this.skip+=o-(this.text.length-this.textOff);this.text="";this.textOff=0}this.pos=t}if(this.openStart<0)this.openStart=i};e.build=function(t,r,n,i){var o=new e(t,r,n);o.openEnd=RangeSet.spans(i,r,n,o);if(o.openStart<0)o.openStart=o.openEnd;o.finish();return o};return e}();var NullWidget=function(e){__extends(t,e);function t(t){var r=e.call(this)||this;r.tag=t;return r}t.prototype.eq=function(e){return e.tag==this.tag};t.prototype.toDOM=function(){return document.createElement(this.tag)};t.prototype.updateDOM=function(e){return e.nodeName.toLowerCase()==this.tag};return t}(WidgetType);var Direction;(function(e){e[e["LTR"]=0]="LTR";e[e["RTL"]=1]="RTL"})(Direction||(Direction={}));var LTR=Direction.LTR,RTL=Direction.RTL;function dec(e){var t=[];for(var r=0;r<e.length;r++)t.push(1<<+e[r]);return t}var LowTypes=dec("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008");var ArabicTypes=dec("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333");function charType(e){return e<=247?LowTypes[e]:1424<=e&&e<=1524?2:1536<=e&&e<=1785?ArabicTypes[e-1536]:1774<=e&&e<=2220?4:8192<=e&&e<=8203?256:e==8204?256:1}var BidiRE=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;var BidiSpan=function(){function e(e,t,r){this.from=e;this.to=t;this.level=r}Object.defineProperty(e.prototype,"dir",{get:function(){return this.level%2?RTL:LTR},enumerable:false,configurable:true});e.prototype.side=function(e,t){return this.dir==t==e?this.to:this.from};e.find=function(e,t,r,n){var i=-1;for(var o=0;o<e.length;o++){var a=e[o];if(a.from<=t&&a.to>=t){if(a.level==r)return o;if(i<0||(n!=0?n<0?a.from<t:a.to>t:e[i].level>a.level))i=o}}if(i<0)throw new RangeError("Index out of range");return i};return e}();var types=[];function computeOrder(e,t){var r=e.length,n=t==LTR?1:2;if(!e||n==1&&!BidiRE.test(e))return trivialOrder(r);for(var i=0,o=n,a=n;i<r;i++){var s=charType(e.charCodeAt(i));if(s==512)s=o;else if(s==8&&a==4)s=16;types[i]=s==4?2:s;if(s&7)a=s;o=s}for(var l=0,o=n,a=n;l<r;l++){var s=types[l];if(s==128){if(l<r-1&&o==types[l+1]&&o&24)s=types[l]=o;else types[l]=256}else if(s==64){var c=l+1;while(c<r&&types[c]==64)c++;var u=l&&o==8||c<r&&types[c]==8?a==1?1:8:256;for(var f=l;f<c;f++)types[f]=u;l=c-1}else if(s==8&&a==1){types[l]=1}o=s;if(s&7)a=s}for(var h=0;h<r;h++){if(types[h]==256){var c=h+1;while(c<r&&types[c]==256)c++;var d=(h?types[h-1]:n)==1;var p=(c<r?types[c]:n)==1;var u=d==p?d?1:2:n;for(var f=h;f<c;f++)types[f]=u;h=c-1}}var g=[];if(n==1){for(var m=0;m<r;){var v=m,O=types[m++]!=1;while(m<r&&O==(types[m]!=1))m++;if(O){for(var f=m;f>v;){var c=f,y=types[--f]!=2;while(f>v&&y==(types[f-1]!=2))f--;g.push(new BidiSpan(f,c,y?2:1))}}else{g.push(new BidiSpan(v,m,0))}}}else{for(var b=0;b<r;){var v=b,O=types[b++]==2;while(b<r&&O==(types[b]==2))b++;g.push(new BidiSpan(v,b,O?1:2))}}return g}function trivialOrder(e){return[new BidiSpan(0,e,0)]}var movedOver="";function moveVisually(e,t,r,n,i){var o;var a=n.head-e.from,s=-1;if(a==0){if(!i||!e.length)return null;if(t[0].level!=r){a=t[0].side(false,r);s=0}}else if(a==e.length){if(i)return null;var l=t[t.length-1];if(l.level!=r){a=l.side(true,r);s=t.length-1}}if(s<0)s=BidiSpan.find(t,a,(o=n.bidiLevel)!==null&&o!==void 0?o:-1,n.assoc);var c=t[s];if(a==c.side(i,r)){c=t[s+=i?1:-1];a=c.side(!i,r)}var u=i==(c.dir==r);var f=e.findClusterBreak(a,u);movedOver=e.slice(Math.min(a,f),Math.max(a,f));if(f!=c.side(i,r))return EditorSelection.cursor(f+e.from,u?-1:1,c.level);var h=s==(i?t.length-1:0)?null:t[s+(i?1:-1)];if(!h&&c.level!=r)return EditorSelection.cursor(i?e.to:e.from,i?-1:1,r);if(h&&h.level<c.level)return EditorSelection.cursor(h.side(!i,r)+e.from,0,h.level);return EditorSelection.cursor(f+e.from,0,c.level)}var wrappingWhiteSpace=["pre-wrap","normal","pre-line"];var HeightOracle=function(){function e(){this.doc=Text.empty;this.lineWrapping=false;this.direction=Direction.LTR;this.heightSamples={};this.lineHeight=14;this.charWidth=7;this.lineLength=30;this.heightChanged=false}e.prototype.heightForGap=function(e,t){var r=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;if(this.lineWrapping)r+=Math.ceil((t-e-r*this.lineLength*.5)/this.lineLength);return this.lineHeight*r};e.prototype.heightForLine=function(e){if(!this.lineWrapping)return this.lineHeight;var t=1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5)));return t*this.lineHeight};e.prototype.setDoc=function(e){this.doc=e;return this};e.prototype.mustRefresh=function(e,t,r){var n=false;for(var i=0;i<e.length;i++){var o=e[i];if(o<0){i++}else if(!this.heightSamples[Math.floor(o*10)]){n=true;this.heightSamples[Math.floor(o*10)]=true}}return n||wrappingWhiteSpace.indexOf(t)>-1!=this.lineWrapping||this.direction!=r};e.prototype.refresh=function(e,t,r,n,i,o){var a=wrappingWhiteSpace.indexOf(e)>-1;var s=Math.round(r)!=Math.round(this.lineHeight)||this.lineWrapping!=a||this.direction!=t;this.lineWrapping=a;this.direction=t;this.lineHeight=r;this.charWidth=n;this.lineLength=i;if(s){this.heightSamples={};for(var l=0;l<o.length;l++){var c=o[l];if(c<0)l++;else this.heightSamples[Math.floor(c*10)]=true}}return s};return e}();var MeasuredHeights=function(){function e(e,t){this.from=e;this.heights=t;this.index=0}Object.defineProperty(e.prototype,"more",{get:function(){return this.index<this.heights.length},enumerable:false,configurable:true});return e}();var BlockInfo=function(){function e(e,t,r,n,i){this.from=e;this.length=t;this.top=r;this.height=n;this.type=i}Object.defineProperty(e.prototype,"to",{get:function(){return this.from+this.length},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"bottom",{get:function(){return this.top+this.height},enumerable:false,configurable:true});e.prototype.join=function(t){var r=(Array.isArray(this.type)?this.type:[this]).concat(Array.isArray(t.type)?t.type:[t]);return new e(this.from,this.length+t.length,this.top,this.height+t.height,r)};return e}();var QueryType;(function(e){e[e["ByPos"]=0]="ByPos";e[e["ByHeight"]=1]="ByHeight";e[e["ByPosNoHeight"]=2]="ByPosNoHeight"})(QueryType||(QueryType={}));var Epsilon=1e-4;var HeightMap=function(){function e(e,t,r){if(r===void 0){r=2}this.length=e;this.height=t;this.flags=r}Object.defineProperty(e.prototype,"outdated",{get:function(){return(this.flags&2)>0},set:function(e){this.flags=(e?2:0)|this.flags&~2},enumerable:false,configurable:true});e.prototype.setHeight=function(e,t){if(this.height!=t){if(Math.abs(this.height-t)>Epsilon)e.heightChanged=true;this.height=t}};e.prototype.replace=function(t,r,n){return e.of(n)};e.prototype.decomposeLeft=function(e,t){t.push(this)};e.prototype.decomposeRight=function(e,t){t.push(this)};e.prototype.applyChanges=function(e,t,r,n){var i=this;for(var o=n.length-1;o>=0;o--){var a=n[o],s=a.fromA,l=a.toA,c=a.fromB,u=a.toB;var f=i.lineAt(s,QueryType.ByPosNoHeight,t,0,0);var h=f.to>=l?f:i.lineAt(l,QueryType.ByPosNoHeight,t,0,0);u+=h.to-l;l=h.to;while(o>0&&f.from<=n[o-1].toA){s=n[o-1].fromA;c=n[o-1].fromB;o--;if(s<f.from)f=i.lineAt(s,QueryType.ByPosNoHeight,t,0,0)}c+=f.from-s;s=f.from;var d=NodeBuilder.build(r,e,c,u);i=i.replace(s,l,d)}return i.updateHeight(r,0)};e.empty=function(){return new HeightMapText(0,0)};e.of=function(t){if(t.length==1)return t[0];var r=0,n=t.length,i=0,o=0;for(;;){if(r==n){if(i>o*2){var a=t[r-1];if(a.break)t.splice(--r,1,a.left,null,a.right);else t.splice(--r,1,a.left,a.right);n+=1+a.break;i-=a.size}else if(o>i*2){var a=t[n];if(a.break)t.splice(n,1,a.left,null,a.right);else t.splice(n,1,a.left,a.right);n+=2+a.break;o-=a.size}else{break}}else if(i<o){var s=t[r++];if(s)i+=s.size}else{var s=t[--n];if(s)o+=s.size}}var l=0;if(t[r-1]==null){l=1;r--}else if(t[r]==null){l=1;n++}return new HeightMapBranch(e.of(t.slice(0,r)),l,e.of(t.slice(n)))};return e}();HeightMap.prototype.size=1;var HeightMapBlock=function(e){__extends(t,e);function t(t,r,n){var i=e.call(this,t,r)||this;i.type=n;return i}t.prototype.blockAt=function(e,t,r,n){return new BlockInfo(n,this.length,r,this.height,this.type)};t.prototype.lineAt=function(e,t,r,n,i){return this.blockAt(0,r,n,i)};t.prototype.forEachLine=function(e,t,r,n,i,o){o(this.blockAt(0,r,n,i))};t.prototype.updateHeight=function(e,t,r,n){if(t===void 0){t=0}if(r===void 0){r=false}if(n&&n.from<=t&&n.more)this.setHeight(e,n.heights[n.index++]);this.outdated=false;return this};t.prototype.toString=function(){return"block("+this.length+")"};return t}(HeightMap);var HeightMapText=function(e){__extends(t,e);function t(t,r){var n=e.call(this,t,r,BlockType.Text)||this;n.collapsed=0;n.widgetHeight=0;return n}t.prototype.replace=function(e,r,n){var i=n[0];if(n.length==1&&(i instanceof t||i instanceof HeightMapGap&&i.flags&4)&&Math.abs(this.length-i.length)<10){if(i instanceof HeightMapGap)i=new t(i.length,this.height);else i.height=this.height;if(!this.outdated)i.outdated=false;return i}else{return HeightMap.of(n)}};t.prototype.updateHeight=function(e,t,r,n){if(t===void 0){t=0}if(r===void 0){r=false}if(n&&n.from<=t&&n.more)this.setHeight(e,n.heights[n.index++]);else if(r||this.outdated)this.setHeight(e,Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed)));this.outdated=false;return this};t.prototype.toString=function(){return"line("+this.length+(this.collapsed?-this.collapsed:"")+(this.widgetHeight?":"+this.widgetHeight:"")+")"};return t}(HeightMapBlock);var HeightMapGap=function(e){__extends(t,e);function t(t){return e.call(this,t,0)||this}t.prototype.lines=function(e,t){var r=e.lineAt(t).number,n=e.lineAt(t+this.length).number;return{firstLine:r,lastLine:n,lineHeight:this.height/(n-r+1)}};t.prototype.blockAt=function(e,t,r,n){var i=this.lines(t,n),o=i.firstLine,a=i.lastLine,s=i.lineHeight;var l=Math.max(0,Math.min(a-o,Math.floor((e-r)/s)));var c=t.line(o+l),u=c.from,f=c.length;return new BlockInfo(u,f,r+s*l,s,BlockType.Text)};t.prototype.lineAt=function(e,t,r,n,i){if(t==QueryType.ByHeight)return this.blockAt(e,r,n,i);if(t==QueryType.ByPosNoHeight){var o=r.lineAt(e),a=o.from,s=o.to;return new BlockInfo(a,s-a,0,0,BlockType.Text)}var l=this.lines(r,i),c=l.firstLine,u=l.lineHeight;var f=r.lineAt(e),h=f.from,d=f.length,p=f.number;return new BlockInfo(h,d,n+u*(p-c),u,BlockType.Text)};t.prototype.forEachLine=function(e,t,r,n,i,o){var a=this.lines(r,i),s=a.firstLine,l=a.lineHeight;for(var c=e;c<t;){var u=r.lineAt(c);if(c==e)n+=l*(u.number-s);o(new BlockInfo(u.from,u.length,n,n+=l,BlockType.Text));c=u.to+1}};t.prototype.replace=function(e,r,n){var i=this.length-r;if(i>0){var o=n[n.length-1];if(o instanceof t)n[n.length-1]=new t(o.length+i);else n.push(null,new t(i-1))}if(e>0){var a=n[0];if(a instanceof t)n[0]=new t(e+a.length);else n.unshift(new t(e-1),null)}return HeightMap.of(n)};t.prototype.decomposeLeft=function(e,r){r.push(new t(e-1),null)};t.prototype.decomposeRight=function(e,r){r.push(null,new t(this.length-e-1))};t.prototype.updateHeight=function(e,r,n,i){if(r===void 0){r=0}if(n===void 0){n=false}var o=r+this.length;if(i&&i.from<=r+this.length&&i.more){var a=[],s=Math.max(r,i.from);if(i.from>r)a.push(new t(i.from-r-1).updateHeight(e,r));while(s<=o&&i.more){var l=e.doc.lineAt(s).length;if(a.length)a.push(null);var c=new HeightMapText(l,i.heights[i.index++]);c.outdated=false;a.push(c);s+=l+1}if(s<=o)a.push(null,new t(o-s).updateHeight(e,s));e.heightChanged=true;return HeightMap.of(a)}else if(n||this.outdated){this.setHeight(e,e.heightForGap(r,r+this.length));this.outdated=false}return this};t.prototype.toString=function(){return"gap("+this.length+")"};return t}(HeightMap);var HeightMapBranch=function(e){__extends(t,e);function t(t,r,n){var i=e.call(this,t.length+r+n.length,t.height+n.height,r|(t.outdated||n.outdated?2:0))||this;i.left=t;i.right=n;i.size=t.size+n.size;return i}Object.defineProperty(t.prototype,"break",{get:function(){return this.flags&1},enumerable:false,configurable:true});t.prototype.blockAt=function(e,t,r,n){var i=r+this.left.height;return e<i||this.right.height==0?this.left.blockAt(e,t,r,n):this.right.blockAt(e,t,i,n+this.left.length+this.break)};t.prototype.lineAt=function(e,t,r,n,i){var o=n+this.left.height,a=i+this.left.length+this.break;var s=t==QueryType.ByHeight?e<o||this.right.height==0:e<a;var l=s?this.left.lineAt(e,t,r,n,i):this.right.lineAt(e,t,r,o,a);if(this.break||(s?l.to<a:l.from>a))return l;var c=t==QueryType.ByPosNoHeight?QueryType.ByPosNoHeight:QueryType.ByPos;if(s)return l.join(this.right.lineAt(a,c,r,o,a));else return this.left.lineAt(a,c,r,n,i).join(l)};t.prototype.forEachLine=function(e,t,r,n,i,o){var a=n+this.left.height,s=i+this.left.length+this.break;if(this.break){if(e<s)this.left.forEachLine(e,t,r,n,i,o);if(t>=s)this.right.forEachLine(e,t,r,a,s,o)}else{var l=this.lineAt(s,QueryType.ByPos,r,n,i);if(e<l.from)this.left.forEachLine(e,l.from-1,r,n,i,o);if(l.to>=e&&l.from<=t)o(l);if(t>l.to)this.right.forEachLine(l.to+1,t,r,a,s,o)}};t.prototype.replace=function(e,t,r){var n=this.left.length+this.break;if(t<n)return this.balanced(this.left.replace(e,t,r),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-n,t-n,r));var i=[];if(e>0)this.decomposeLeft(e,i);var o=i.length;for(var a=0,s=r;a<s.length;a++){var l=s[a];i.push(l)}if(e>0)mergeGaps(i,o-1);if(t<this.length){var c=i.length;this.decomposeRight(t,i);mergeGaps(i,c)}return HeightMap.of(i)};t.prototype.decomposeLeft=function(e,t){var r=this.left.length;if(e<=r)return this.left.decomposeLeft(e,t);t.push(this.left);if(this.break){r++;if(e>=r)t.push(null)}if(e>r)this.right.decomposeLeft(e-r,t)};t.prototype.decomposeRight=function(e,t){var r=this.left.length,n=r+this.break;if(e>=n)return this.right.decomposeRight(e-n,t);if(e<r)this.left.decomposeRight(e,t);if(this.break&&e<n)t.push(null);t.push(this.right)};t.prototype.balanced=function(e,t){if(e.size>2*t.size||t.size>2*e.size)return HeightMap.of(this.break?[e,null,t]:[e,t]);this.left=e;this.right=t;this.height=e.height+t.height;this.outdated=e.outdated||t.outdated;this.size=e.size+t.size;this.length=e.length+this.break+t.length;return this};t.prototype.updateHeight=function(e,t,r,n){if(t===void 0){t=0}if(r===void 0){r=false}var i=this,o=i.left,a=i.right,s=t+o.length+this.break,l=null;if(n&&n.from<=t+o.length&&n.more)l=o=o.updateHeight(e,t,r,n);else o.updateHeight(e,t,r);if(n&&n.from<=s+a.length&&n.more)l=a=a.updateHeight(e,s,r,n);else a.updateHeight(e,s,r);if(l)return this.balanced(o,a);this.height=this.left.height+this.right.height;this.outdated=false;return this};t.prototype.toString=function(){return this.left+(this.break?" ":"-")+this.right};return t}(HeightMap);function mergeGaps(e,t){var r,n;if(e[t]==null&&(r=e[t-1])instanceof HeightMapGap&&(n=e[t+1])instanceof HeightMapGap)e.splice(t-1,3,new HeightMapGap(r.length+1+n.length))}var relevantWidgetHeight=5;var NodeBuilder=function(){function e(e,t){this.pos=e;this.oracle=t;this.nodes=[];this.lineStart=-1;this.lineEnd=-1;this.covering=null;this.writtenTo=e}Object.defineProperty(e.prototype,"isCovered",{get:function(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering},enumerable:false,configurable:true});e.prototype.span=function(e,t){if(this.lineStart>-1){var r=Math.min(t,this.lineEnd),n=this.nodes[this.nodes.length-1];if(n instanceof HeightMapText)n.length+=r-this.pos;else if(r>this.pos||!this.isCovered)this.nodes.push(new HeightMapText(r-this.pos,-1));this.writtenTo=r;if(t>r){this.nodes.push(null);this.writtenTo++;this.lineStart=-1}}this.pos=t};e.prototype.point=function(e,t,r){if(e<t||r.heightRelevant){var n=r.widget?Math.max(0,r.widget.estimatedHeight):0;var i=t-e;if(r.block){this.addBlock(new HeightMapBlock(i,n,r.type))}else if(i||n>=relevantWidgetHeight){this.addLineDeco(n,i)}}else if(t>e){this.span(e,t)}if(this.lineEnd>-1&&this.lineEnd<this.pos)this.lineEnd=this.oracle.doc.lineAt(this.pos).to};e.prototype.enterLine=function(){if(this.lineStart>-1)return;var e=this.oracle.doc.lineAt(this.pos),t=e.from,r=e.to;this.lineStart=t;this.lineEnd=r;if(this.writtenTo<t){if(this.writtenTo<t-1||this.nodes[this.nodes.length-1]==null)this.nodes.push(this.blankContent(this.writtenTo,t-1));this.nodes.push(null)}if(this.pos>t)this.nodes.push(new HeightMapText(this.pos-t,-1));this.writtenTo=this.pos};e.prototype.blankContent=function(e,t){var r=new HeightMapGap(t-e);if(this.oracle.doc.lineAt(e).to==t)r.flags|=4;return r};e.prototype.ensureLine=function(){this.enterLine();var e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof HeightMapText)return e;var t=new HeightMapText(0,-1);this.nodes.push(t);return t};e.prototype.addBlock=function(e){this.enterLine();if(e.type==BlockType.WidgetAfter&&!this.isCovered)this.ensureLine();this.nodes.push(e);this.writtenTo=this.pos=this.pos+e.length;if(e.type!=BlockType.WidgetBefore)this.covering=e};e.prototype.addLineDeco=function(e,t){var r=this.ensureLine();r.length+=t;r.collapsed+=t;r.widgetHeight=Math.max(r.widgetHeight,e);this.writtenTo=this.pos=this.pos+t};e.prototype.finish=function(e){var t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];if(this.lineStart>-1&&!(t instanceof HeightMapText)&&!this.isCovered)this.nodes.push(new HeightMapText(0,-1));else if(this.writtenTo<this.pos||t==null)this.nodes.push(this.blankContent(this.writtenTo,this.pos));var r=e;for(var n=0,i=this.nodes;n<i.length;n++){var o=i[n];if(o instanceof HeightMapText)o.updateHeight(this.oracle,r);r+=o?o.length:1}return this.nodes};e.build=function(t,r,n,i){var o=new e(n,t);RangeSet.spans(r,n,i,o);return o.finish(n)};Object.defineProperty(e.prototype,"minPointSize",{get:function(){return 0},enumerable:false,configurable:true});return e}();function heightRelevantDecoChanges(e,t,r){var n=new DecorationComparator;RangeSet.compare(e,t,r,n);return n.changes}var DecorationComparator=function(){function e(){this.changes=[]}e.prototype.compareRange=function(){};e.prototype.comparePoint=function(e,t,r,n){if(e<t||r&&r.heightRelevant||n&&n.heightRelevant)addRange(e,t,this.changes)};Object.defineProperty(e.prototype,"minPointSize",{get:function(){return 0},enumerable:false,configurable:true});return e}();var none$3=[];var clickAddsSelectionRange=Facet.define();var dragMovesSelection=Facet.define();var mouseSelectionStyle=Facet.define();var exceptionSink=Facet.define();var updateListener=Facet.define();var inputHandler=Facet.define();function logException(e,t,r){var n=e.facet(exceptionSink);if(n.length)n[0](t);else if(window.onerror)window.onerror(String(t),r,undefined,undefined,t);else if(r)console.error(r+":",t);else console.error(t)}var editable=Facet.define({combine:function(e){return e.length?e[0]:true}});var PluginFieldProvider=function(){function e(e,t){this.field=e;this.get=t}return e}();var PluginField=function(){function e(){}e.prototype.from=function(e){return new PluginFieldProvider(this,e)};e.define=function(){return new e};return e}();PluginField.scrollMargins=PluginField.define();var nextPluginID=0;var viewPlugin=Facet.define();var ViewPlugin=function(){function e(e,t,r){this.id=e;this.create=t;this.fields=r;this.extension=viewPlugin.of(this)}e.define=function(t,r){var n=r||{},i=n.eventHandlers,o=n.provide,a=n.decorations;var s=[];if(o)for(var l=0,c=Array.isArray(o)?o:[o];l<c.length;l++){var u=c[l];s.push(u)}if(i)s.push(domEventHandlers.from((function(e){return{plugin:e,handlers:i}})));if(a)for(var f=0,h=Array.isArray(a)?a:[a];f<h.length;f++){var d=h[f];s.push(pluginDecorations.from(d))}return new e(nextPluginID++,t,s)};e.fromClass=function(t,r){return e.define((function(e){return new t(e)}),r)};return e}();var pluginDecorations=PluginField.define();var domEventHandlers=PluginField.define();var PluginInstance=function(){function e(e,t){this.value=e;this.spec=t}e.create=function(t,r){var n;try{n=t.create(r)}catch(i){logException(r.state,i,"CodeMirror plugin crashed");return e.dummy}return new e(n,t)};e.prototype.takeField=function(e,t){for(var r=0,n=this.spec.fields;r<n.length;r++){var i=n[r],o=i.field,a=i.get;if(o==e)t.push(a(this.value))}};e.prototype.update=function(t){if(!this.value.update)return this;try{this.value.update(t);return this}catch(r){logException(t.state,r,"CodeMirror plugin crashed");if(this.value.destroy)try{this.value.destroy()}catch(_){}return e.dummy}};e.prototype.destroy=function(e){if(this.value.destroy){try{this.value.destroy()}catch(t){logException(e.state,t,"CodeMirror plugin crashed")}}};return e}();PluginInstance.dummy=new PluginInstance({},ViewPlugin.define((function(){return{}})));var editorAttributes=Facet.define({combine:function(e){return e.reduce((function(e,t){return combineAttrs(t,e)}),{})}});var contentAttributes=Facet.define({combine:function(e){return e.reduce((function(e,t){return combineAttrs(t,e)}),{})}});var decorations=Facet.define();var styleModule=Facet.define();var ChangedRange=function(){function e(e,t,r,n){this.fromA=e;this.toA=t;this.fromB=r;this.toB=n}e.prototype.join=function(t){return new e(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))};e.prototype.addToSet=function(e){var t=e.length,r=this;for(;t>0;t--){var n=e[t-1];if(n.fromA>r.toA)continue;if(n.toA<r.fromA)break;r=r.join(n);e.splice(t-1,1)}e.splice(t,0,r);return e};e.extendWithRanges=function(t,r){if(r.length==0)return t;var n=[];for(var i=0,o=0,a=0,s=0;;i++){var l=i==t.length?null:t[i],c=a-s;var u=l?l.fromB:1e9;while(o<r.length&&r[o]<u){var f=r[o],h=r[o+1];var d=Math.max(s,f),p=Math.min(u,h);if(d<=p)new e(d+c,p+c,d,p).addToSet(n);if(h>u)break;else o+=2}if(!l)return n;new e(l.fromA,l.toA,l.fromB,l.toB).addToSet(n);a=l.toA;s=l.toB}};return e}();var ViewUpdate=function(){function e(e,t,r){if(r===void 0){r=none$3}this.view=e;this.state=t;this.transactions=r;this.flags=0;this.prevState=e.state;this.changes=ChangeSet.empty(this.prevState.doc.length);for(var n=0,i=r;n<i.length;n++){var o=i[n];this.changes=this.changes.compose(o.changes)}var a=[];this.changes.iterChangedRanges((function(e,t,r,n){return a.push(new ChangedRange(e,t,r,n))}));this.changedRanges=a;var s=e.hasFocus;if(s!=e.inputState.notifiedFocused){e.inputState.notifiedFocused=s}if(this.docChanged)this.flags|=2}Object.defineProperty(e.prototype,"viewportChanged",{get:function(){return(this.flags&4)>0},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"heightChanged",{get:function(){return(this.flags&2)>0},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"geometryChanged",{get:function(){return this.docChanged||(this.flags&(16|2))>0},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"focusChanged",{get:function(){return(this.flags&1)>0},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"docChanged",{get:function(){return this.transactions.some((function(e){return e.docChanged}))},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"selectionSet",{get:function(){return this.transactions.some((function(e){return e.selection}))},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"empty",{get:function(){return this.flags==0&&this.transactions.length==0},enumerable:false,configurable:true});return e}();function visiblePixelRange(e,t){var r=e.getBoundingClientRect();var n=Math.max(0,r.left),i=Math.min(innerWidth,r.right);var o=Math.max(0,r.top),a=Math.min(innerHeight,r.bottom);for(var s=e.parentNode;s;){if(s.nodeType==1){if((s.scrollHeight>s.clientHeight||s.scrollWidth>s.clientWidth)&&window.getComputedStyle(s).overflow!="visible"){var l=s.getBoundingClientRect();n=Math.max(n,l.left);i=Math.min(i,l.right);o=Math.max(o,l.top);a=Math.min(a,l.bottom)}s=s.parentNode}else if(s.nodeType==11){s=s.host}else{break}}return{left:n-r.left,right:i-r.left,top:o-(r.top+t),bottom:a-(r.top+t)}}var LineGap=function(){function e(e,t,r){this.from=e;this.to=t;this.size=r}e.same=function(e,t){if(e.length!=t.length)return false;for(var r=0;r<e.length;r++){var n=e[r],i=t[r];if(n.from!=i.from||n.to!=i.to||n.size!=i.size)return false}return true};e.prototype.draw=function(e){return Decoration.replace({widget:new LineGapWidget(this.size,e)}).range(this.from,this.to)};return e}();var LineGapWidget=function(e){__extends(t,e);function t(t,r){var n=e.call(this)||this;n.size=t;n.vertical=r;return n}t.prototype.eq=function(e){return e.size==this.size&&e.vertical==this.vertical};t.prototype.toDOM=function(){var e=document.createElement("div");if(this.vertical){e.style.height=this.size+"px"}else{e.style.width=this.size+"px";e.style.height="2px";e.style.display="inline-block"}return e};Object.defineProperty(t.prototype,"estimatedHeight",{get:function(){return this.vertical?this.size:-1},enumerable:false,configurable:true});return t}(WidgetType);var ViewState=function(){function e(e){this.state=e;this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0};this.inView=true;this.paddingTop=0;this.paddingBottom=0;this.contentWidth=0;this.heightOracle=new HeightOracle;this.heightMap=HeightMap.empty();this.scrollTo=null;this.printing=false;this.visibleRanges=[];this.mustEnforceCursorAssoc=false;this.heightMap=this.heightMap.applyChanges(e.facet(decorations),Text.empty,this.heightOracle.setDoc(e.doc),[new ChangedRange(0,0,0,e.doc.length)]);this.viewport=this.getViewport(0,null);this.lineGaps=this.ensureLineGaps([]);this.lineGapDeco=Decoration.set(this.lineGaps.map((function(e){return e.draw(false)})));this.computeVisibleRanges()}e.prototype.update=function(e,t){if(t===void 0){t=null}var r=this.state;this.state=e.state;var n=this.state.facet(decorations);var i=e.changedRanges;var o=ChangedRange.extendWithRanges(i,heightRelevantDecoChanges(e.prevState.facet(decorations),n,e?e.changes:ChangeSet.empty(this.state.doc.length)));var a=this.heightMap.height;this.heightMap=this.heightMap.applyChanges(n,r.doc,this.heightOracle.setDoc(this.state.doc),o);if(this.heightMap.height!=a)e.flags|=2;var s=o.length?this.mapViewport(this.viewport,e.changes):this.viewport;if(t&&(t.head<s.from||t.head>s.to)||!this.viewportIsAppropriate(s))s=this.getViewport(0,t);if(!s.eq(this.viewport)){this.viewport=s;e.flags|=4}if(this.lineGaps.length||this.viewport.to-this.viewport.from>15e3)e.flags|=this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes)));this.computeVisibleRanges();if(t)this.scrollTo=t;if(!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.primary.empty&&e.state.selection.primary.assoc)this.mustEnforceCursorAssoc=true};e.prototype.measure=function(e,t){var r=e.dom,n="",i=Direction.LTR;if(!t){var o=window.getComputedStyle(r);n=o.whiteSpace,i=o.direction=="rtl"?Direction.RTL:Direction.LTR;this.paddingTop=parseInt(o.paddingTop)||0;this.paddingBottom=parseInt(o.paddingBottom)||0}var a=this.printing?{top:-1e8,bottom:1e8,left:-1e8,right:1e8}:visiblePixelRange(r,this.paddingTop);var s=a.top-this.pixelViewport.top,l=a.bottom-this.pixelViewport.bottom;this.pixelViewport=a;this.inView=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(!this.inView)return 0;var c=e.measureVisibleLineHeights();var u=false,f=0,h=0,d=this.heightOracle;if(!t){var p=e.dom.clientWidth;if(d.mustRefresh(c,n,i)||d.lineWrapping&&Math.abs(p-this.contentWidth)>d.charWidth){var g=e.measureTextSize(),m=g.lineHeight,v=g.charWidth;u=d.refresh(n,i,m,v,p/v,c);if(u){e.minWidth=0;h|=16}}if(this.contentWidth!=p){this.contentWidth=p;h|=16}if(s>0&&l>0)f=Math.max(s,l);else if(s<0&&l<0)f=Math.min(s,l)}d.heightChanged=false;this.heightMap=this.heightMap.updateHeight(d,0,u,new MeasuredHeights(this.viewport.from,c));if(d.heightChanged)h|=2;if(!this.viewportIsAppropriate(this.viewport,f)||this.scrollTo&&(this.scrollTo.head<this.viewport.from||this.scrollTo.head>this.viewport.to)){this.viewport=this.getViewport(f,this.scrollTo);h|=4}if(this.lineGaps.length||this.viewport.to-this.viewport.from>15e3)h|=this.updateLineGaps(this.ensureLineGaps(u?[]:this.lineGaps));this.computeVisibleRanges();if(this.mustEnforceCursorAssoc){this.mustEnforceCursorAssoc=false;e.enforceCursorAssoc()}return h};e.prototype.getViewport=function(e,t){var r=.5-Math.max(-.5,Math.min(.5,e/1e3/2));var n=this.heightMap,i=this.state.doc,o=this.pixelViewport,a=o.top,s=o.bottom;var l=new Viewport(n.lineAt(a-r*1e3,QueryType.ByHeight,i,0,0).from,n.lineAt(s+(1-r)*1e3,QueryType.ByHeight,i,0,0).to);if(t){if(t.head<l.from){var c=n.lineAt(t.head,QueryType.ByPos,i,0,0).top;l=new Viewport(n.lineAt(c-1e3/2,QueryType.ByHeight,i,0,0).from,n.lineAt(c+(s-a)+1e3/2,QueryType.ByHeight,i,0,0).to)}else if(t.head>l.to){var u=n.lineAt(t.head,QueryType.ByPos,i,0,0).bottom;l=new Viewport(n.lineAt(u-(s-a)-1e3/2,QueryType.ByHeight,i,0,0).from,n.lineAt(u+1e3/2,QueryType.ByHeight,i,0,0).to)}}return l};e.prototype.mapViewport=function(e,t){var r=t.mapPos(e.from,-1),n=t.mapPos(e.to,1);return new Viewport(this.heightMap.lineAt(r,QueryType.ByPos,this.state.doc,0,0).from,this.heightMap.lineAt(n,QueryType.ByPos,this.state.doc,0,0).to)};e.prototype.viewportIsAppropriate=function(e,t){var r=e.from,n=e.to;if(t===void 0){t=0}var i=this.heightMap.lineAt(r,QueryType.ByPos,this.state.doc,0,0).top;var o=this.heightMap.lineAt(n,QueryType.ByPos,this.state.doc,0,0).bottom;return(r==0||i<=this.pixelViewport.top-Math.max(10,Math.min(-t,250)))&&(n==this.state.doc.length||o>=this.pixelViewport.bottom+Math.max(10,Math.min(t,250)))&&(i>this.pixelViewport.top-2*1e3&&o<this.pixelViewport.bottom+2*1e3)};e.prototype.mapLineGaps=function(e,t){if(!e.length||t.empty)return e;var r=[];for(var n=0,i=e;n<i.length;n++){var o=i[n];if(!t.touchesRange(o.from,o.to))r.push(new LineGap(t.mapPos(o.from),t.mapPos(o.to),o.size))}return r};e.prototype.ensureLineGaps=function(e){var t=this;var r=[];if(this.heightOracle.direction!=Direction.LTR)return r;this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.state.doc,0,0,(function(n){if(n.length<1e4)return;var i=lineStructure(n.from,n.to,t.state);if(i.total<1e4)return;var o,a;if(t.heightOracle.lineWrapping){if(n.from!=t.viewport.from)o=n.from;else o=findPosition(i,(t.pixelViewport.top-n.top)/n.height);if(n.to!=t.viewport.to)a=n.to;else a=findPosition(i,(t.pixelViewport.bottom-n.top)/n.height)}else{var s=i.total*t.heightOracle.charWidth;o=findPosition(i,t.pixelViewport.left/s);a=findPosition(i,t.pixelViewport.right/s)}var l=t.state.selection.primary;if(l.from<=o&&l.to>=n.from)o=l.from;if(l.from<=n.to&&l.to>=a)a=l.to;var c=o-1e4,u=a+1e4;if(c>n.from+5e3)r.push(find(e,(function(e){return e.from==n.from&&e.to>c-5e3&&e.to<c+5e3}))||new LineGap(n.from,c,t.gapSize(n,c,true,i)));if(u<n.to-5e3)r.push(find(e,(function(e){return e.to==n.to&&e.from>u-5e3&&e.from<u+5e3}))||new LineGap(u,n.to,t.gapSize(n,u,false,i)))}));return r};e.prototype.gapSize=function(e,t,r,n){if(this.heightOracle.lineWrapping){var i=e.height*findFraction(n,t);return r?i:e.height-i}else{var o=findFraction(n,t);return n.total*this.heightOracle.charWidth*(r?o:1-o)}};e.prototype.updateLineGaps=function(e){var t=this;if(!LineGap.same(e,this.lineGaps)){this.lineGaps=e;this.lineGapDeco=Decoration.set(e.map((function(e){return e.draw(t.heightOracle.lineWrapping)})));return 8}return 0};e.prototype.computeVisibleRanges=function(){var e=this.state.facet(decorations);if(this.lineGaps.length)e=e.concat(this.lineGapDeco);var t=[];RangeSet.spans(e,this.viewport.from,this.viewport.to,{span:function(e,r){t.push({from:e,to:r})},point:function(){},minPointSize:20});this.visibleRanges=t};e.prototype.lineAt=function(e,t){return this.heightMap.lineAt(e,QueryType.ByPos,this.state.doc,t+this.paddingTop,0)};e.prototype.lineAtHeight=function(e,t){return this.heightMap.lineAt(e,QueryType.ByHeight,this.state.doc,t+this.paddingTop,0)};e.prototype.blockAtHeight=function(e,t){return this.heightMap.blockAt(e,this.state.doc,t+this.paddingTop,0)};e.prototype.forEachLine=function(e,t,r,n){return this.heightMap.forEachLine(e,t,this.state.doc,n+this.paddingTop,0,r)};return e}();var Viewport=function(){function e(e,t){this.from=e;this.to=t}e.prototype.eq=function(e){return this.from==e.from&&this.to==e.to};return e}();function lineStructure(e,t,r){var n=[],i=e,o=0;RangeSet.spans(r.facet(decorations),e,t,{span:function(){},point:function(e,t){if(e>i){n.push({from:i,to:e});o+=e-i}i=t},minPointSize:20});if(i<t){n.push({from:i,to:t});o+=t-i}return{total:o,ranges:n}}function findPosition(e,t){var r=e.total,n=e.ranges;if(t<=0)return n[0].from;if(t>=1)return n[n.length-1].to;var i=Math.floor(r*t);for(var o=0;;o++){var a=n[o],s=a.from,l=a.to,c=l-s;if(i<=c)return s+i;i-=c}}function findFraction(e,t){var r=0;for(var n=0,i=e.ranges;n<i.length;n++){var o=i[n],a=o.from,s=o.to;if(t<=s){r+=t-a;break}r+=s-a}return r/e.total}function find(e,t){for(var r=0,n=e;r<n.length;r++){var i=n[r];if(t(i))return i}return undefined}var none$4=[];var DocView=function(e){__extends(t,e);function t(t){var r=e.call(this)||this;r.view=t;r.viewports=none$4;r.compositionDeco=Decoration.none;r.decorations=[];r.minWidth=0;r.minWidthFrom=0;r.minWidthTo=0;r.impreciseAnchor=null;r.impreciseHead=null;r.setDOM(t.contentDOM);r.children=[new LineView];r.children[0].setParent(r);r.updateInner([new ChangedRange(0,0,0,t.state.doc.length)],r.updateDeco(),0);return r}Object.defineProperty(t.prototype,"root",{get:function(){return this.view.root},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"editorView",{get:function(){return this.view},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"length",{get:function(){return this.view.state.doc.length},enumerable:false,configurable:true});t.prototype.update=function(e){var t=this;var r;var n=e.changedRanges;if(this.minWidth>0&&n.length){if(!n.every((function(e){var r=e.fromA,n=e.toA;return n<t.minWidthFrom||r>t.minWidthTo}))){this.minWidth=0}else{this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1);this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)}}if(!((r=this.view.inputState)===null||r===void 0?void 0:r.composing))this.compositionDeco=Decoration.none;else if(e.transactions.length)this.compositionDeco=computeCompositionDeco(this.view,e.changes);var i=(browser.ie||browser.chrome)&&!this.compositionDeco.size&&e&&e.state.doc.lines!=e.prevState.doc.lines;var o=this.decorations,a=this.updateDeco();var s=findChangedDeco(o,a,e.changes);n=ChangedRange.extendWithRanges(n,s);var l=e.transactions.some((function(e){return e.annotation(Transaction.userEvent)=="pointerselection"}));if(this.dirty==0&&n.length==0&&!(e.flags&(4|8))&&e.state.selection.primary.from>=this.view.viewport.from&&e.state.selection.primary.to<=this.view.viewport.to){this.updateSelection(i,l);return false}else{this.updateInner(n,a,e.prevState.doc.length,i,l);return true}};t.prototype.updateInner=function(e,t,r,n,i){var o=this;if(n===void 0){n=false}if(i===void 0){i=false}this.updateChildren(e,t,r);this.view.observer.ignore((function(){o.dom.style.height=o.view.viewState.heightMap.height+"px";o.dom.style.minWidth=o.minWidth?o.minWidth+"px":"";var e=browser.chrome?{node:getSelection(o.view.root).focusNode,written:false}:undefined;o.sync(e);o.dirty=0;if(e===null||e===void 0?void 0:e.written)n=true;o.updateSelection(n,i);o.dom.style.height=""}))};t.prototype.updateChildren=function(e,t,r){var n=this.childCursor(r);for(var i=e.length-1;;i--){var o=i>=0?e[i]:null;if(!o)break;var a=o.fromA,s=o.toA,l=o.fromB,c=o.toB;var u=ContentBuilder.build(this.view.state.doc,l,c,t),f=u.content,h=u.breakAtStart,d=u.openStart,p=u.openEnd;var g=n.findPos(s,1),m=g.i,v=g.off;var O=n.findPos(a,-1),y=O.i,b=O.off;this.replaceRange(y,b,m,v,f,h,d,p)}};t.prototype.replaceRange=function(e,t,r,n,i,o,a,s){var l=this.children[e],c=i.length?i[i.length-1]:null;var u=c?c.breakAfter:o;if(e==r&&!o&&!u&&i.length<2&&l.merge(t,n,i.length?c:null,t==0,a,s))return;var f=this.children[r];if(n<f.length||f.children.length&&f.children[f.children.length-1].length==0){if(e==r){f=f.split(n);n=0}if(!u&&c&&f.merge(0,n,c,true,0,s)){i[i.length-1]=f}else{if(n||f.children.length&&f.children[0].length==0)f.merge(0,n,null,false,0,s);i.push(f)}}else if(f.breakAfter){if(c)c.breakAfter=1;else o=1}r++;l.breakAfter=o;if(t>0){if(!o&&i.length&&l.merge(t,l.length,i[0],false,a,0)){l.breakAfter=i.shift().breakAfter}else if(t<l.length||l.children.length&&l.children[l.children.length-1].length==0){l.merge(t,l.length,null,false,a,0)}e++}while(e<r&&i.length){if(this.children[r-1].match(i[i.length-1]))r--,i.pop();else if(this.children[e].match(i[0]))e++,i.shift();else break}if(e<r||i.length)this.replaceChildren(e,r,i)};t.prototype.updateSelection=function(e,t){if(e===void 0){e=false}if(t===void 0){t=false}if(!(t||this.mayControlSelection()))return;var r=this.view.state.selection.primary;var n=this.domAtPos(r.anchor);var i=this.domAtPos(r.head);var o=getSelection(this.root);if(e||!o.focusNode||browser.gecko&&r.empty&&nextToUneditable(o.focusNode,o.focusOffset)||!isEquivalentPosition(n.node,n.offset,o.anchorNode,o.anchorOffset)||!isEquivalentPosition(i.node,i.offset,o.focusNode,o.focusOffset)){this.view.observer.ignore((function(){var e;if(r.empty){if(browser.gecko){var t=nextToUneditable(n.node,n.offset);if(t&&t!=(1|2)){var a=nearbyTextNode(n.node,n.offset,t==1?1:-1);if(a)n=new DOMPos(a,t==1?0:a.nodeValue.length)}}o.collapse(n.node,n.offset);if(r.bidiLevel!=null&&o.cursorBidiLevel!=null)o.cursorBidiLevel=r.bidiLevel}else if(o.extend){o.collapse(n.node,n.offset);o.extend(i.node,i.offset)}else{var s=document.createRange();if(r.anchor>r.head)e=[i,n],n=e[0],i=e[1];s.setEnd(i.node,i.offset);s.setStart(n.node,n.offset);o.removeAllRanges();o.addRange(s)}}))}this.impreciseAnchor=n.precise?null:new DOMPos(o.anchorNode,o.anchorOffset);this.impreciseHead=i.precise?null:new DOMPos(o.focusNode,o.focusOffset)};t.prototype.enforceCursorAssoc=function(){var e=this.view.state.selection.primary;var t=getSelection(this.root);if(!e.empty||!e.assoc||!t.modify)return;var r=LineView.find(this,e.head);if(!r)return;var n=r.posAtStart;if(e.head==n||e.head==n+r.length)return;var i=this.coordsAt(e.head,-1),o=this.coordsAt(e.head,1);if(!i||!o||i.bottom>o.top)return;var a=this.domAtPos(e.head+e.assoc);t.collapse(a.node,a.offset);t.modify("move",e.assoc<0?"forward":"backward","lineboundary")};t.prototype.mayControlSelection=function(){return this.view.state.facet(editable)?this.root.activeElement==this.dom:hasSelection(this.dom,getSelection(this.root))};t.prototype.nearest=function(e){for(var t=e;t;){var r=ContentView.get(t);if(r&&r.rootView==this)return r;t=t.parentNode}return null};t.prototype.posFromDOM=function(e,t){var r=this.nearest(e);if(!r)throw new RangeError("Trying to find position for a DOM position outside of the document");return r.localPosFromDOM(e,t)+r.posAtStart};t.prototype.domAtPos=function(e){var t=this.childCursor().findPos(e,-1),r=t.i,n=t.off;for(;r<this.children.length-1;){var i=this.children[r];if(n<i.length||i instanceof LineView)break;r++;n=0}return this.children[r].domAtPos(n)};t.prototype.coordsAt=function(e,t){for(var r=this.length,n=this.children.length-1;;n--){var i=this.children[n],o=r-i.breakAfter-i.length;if(e>=o&&i.type!=BlockType.WidgetAfter)return i.coordsAt(e-o,t);r=o}};t.prototype.measureVisibleLineHeights=function(){var e=[],t=this.view.viewState.viewport,r=t.from,n=t.to;var i=Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1;for(var o=0,a=0;a<this.children.length;a++){var s=this.children[a],l=o+s.length;if(l>n)break;if(o>=r){e.push(s.dom.getBoundingClientRect().height);var c=s.dom.scrollWidth;if(c>i){this.minWidth=i=c;this.minWidthFrom=o;this.minWidthTo=l}}o=l+s.breakAfter}return e};t.prototype.measureTextSize=function(){var e=this;for(var t=0,r=this.children;t<r.length;t++){var n=r[t];if(n instanceof LineView){var i=n.measureTextSize();if(i)return i}}var o=document.createElement("div"),a,s;o.className="cm-line";o.textContent="abc def ghi jkl mno pqr stu";this.view.observer.ignore((function(){e.dom.appendChild(o);var t=clientRectsFor(o.firstChild)[0];a=o.getBoundingClientRect().height;s=t?t.width/27:7;o.remove()}));return{lineHeight:a,charWidth:s}};t.prototype.childCursor=function(e){if(e===void 0){e=this.length}var t=this.children.length;if(t)e-=this.children[--t].length;return new ChildCursor(this.children,e,t)};t.prototype.computeBlockGapDeco=function(){var e=this.view.viewState.viewport,t=[e];var r=this.view.state.selection.primary,n=r.head,i=r.anchor;if(n<e.from||n>e.to){var o=this.view.viewState.lineAt(n,0),a=o.from,s=o.to;t.push(new Viewport(a,s))}if(!t.some((function(e){var t=e.from,r=e.to;return i>=t&&i<=r}))){var l=this.view.viewState.lineAt(i,0),a=l.from,s=l.to;t.push(new Viewport(a,s))}this.viewports=t.sort((function(e,t){return e.from-t.from}));var c=[];for(var u=0,f=0;;f++){var h=f==t.length?null:t[f];var d=h?h.from-1:this.length;if(d>u){var p=this.view.viewState.lineAt(d,0).bottom-this.view.viewState.lineAt(u,0).top;c.push(Decoration.replace({widget:new BlockGapWidget(p),block:true,inclusive:true}).range(u,d))}if(!h)break;u=h.to+1}return Decoration.set(c)};t.prototype.updateDeco=function(){return this.decorations=__spreadArrays([this.computeBlockGapDeco(),this.view.viewState.lineGapDeco,this.compositionDeco],this.view.state.facet(decorations),this.view.pluginField(pluginDecorations))};t.prototype.scrollPosIntoView=function(e,t){var r=this.coordsAt(e,t);if(!r)return;var n=0,i=0,o=0,a=0;for(var s=0,l=this.view.pluginField(PluginField.scrollMargins);s<l.length;s++){var c=l[s];if(c){var u=c.left,f=c.right,h=c.top,d=c.bottom;if(u!=null)n=Math.max(n,u);if(f!=null)i=Math.max(i,f);if(h!=null)o=Math.max(o,h);if(d!=null)a=Math.max(a,d)}}scrollRectIntoView(this.dom,{left:r.left-n,top:r.top-o,right:r.right+i,bottom:r.bottom+a})};return t}(ContentView);var MaxNodeHeight=1e7;var BlockGapWidget=function(e){__extends(t,e);function t(t){var r=e.call(this)||this;r.height=t;return r}t.prototype.toDOM=function(){var e=document.createElement("div");this.updateDOM(e);return e};t.prototype.eq=function(e){return e.height==this.height};t.prototype.updateDOM=function(e){if(this.height<MaxNodeHeight){while(e.lastChild)e.lastChild.remove();e.style.height=this.height+"px"}else{e.style.height="";for(var t=this.height;t>0;t-=MaxNodeHeight){var r=e.appendChild(document.createElement("div"));r.style.height=Math.min(t,MaxNodeHeight)+"px"}}return true};Object.defineProperty(t.prototype,"estimatedHeight",{get:function(){return this.height},enumerable:false,configurable:true});return t}(WidgetType);function computeCompositionDeco(e,t){var r=getSelection(e.root);var n=r.focusNode&&nearbyTextNode(r.focusNode,r.focusOffset,0);if(!n)return Decoration.none;var i=e.docView.nearest(n);var o,a,s=n;if(i instanceof InlineView){while(i.parent instanceof InlineView)i=i.parent;o=i.posAtStart;a=o+i.length;s=i.dom}else if(i instanceof LineView){while(s.parentNode!=i.dom)s=s.parentNode;var l=s.previousSibling;while(l&&!ContentView.get(l))l=l.previousSibling;o=a=l?ContentView.get(l).posAtEnd:i.posAtStart}else{return Decoration.none}var c=t.mapPos(o,1),u=Math.max(c,t.mapPos(a,-1));var f=n.nodeValue,h=e.state;if(u-c<f.length){if(h.sliceDoc(c,Math.min(h.doc.length,c+f.length))==f)u=c+f.length;else if(h.sliceDoc(Math.max(0,u-f.length),u)==f)c=u-f.length;else return Decoration.none}else if(h.sliceDoc(c,u)!=f){return Decoration.none}return Decoration.set(Decoration.replace({widget:new CompositionWidget(s,n)}).range(c,u))}var CompositionWidget=function(e){__extends(t,e);function t(t,r){var n=e.call(this)||this;n.top=t;n.text=r;return n}t.prototype.eq=function(e){return this.top==e.top&&this.text==e.text};t.prototype.toDOM=function(){return this.top};t.prototype.ignoreEvent=function(){return false};Object.defineProperty(t.prototype,"customView",{get:function(){return CompositionView},enumerable:false,configurable:true});return t}(WidgetType);function nearbyTextNode(e,t,r){for(;;){if(e.nodeType==3)return e;if(e.nodeType==1&&t>0&&r<=0){e=e.childNodes[t-1];t=maxOffset(e)}else if(e.nodeType==1&&t<e.childNodes.length&&r>=0){e=e.childNodes[t];t=0}else{return null}}}function nextToUneditable(e,t){if(e.nodeType!=1)return 0;return(t&&e.childNodes[t-1].contentEditable=="false"?1:0)|(t<e.childNodes.length&&e.childNodes[t].contentEditable=="false"?2:0)}var DecorationComparator$1=function(){function e(){this.changes=[]}e.prototype.compareRange=function(e,t){addRange(e,t,this.changes)};e.prototype.comparePoint=function(e,t){addRange(e,t,this.changes)};return e}();function findChangedDeco(e,t,r){var n=new DecorationComparator$1;RangeSet.compare(e,t,r,n);return n.changes}function groupAt(e,t,r){if(r===void 0){r=1}var n=e.charCategorizer(t);var i=e.doc.lineAt(t),o=t-i.from;if(i.length==0)return EditorSelection.cursor(t);if(o==0)r=1;else if(o==i.length)r=-1;var a=o,s=o;if(r<0)a=i.findClusterBreak(o,false);else s=i.findClusterBreak(o,true);var l=n(i.slice(a,s));while(a>0){var c=i.findClusterBreak(a,false);if(n(i.slice(c,a))!=l)break;a=c}while(s<i.length){var u=i.findClusterBreak(s,true);if(n(i.slice(s,u))!=l)break;s=u}return EditorSelection.range(a+i.from,s+i.from)}function getdx(e,t){return t.left>e?t.left-e:Math.max(0,e-t.right)}function getdy(e,t){return t.top>e?t.top-e:Math.max(0,e-t.bottom)}function yOverlap(e,t){return e.top<t.bottom-1&&e.bottom>t.top+1}function upTop(e,t){return t<e.top?{top:t,left:e.left,right:e.right,bottom:e.bottom}:e}function upBot(e,t){return t>e.bottom?{top:e.top,left:e.left,right:e.right,bottom:t}:e}function domPosAtCoords(e,t,r){var n,i,o,a;var s,l,c,u;for(var f=e.firstChild;f;f=f.nextSibling){var h=clientRectsFor(f);for(var d=0;d<h.length;d++){var p=h[d];if(i&&yOverlap(i,p))p=upTop(upBot(p,i.bottom),i.top);var g=getdx(t,p),m=getdy(r,p);if(g==0&&m==0)return f.nodeType==3?domPosInText(f,t,r):domPosAtCoords(f,t,r);if(!n||a>m||a==m&&o>g){n=f;i=p;o=g;a=m}if(g==0){if(r>p.bottom&&(!c||c.bottom<p.bottom)){s=f;c=p}else if(r<p.top&&(!u||u.top>p.top)){l=f;u=p}}else if(c&&yOverlap(c,p)){c=upBot(c,p.bottom)}else if(u&&yOverlap(u,p)){u=upTop(u,p.top)}}}if(c&&c.bottom>=r){n=s;i=c}else if(u&&u.top<=r){n=l;i=u}if(!n)return{node:e,offset:0};var v=Math.max(i.left,Math.min(i.right,t));if(n.nodeType==3)return domPosInText(n,v,r);if(!o&&n.contentEditable=="true")return domPosAtCoords(n,v,r);var O=Array.prototype.indexOf.call(e.childNodes,n)+(t>=(i.left+i.right)/2?1:0);return{node:e,offset:O}}function domPosInText(e,t,r){var n=e.nodeValue.length,i=tempRange();for(var o=0;o<n;o++){i.setEnd(e,o+1);i.setStart(e,o);var a=i.getClientRects();for(var s=0;s<a.length;s++){var l=a[s];if(l.top==l.bottom)continue;if(l.left-1<=t&&l.right+1>=t&&l.top-1<=r&&l.bottom+1>=r){var c=t>=(l.left+l.right)/2,u=c;if(browser.chrome||browser.gecko){i.setEnd(e,o);var f=i.getBoundingClientRect();if(f.left==l.right)u=!c}return{node:e,offset:o+(u?1:0)}}}}return{node:e,offset:0}}function posAtCoords(e,t,r){var n;var i=t.x,o=t.y;if(r===void 0){r=-1}var a=e.contentDOM.getBoundingClientRect(),s;var l=e.defaultLineHeight/2;for(var c=false;;){s=e.blockAtHeight(o,a.top);if(s.top>o||s.bottom<o){r=s.top>o?-1:1;o=Math.min(s.bottom-l,Math.max(s.top+l,o));if(c)return-1;else c=true}if(s.type==BlockType.Text)break;o=r>0?s.bottom+l:s.top-l}var u=s.from;if(u<e.viewport.from)return e.viewport.from==0?0:null;if(u>e.viewport.to)return e.viewport.to==e.state.doc.length?e.state.doc.length:null;i=Math.max(a.left+1,Math.min(a.right-1,i));var f=e.root,h=f.elementFromPoint(i,o);var d,p=-1;if(h&&e.contentDOM.contains(h)&&!(e.docView.nearest(h)instanceof WidgetView)){if(f.caretPositionFromPoint){var g=f.caretPositionFromPoint(i,o);if(g)d=g.offsetNode,p=g.offset}else if(f.caretRangeFromPoint){var m=f.caretRangeFromPoint(i,o);if(m)d=m.startContainer,p=m.startOffset}}if(!d||!e.docView.dom.contains(d)){var v=LineView.find(e.docView,u);n=domPosAtCoords(v.dom,i,o),d=n.node,p=n.offset}return e.docView.posFromDOM(d,p)}function moveToLineBoundary(e,t,r,n){var i=e.state.doc.lineAt(t.head);var o=!n||!e.lineWrapping?null:e.coordsAtPos(t.assoc<0&&t.head>i.from?t.head-1:t.head);if(o){var a=e.dom.getBoundingClientRect();var s=e.posAtCoords({x:r==(e.textDirection==Direction.LTR)?a.right-1:a.left+1,y:(o.top+o.bottom)/2});if(s!=null)return EditorSelection.cursor(s,r?-1:1)}var l=LineView.find(e.docView,t.head);var c=l?r?l.posAtEnd:l.posAtStart:r?i.to:i.from;return EditorSelection.cursor(c,r?-1:1)}function moveByChar(e,t,r,n){var i=e.state.doc.lineAt(t.head),o=e.bidiSpans(i);for(var a=t,s=null;;){var l=moveVisually(i,o,e.textDirection,a,r),c=movedOver;if(!l){if(i.number==(r?e.state.doc.lines:1))return a;c="\n";i=e.state.doc.line(i.number+(r?1:-1));o=e.bidiSpans(i);l=EditorSelection.cursor(r?i.from:i.to)}if(!s){if(!n)return l;s=n(c)}else if(!s(c)){return a}a=l}}function byGroup(e,t,r){var n=e.state.charCategorizer(t);var i=n(r);return function(e){var t=n(e);if(i==CharCategory.Space)i=t;return i==t}}function moveVertically(e,t,r,n){var i;var o=t.head,a=r?1:-1;if(o==(r?e.state.doc.length:0))return EditorSelection.cursor(o);var s=e.coordsAtPos(o);if(s){var l=e.dom.getBoundingClientRect();var c=(i=t.goalColumn)!==null&&i!==void 0?i:s.left-l.left;var u=l.left+c;var f=n!==null&&n!==void 0?n:5;for(var h=a<0?s.top:s.bottom,d=0;d<50;d+=10){var p=posAtCoords(e,{x:u,y:h+(f+d)*a},a);if(p==null)break;if(p!=o)return EditorSelection.cursor(p,undefined,undefined,c)}}var g=e.state.doc,m=g.lineAt(o),v=e.state.tabSize;var O=t.goalColumn,y=0;if(O==null){for(var b=g.iterRange(m.from,o);!b.next().done;)y=countColumn(b.value,y,v);O=y*e.defaultCharacterWidth}else{y=Math.round(O/e.defaultCharacterWidth)}if(a<0&&m.from==0)return EditorSelection.cursor(0);else if(a>0&&m.to==g.length)return EditorSelection.cursor(m.to);var S=g.line(m.number+a);var w=S.from;var x=0;for(var b=g.iterRange(S.from,S.to);x>=y&&!b.next().done;){var k=findColumn(b.value,x,y,v),P=k.offset,C=k.leftOver;x=y-C;w+=P}return EditorSelection.cursor(w,undefined,undefined,O)}var InputState=function(){function e(e){var t=this;this.lastKeyCode=0;this.lastKeyTime=0;this.lastSelectionOrigin=null;this.lastSelectionTime=0;this.scrollHandlers=[];this.registeredEvents=[];this.customHandlers=[];this.composing=false;this.compositionEndedAt=0;this.mouseSelection=null;var r=function(r){var i=handlers[r];e.contentDOM.addEventListener(r,(function(n){if(!eventBelongsToEditor(e,n)||t.ignoreDuringComposition(n))return;if(t.mustFlushObserver(n))e.observer.forceFlush();if(t.runCustomHandlers(r,e,n))n.preventDefault();else i(e,n)}));n.registeredEvents.push(r)};var n=this;for(var i in handlers){r(i)}e.contentDOM.addEventListener("keydown",(function(t){e.inputState.lastKeyCode=t.keyCode;e.inputState.lastKeyTime=Date.now()}));this.notifiedFocused=e.hasFocus;this.ensureHandlers(e)}e.prototype.setSelectionOrigin=function(e){this.lastSelectionOrigin=e;this.lastSelectionTime=Date.now()};e.prototype.ensureHandlers=function(e){var t=this;var r=this.customHandlers=e.pluginField(domEventHandlers);for(var n=0,i=r;n<i.length;n++){var o=i[n];var a=function(r){if(s.registeredEvents.indexOf(r)<0&&r!="scroll"){s.registeredEvents.push(r);e.contentDOM.addEventListener(r,(function(n){if(!eventBelongsToEditor(e,n))return;if(t.runCustomHandlers(r,e,n))n.preventDefault()}))}};var s=this;for(var l in o.handlers){a(l)}}};e.prototype.runCustomHandlers=function(e,t,r){for(var n=0,i=this.customHandlers;n<i.length;n++){var o=i[n];var a=o.handlers[e];if(a){try{if(a.call(o.plugin,r,t)||r.defaultPrevented)return true}catch(s){logException(t.state,s)}}}return false};e.prototype.runScrollHandlers=function(e,t){for(var r=0,n=this.customHandlers;r<n.length;r++){var i=n[r];var o=i.handlers.scroll;if(o){try{o.call(i.plugin,t,e)}catch(a){logException(e.state,a)}}}};e.prototype.ignoreDuringComposition=function(e){if(!/^key/.test(e.type))return false;if(this.composing)return true;if(browser.safari&&e.timeStamp-this.compositionEndedAt<500){this.compositionEndedAt=0;return true}return false};e.prototype.mustFlushObserver=function(e){return e.type=="keydown"||e.type=="compositionend"};e.prototype.startMouseSelection=function(e,t,r){if(this.mouseSelection)this.mouseSelection.destroy();this.mouseSelection=new MouseSelection(this,e,t,r)};e.prototype.update=function(e){if(this.mouseSelection)this.mouseSelection.update(e);this.lastKeyCode=this.lastSelectionTime=0};e.prototype.destroy=function(){if(this.mouseSelection)this.mouseSelection.destroy()};return e}();var MouseSelection=function(){function e(e,t,r,n){this.inputState=e;this.view=t;this.startEvent=r;this.style=n;var i=t.contentDOM.ownerDocument;i.addEventListener("mousemove",this.move=this.move.bind(this));i.addEventListener("mouseup",this.up=this.up.bind(this));this.extend=r.shiftKey;this.multiple=t.state.facet(EditorState.allowMultipleSelections)&&addsSelectionRange(t,r);this.dragMove=dragMovesSelection$1(t,r);this.dragging=isInPrimarySelection(t,r)?null:false;if(this.dragging===false){r.preventDefault();this.select(r)}}e.prototype.move=function(e){if(e.buttons==0)return this.destroy();if(this.dragging!==false)return;this.select(e)};e.prototype.up=function(e){if(this.dragging==null)this.select(this.startEvent);if(!this.dragging)e.preventDefault();this.destroy()};e.prototype.destroy=function(){var e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move);e.removeEventListener("mouseup",this.up);this.inputState.mouseSelection=null};e.prototype.select=function(e){var t=this.style.get(e,this.extend,this.multiple);if(!t.eq(this.view.state.selection)||t.primary.assoc!=this.view.state.selection.primary.assoc)this.view.dispatch({selection:t,annotations:Transaction.userEvent.of("pointerselection"),scrollIntoView:true})};e.prototype.update=function(e){if(e.docChanged&&this.dragging)this.dragging=this.dragging.map(e.changes);this.style.update(e)};return e}();function addsSelectionRange(e,t){var r=e.state.facet(clickAddsSelectionRange);return r.length?r[0](t):browser.mac?t.metaKey:t.ctrlKey}function dragMovesSelection$1(e,t){var r=e.state.facet(dragMovesSelection);return r.length?r[0](t):browser.mac?!t.altKey:!t.ctrlKey}function isInPrimarySelection(e,t){var r=e.state.selection.primary;if(r.empty)return false;var n=getSelection(e.root);if(n.rangeCount==0)return true;var i=n.getRangeAt(0).getClientRects();for(var o=0;o<i.length;o++){var a=i[o];if(a.left<=t.clientX&&a.right>=t.clientX&&a.top<=t.clientY&&a.bottom>=t.clientY)return true}return false}function eventBelongsToEditor(e,t){if(!t.bubbles)return true;if(t.defaultPrevented)return false;for(var r=t.target,n=void 0;r!=e.contentDOM;r=r.parentNode)if(!r||r.nodeType==11||(n=ContentView.get(r))&&n.ignoreEvent(t))return false;return true}var handlers=Object.create(null);var brokenClipboardAPI=browser.ie&&browser.ie_version<15||browser.ios&&browser.webkit_version<604;function capturePaste(e){var t=e.dom.parentNode;if(!t)return;var r=t.appendChild(document.createElement("textarea"));r.style.cssText="position: fixed; left: -10000px; top: 10px";r.focus();setTimeout((function(){e.focus();r.remove();doPaste(e,r.value)}),50)}function doPaste(e,t){var r=e.state,n,i=1,o=r.toText(t);var a=o.lines==r.selection.ranges.length;var s=lastLinewiseCopy&&r.selection.ranges.every((function(e){return e.empty}))&&lastLinewiseCopy==o.toString();if(s){n={changes:r.selection.ranges.map((function(e){return r.doc.lineAt(e.from)})).filter((function(e,t,r){return t==0||r[t-1]!=e})).map((function(e){return{from:e.from,insert:(a?o.line(i++).slice():t)+r.lineBreak}}))}}else if(a){n=r.changeByRange((function(e){var t=o.line(i++);return{changes:{from:e.from,to:e.to,insert:t.slice()},range:EditorSelection.cursor(e.from+t.length)}}))}else{n=r.replaceSelection(o)}e.dispatch(n,{annotations:Transaction.userEvent.of("paste"),scrollIntoView:true})}function mustCapture(e){var t=(e.ctrlKey?1:0)|(e.metaKey?8:0)|(e.altKey?2:0)|(e.shiftKey?4:0);var r=e.keyCode,n=browser.mac&&t==1;return r==8||n&&r==72||r==46||n&&r==68||r==27||t==(browser.mac?8:1)&&(r==66||r==73||r==89||r==90)}handlers.keydown=function(e,t){if(mustCapture(t))t.preventDefault();e.inputState.setSelectionOrigin("keyboardselection")};handlers.touchdown=handlers.touchmove=function(e){e.inputState.setSelectionOrigin("pointerselection")};handlers.mousedown=function(e,t){var r=null;for(var n=0,i=e.state.facet(mouseSelectionStyle);n<i.length;n++){var o=i[n];r=o(e,t);if(r)break}if(!r&&t.button==0)r=basicMouseSelection(e,t);if(r){if(e.root.activeElement!=e.contentDOM)e.observer.ignore((function(){return focusPreventScroll(e.contentDOM)}));e.inputState.startMouseSelection(e,t,r)}};function rangeForClick(e,t,r,n){if(n==1){return EditorSelection.cursor(t,r)}else if(n==2){return groupAt(e.state,t,r)}else{var i=LineView.find(e.docView,t);if(i)return EditorSelection.range(i.posAtStart,i.posAtEnd);var o=e.state.doc.lineAt(t),a=o.from,s=o.to;return EditorSelection.range(a,s)}}var insideY=function(e,t){return e>=t.top&&e<=t.bottom};var inside=function(e,t,r){return insideY(t,r)&&e>=r.left&&e<=r.right};function findPositionSide(e,t,r,n){var i=LineView.find(e.docView,t);if(!i)return 1;var o=t-i.posAtStart;if(o==0)return 1;if(o==i.length)return-1;var a=i.coordsAt(o,-1);if(a&&inside(r,n,a))return-1;var s=i.coordsAt(o,1);if(s&&inside(r,n,s))return 1;return a&&insideY(n,a)?-1:1}function queryPos(e,t){var r=e.posAtCoords({x:t.clientX,y:t.clientY});if(r==null)return null;return{pos:r,bias:findPositionSide(e,r,t.clientX,t.clientY)}}var BadMouseDetail=browser.ie&&browser.ie_version<=11;var lastMouseDown=null,lastMouseDownCount=0;function getClickType(e){if(!BadMouseDetail)return e.detail;var t=lastMouseDown;lastMouseDown=e;return lastMouseDownCount=!t||t.timeStamp>Date.now()-400&&Math.abs(t.clientX-e.clientX)<2&&Math.abs(t.clientY-e.clientY)<2?(lastMouseDownCount+1)%3:1}function basicMouseSelection(e,t){var r=queryPos(e,t),n=getClickType(t);var i=e.state.selection;var o=r,a=t;return{update:function(e){if(e.changes){if(r)r.pos=e.changes.mapPos(r.pos);i=i.map(e.changes)}},get:function(t,s,l){var c;if(t.clientX==a.clientX&&t.clientY==a.clientY)c=o;else{c=o=queryPos(e,t);a=t}if(!c||!r)return i;var u=rangeForClick(e,c.pos,c.bias,n);if(r.pos!=c.pos&&!s){var f=rangeForClick(e,r.pos,r.bias,n);var h=Math.min(f.from,u.from),d=Math.max(f.to,u.to);u=h<u.from?EditorSelection.range(h,d):EditorSelection.range(d,h)}if(s)return i.replaceRange(i.primary.extend(u.from,u.to));else if(l)return i.addRange(u);else return EditorSelection.create([u])}}}handlers.dragstart=function(e,t){var r=e.state.selection.primary;var n=e.inputState.mouseSelection;if(n)n.dragging=r;if(t.dataTransfer){t.dataTransfer.setData("Text",e.state.sliceDoc(r.from,r.to));t.dataTransfer.effectAllowed="copyMove"}};handlers.drop=function(e,t){if(!t.dataTransfer)return;var r=e.posAtCoords({x:t.clientX,y:t.clientY});var n=t.dataTransfer.getData("Text");if(r==null||!n)return;t.preventDefault();var i=e.inputState.mouseSelection;var o=i&&i.dragging&&i.dragMove?{from:i.dragging.from,to:i.dragging.to}:null;var a={from:r,insert:n};var s=e.state.changes(o?[o,a]:a);e.focus();e.dispatch({changes:s,selection:{anchor:s.mapPos(r,-1),head:s.mapPos(r,1)},annotations:Transaction.userEvent.of("drop")})};handlers.paste=function(e,t){e.observer.flush();var r=brokenClipboardAPI?null:t.clipboardData;var n=r&&r.getData("text/plain");if(n){doPaste(e,n);t.preventDefault()}else{capturePaste(e)}};function captureCopy(e,t){var r=e.dom.parentNode;if(!r)return;var n=r.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px";n.value=t;n.focus();n.selectionEnd=t.length;n.selectionStart=0;setTimeout((function(){n.remove();e.focus()}),50)}function copiedRange(e){var t=[],r=[],n=false;for(var i=0,o=e.selection.ranges;i<o.length;i++){var a=o[i];if(!a.empty){t.push(e.sliceDoc(a.from,a.to));r.push(a)}}if(!t.length){var s=-1;for(var l=0,c=e.selection.ranges;l<c.length;l++){var u=c[l].from;var f=e.doc.lineAt(u);if(f.number>s){t.push(f.slice());r.push({from:f.from,to:Math.min(e.doc.length,f.to+1)})}s=f.number}n=true}return{text:t.join(e.lineBreak),ranges:r,linewise:n}}var lastLinewiseCopy=null;handlers.copy=handlers.cut=function(e,t){var r=copiedRange(e.state),n=r.text,i=r.ranges,o=r.linewise;if(!n)return;lastLinewiseCopy=o?n:null;var a=brokenClipboardAPI?null:t.clipboardData;if(a){t.preventDefault();a.clearData();a.setData("text/plain",n)}else{captureCopy(e,n)}if(t.type=="cut")e.dispatch({changes:i,scrollIntoView:true,annotations:Transaction.userEvent.of("cut")})};handlers.focus=handlers.blur=function(e){setTimeout((function(){if(e.hasFocus!=e.inputState.notifiedFocused)e.update([])}),10)};handlers.beforeprint=function(e){e.viewState.printing=true;e.requestMeasure();setTimeout((function(){e.viewState.printing=false;e.requestMeasure()}),2e3)};function forceClearComposition(e){if(e.docView.compositionDeco.size)e.update([])}handlers.compositionstart=handlers.compositionupdate=function(e){if(!e.inputState.composing){if(e.docView.compositionDeco.size){e.observer.flush();forceClearComposition(e)}e.inputState.composing=true}};handlers.compositionend=function(e){e.inputState.composing=false;e.inputState.compositionEndedAt=Date.now();setTimeout((function(){if(!e.inputState.composing)forceClearComposition(e)}),50)};var observeOptions={childList:true,characterData:true,subtree:true,characterDataOldValue:true};var useCharData=browser.ie&&browser.ie_version<=11;var DOMObserver=function(){function e(e,t,r){var n=this;this.view=e;this.onChange=t;this.onScrollChanged=r;this.active=false;this.ignoreSelection=new DOMSelection;this.delayedFlush=-1;this.queue=[];this.scrollTargets=[];this.intersection=null;this.intersecting=false;this.parentCheck=-1;this.dom=e.contentDOM;this.observer=new MutationObserver((function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];n.queue.push(i)}if(browser.ie&&browser.ie_version<=11&&e.some((function(e){return e.type=="childList"&&e.removedNodes.length||e.type=="characterData"&&e.oldValue.length>e.target.nodeValue.length})))n.flushSoon();else n.flush()}));if(useCharData)this.onCharData=function(e){n.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue});n.flushSoon()};this.onSelectionChange=function(){if(n.view.root.activeElement!=n.dom)return;if(browser.ie&&browser.ie_version<=11&&!n.view.state.selection.primary.empty){var e=getSelection(n.view.root);if(e.focusNode&&isEquivalentPosition(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return n.flushSoon()}n.flush()};this.start();this.onScroll=this.onScroll.bind(this);window.addEventListener("scroll",this.onScroll);if(typeof IntersectionObserver=="function"){this.intersection=new IntersectionObserver((function(e){if(n.parentCheck<0)n.parentCheck=setTimeout(n.listenForScroll.bind(n),1e3);if(e[e.length-1].intersectionRatio>0!=n.intersecting){n.intersecting=!n.intersecting;n.onScrollChanged(document.createEvent("Event"))}}),{});this.intersection.observe(this.dom)}this.listenForScroll()}e.prototype.onScroll=function(e){if(this.intersecting){this.flush();this.onScrollChanged(e)}};e.prototype.listenForScroll=function(){this.parentCheck=-1;var e=0,t=null;for(var r=this.dom;r;){if(r.nodeType==1){if(!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==r)e++;else if(!t)t=this.scrollTargets.slice(0,e);if(t)t.push(r);r=r.parentNode}else if(r.nodeType==11){r=r.host}else{break}}if(e<this.scrollTargets.length&&!t)t=this.scrollTargets.slice(0,e);if(t){for(var n=0,i=this.scrollTargets;n<i.length;n++){var r=i[n];r.removeEventListener("scroll",this.onScroll)}for(var o=0,a=this.scrollTargets=t;o<a.length;o++){var r=a[o];r.addEventListener("scroll",this.onScroll)}}};e.prototype.ignore=function(e){if(!this.active)return e();try{this.stop();return e()}finally{this.start();this.clear()}};e.prototype.start=function(){if(this.active)return;this.observer.observe(this.dom,observeOptions);this.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange);if(useCharData)this.dom.addEventListener("DOMCharacterDataModified",this.onCharData);this.active=true};e.prototype.stop=function(){if(!this.active)return;this.active=false;this.observer.disconnect();this.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange);if(useCharData)this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData)};e.prototype.clearSelection=function(){this.ignoreSelection.set(getSelection(this.view.root))};e.prototype.clear=function(){this.observer.takeRecords();this.queue.length=0;this.clearSelection()};e.prototype.flushSoon=function(){var e=this;if(this.delayedFlush<0)this.delayedFlush=window.setTimeout((function(){e.delayedFlush=-1;e.flush()}),20)};e.prototype.forceFlush=function(){if(this.delayedFlush>=0){window.clearTimeout(this.delayedFlush);this.delayedFlush=-1;this.flush()}};e.prototype.flush=function(){var e=this;if(this.delayedFlush>=0)return;var t=this.queue;for(var r=0,n=this.observer.takeRecords();r<n.length;r++){var i=n[r];t.push(i)}if(t.length)this.queue=[];var o=getSelection(this.view.root);var a=!this.ignoreSelection.eq(o)&&hasSelection(this.dom,o);if(t.length==0&&!a)return;var s=-1,l=-1,c=false;for(var u=0,f=t;u<f.length;u++){var h=f[u];var d=this.readMutation(h);if(!d)continue;if(d.typeOver)c=true;if(s==-1){s=d.from,l=d.to}else{s=Math.min(d.from,s);l=Math.max(d.to,l)}}var p=this.view.state;if(s>-1||a)this.onChange(s,l,c);if(this.view.state==p){if(this.view.docView.dirty){this.ignore((function(){return e.view.docView.sync()}));this.view.docView.dirty=0}this.view.docView.updateSelection()}this.clearSelection()};e.prototype.readMutation=function(e){var t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;t.markDirty();if(e.type=="childList"){var r=findChild(t,e.previousSibling||e.target.previousSibling,-1);var n=findChild(t,e.nextSibling||e.target.nextSibling,1);return{from:r?t.posAfter(r):t.posAtStart,to:n?t.posBefore(n):t.posAtEnd,typeOver:false}}else{return{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}}};e.prototype.destroy=function(){this.stop();if(this.intersection)this.intersection.disconnect();for(var e=0,t=this.scrollTargets;e<t.length;e++){var r=t[e];r.removeEventListener("scroll",this.onScroll)}window.removeEventListener("scroll",this.onScroll);clearTimeout(this.parentCheck)};return e}();function findChild(e,t,r){while(t){var n=ContentView.get(t);if(n&&n.parent==e)return n;var i=t.parentNode;t=i!=e.dom?i:r>0?t.nextSibling:t.previousSibling}return null}function applyDOMChange(e,t,r,n){var i,o;var a=e.state.selection.primary,s;if(t>-1&&(s=e.docView.domBoundsAround(t,r,0))){var l=s.from,c=s.to;var u=e.docView.impreciseHead||e.docView.impreciseAnchor?[]:selectionPoints(e.contentDOM,e.root);var f=new DOMReader(u,e.state.lineBreak);f.readRange(s.startDOM,s.endDOM);o=selectionFromPoints(u,l);var h=a.from,d=null;if(e.inputState.lastKeyCode===8&&e.inputState.lastKeyTime>Date.now()-100){h=a.to;d="end"}var p=findDiff(e.state.sliceDoc(l,c),f.text,h-l,d);if(p)i={from:l+p.from,to:l+p.toA,insert:e.state.toText(f.text.slice(p.from,p.toB))}}else if(e.hasFocus){var g=getSelection(e.root);var m=e.docView,v=m.impreciseHead,O=m.impreciseAnchor;var y=v&&v.node==g.focusNode&&v.offset==g.focusOffset?e.state.selection.primary.head:e.docView.posFromDOM(g.focusNode,g.focusOffset);var b=O&&O.node==g.anchorNode&&O.offset==g.anchorOffset?e.state.selection.primary.anchor:selectionCollapsed(g)?y:e.docView.posFromDOM(g.anchorNode,g.anchorOffset);if(y!=a.head||b!=a.anchor)o=EditorSelection.single(b,y)}if(!i&&!o)return;if(!i&&n&&!a.empty&&o&&o.primary.empty)i={from:a.from,to:a.to,insert:e.state.doc.slice(a.from,a.to)};if(i){var S=e.state;if(browser.android&&(i.from==a.from&&i.to==a.to&&i.insert.length==1&&i.insert.lines==2&&dispatchKey(e,"Enter",10)||i.from==a.from-1&&i.to==a.to&&i.insert.length==0&&dispatchKey(e,"Backspace",8)||i.from==a.from&&i.to==a.to+1&&i.insert.length==0&&dispatchKey(e,"Delete",46)))return;var w=i.insert.toString();if(e.state.facet(inputHandler).some((function(t){return t(e,i.from,i.to,w)})))return;var x=void 0;if(i.from>=a.from&&i.to<=a.to&&i.to-i.from>=(a.to-a.from)/3){var k=a.from<i.from?S.sliceDoc(a.from,i.from):"";var P=a.to>i.to?S.sliceDoc(i.to,a.to):"";x=S.replaceSelection(e.state.toText(k+i.insert.sliceString(0,undefined,e.state.lineBreak)+P))}else{var C=S.changes(i);x={changes:C,selection:o&&!S.selection.primary.eq(o.primary)&&o.primary.to<=C.newLength?S.selection.replaceRange(o.primary):undefined}}e.dispatch(x,{scrollIntoView:true,annotations:Transaction.userEvent.of("input")})}else if(o&&!o.primary.eq(a)){var Q=false,L=void 0;if(e.inputState.lastSelectionTime>Date.now()-50){if(e.inputState.lastSelectionOrigin=="keyboardselection")Q=true;else L=Transaction.userEvent.of(e.inputState.lastSelectionOrigin)}e.dispatch({selection:o,scrollIntoView:Q,annotations:L})}}function findDiff(e,t,r,n){var i=Math.min(e.length,t.length);var o=0;while(o<i&&e.charCodeAt(o)==t.charCodeAt(o))o++;if(o==i&&e.length==t.length)return null;var a=e.length,s=t.length;while(a>0&&s>0&&e.charCodeAt(a-1)==t.charCodeAt(s-1)){a--;s--}if(n=="end"){var l=Math.max(0,o-Math.min(a,s));r-=a+l-o}if(a<o&&e.length<t.length){var c=r<=o&&r>=a?o-r:0;o-=c;s=o+(s-a);a=o}else if(s<o){var c=r<=o&&r>=s?o-r:0;o-=c;a=o+(a-s);s=o}return{from:o,toA:a,toB:s}}var DOMReader=function(){function e(e,t){this.points=e;this.lineSep=t;this.text=""}e.prototype.readRange=function(e,t){if(!e)return;var r=e.parentNode;for(var n=e;;){this.findPointBefore(r,n);this.readNode(n);var i=n.nextSibling;if(i==t)break;var o=ContentView.get(n),a=ContentView.get(i);if((o?o.breakAfter:isBlockElement(n))||(a?a.breakAfter:isBlockElement(i))&&!(n.nodeName=="BR"&&!n.cmIgnore))this.text+=this.lineSep;n=i}this.findPointBefore(r,t)};e.prototype.readNode=function(e){if(e.cmIgnore)return;var t=ContentView.get(e);var r=t&&t.overrideDOMText;var n;if(r!=null)n=r.sliceString(0,undefined,this.lineSep);else if(e.nodeType==3)n=e.nodeValue;else if(e.nodeName=="BR")n=e.nextSibling?this.lineSep:"";else if(e.nodeType==1)this.readRange(e.firstChild,null);if(n!=null){this.findPointIn(e,n.length);this.text+=n}};e.prototype.findPointBefore=function(e,t){for(var r=0,n=this.points;r<n.length;r++){var i=n[r];if(i.node==e&&e.childNodes[i.offset]==t)i.pos=this.text.length}};e.prototype.findPointIn=function(e,t){for(var r=0,n=this.points;r<n.length;r++){var i=n[r];if(i.node==e)i.pos=this.text.length+Math.min(i.offset,t)}};return e}();function isBlockElement(e){return e.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(e.nodeName)}var DOMPoint=function(){function e(e,t){this.node=e;this.offset=t;this.pos=-1}return e}();function selectionPoints(e,t){var r=[];if(t.activeElement!=e)return r;var n=getSelection(t),i=n.anchorNode,o=n.anchorOffset,a=n.focusNode,s=n.focusOffset;if(i){r.push(new DOMPoint(i,o));if(a!=i||s!=o)r.push(new DOMPoint(a,s))}return r}function selectionFromPoints(e,t){if(e.length==0)return null;var r=e[0].pos,n=e.length==2?e[1].pos:r;return r>-1&&n>-1?EditorSelection.single(r+t,n+t):null}function dispatchKey(e,t,r){var n={key:t,code:t,keyCode:r,which:r,cancelable:true};var i=new KeyboardEvent("keydown",n);e.contentDOM.dispatchEvent(i);var o=new KeyboardEvent("keyup",n);e.contentDOM.dispatchEvent(o);return i.defaultPrevented||o.defaultPrevented}var EditorView=function(){function e(e){var t=this;if(e===void 0){e={}}this.plugins=[];this.editorAttrs={};this.contentAttrs={};this.bidiCache=[];this.updateState=2;this.measureScheduled=-1;this.measureRequests=[];this.contentDOM=document.createElement("div");this.scrollDOM=document.createElement("div");this.scrollDOM.className=themeClass("scroller");this.scrollDOM.appendChild(this.contentDOM);this.dom=document.createElement("div");this.dom.appendChild(this.scrollDOM);this._dispatch=e.dispatch||function(e){return t.update([e])};this.dispatch=this.dispatch.bind(this);this.root=e.root||document;this.viewState=new ViewState(e.state||EditorState.create());this.plugins=this.state.facet(viewPlugin).map((function(e){return PluginInstance.create(e,t)}));this.observer=new DOMObserver(this,(function(e,r,n){return applyDOMChange(t,e,r,n)}),(function(e){t.inputState.runScrollHandlers(t,e);t.measure()}));this.docView=new DocView(this);this.inputState=new InputState(this);this.mountStyles();this.updateAttrs();this.updateState=0;ensureGlobalHandler();this.requestMeasure();if(e.parent)e.parent.appendChild(this.dom)}Object.defineProperty(e.prototype,"state",{get:function(){return this.viewState.state},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"viewport",{get:function(){return this.viewState.viewport},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"visibleRanges",{get:function(){return this.viewState.visibleRanges},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"inView",{get:function(){return this.viewState.inView},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"composing",{get:function(){return this.inputState.composing},enumerable:false,configurable:true});e.prototype.dispatch=function(){var e;var t=[];for(var r=0;r<arguments.length;r++){t[r]=arguments[r]}this._dispatch(t.length==1&&t[0]instanceof Transaction?t[0]:(e=this.state).update.apply(e,t))};e.prototype.update=function(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");this.updateState=2;var t=this.state;for(var r=0,n=e;r<n.length;r++){var i=n[r];if(i.startState!=t)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");t=i.state}var o=new ViewUpdate(this,t,e);var a=e.some((function(e){return e.scrollIntoView}))?t.selection.primary:null;this.viewState.update(o,a);this.bidiCache=CachedOrder.update(this.bidiCache,o.changes);if(!o.empty)this.updatePlugins(o);var s=this.docView.update(o);if(this.state.facet(styleModule)!=this.styleModules)this.mountStyles();this.updateAttrs();this.updateState=0;if(s||a||this.viewState.mustEnforceCursorAssoc)this.requestMeasure();for(var l=0,c=this.state.facet(updateListener);l<c.length;l++){var u=c[l];u(o)}};e.prototype.setState=function(e){var t=this;if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");this.updateState=2;for(var r=0,n=this.plugins;r<n.length;r++){var i=n[r];i.destroy(this)}this.viewState=new ViewState(e);this.plugins=e.facet(viewPlugin).map((function(e){return PluginInstance.create(e,t)}));this.docView=new DocView(this);this.inputState.ensureHandlers(this);this.mountStyles();this.updateAttrs();this.bidiCache=[];this.updateState=0;this.requestMeasure()};e.prototype.updatePlugins=function(e){var t=e.prevState.facet(viewPlugin),r=e.state.facet(viewPlugin);if(t!=r){var n=[],i=[];for(var o=0,a=r;o<a.length;o++){var s=a[o];var l=t.indexOf(s);if(l<0){n.push(PluginInstance.create(s,this))}else{var c=this.plugins[l].update(e);i.push(c);n.push(c)}}for(var u=0,f=this.plugins;u<f.length;u++){var c=f[u];if(i.indexOf(c)<0)c.destroy(this)}this.plugins=n;this.inputState.ensureHandlers(this)}else{for(var h=0;h<this.plugins.length;h++)this.plugins[h]=this.plugins[h].update(e)}};e.prototype.measure=function(){var e=this;if(this.measureScheduled>-1)cancelAnimationFrame(this.measureScheduled);this.measureScheduled=-1;var t=null;for(var r=0;;r++){this.updateState=1;var n=this.viewState.measure(this.docView,r>0);var i=this.measureRequests;if(!n&&!i.length&&this.viewState.scrollTo==null)break;this.measureRequests=[];if(r>5){console.warn("Viewport failed to stabilize");break}var o=i.map((function(t){try{return t.read(e)}catch(r){logException(e.state,r);return BadMeasure}}));var a=new ViewUpdate(this,this.state);a.flags|=n;if(!t)t=a;else t.flags|=n;this.updateState=2;this.updatePlugins(a);this.updateAttrs();if(n)this.docView.update(a);for(var s=0;s<i.length;s++)if(o[s]!=BadMeasure){try{i[s].write(o[s],this)}catch(f){logException(this.state,f)}}if(this.viewState.scrollTo){this.docView.scrollPosIntoView(this.viewState.scrollTo.head,this.viewState.scrollTo.assoc);this.viewState.scrollTo=null}if(!(n&4)&&this.measureRequests.length==0)break}this.updateState=0;this.measureScheduled=-1;if(t)for(var l=0,c=this.state.facet(updateListener);l<c.length;l++){var u=c[l];u(t)}};Object.defineProperty(e.prototype,"themeClasses",{get:function(){return baseThemeID+" "+(this.state.facet(darkTheme)?"cm-dark":"cm-light")+" "+this.state.facet(theme)},enumerable:false,configurable:true});e.prototype.updateAttrs=function(){var e=combineAttrs(this.state.facet(editorAttributes),{class:themeClass("wrap")+(this.hasFocus?" cm-focused ":" ")+this.themeClasses});updateAttrs(this.dom,this.editorAttrs,e);this.editorAttrs=e;var t=combineAttrs(this.state.facet(contentAttributes),{spellcheck:"false",contenteditable:String(this.state.facet(editable)),class:themeClass("content"),style:browser.tabSize+": "+this.state.tabSize,role:"textbox","aria-multiline":"true"});updateAttrs(this.contentDOM,this.contentAttrs,t);this.contentAttrs=t};e.prototype.mountStyles=function(){this.styleModules=this.state.facet(styleModule);StyleModule.mount(this.root,this.styleModules.concat(baseTheme).reverse())};e.prototype.domAtPos=function(e){return this.docView.domAtPos(e)};e.prototype.posAtDOM=function(e,t){if(t===void 0){t=0}return this.docView.posFromDOM(e,t)};e.prototype.readMeasured=function(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");if(this.updateState==0&&this.measureScheduled>-1)this.measure()};e.prototype.requestMeasure=function(e){var t=this;if(this.measureScheduled<0)this.measureScheduled=requestAnimationFrame((function(){return t.measure()}));if(e){if(e.key!=null)for(var r=0;r<this.measureRequests.length;r++){if(this.measureRequests[r].key===e.key){this.measureRequests[r]=e;return}}this.measureRequests.push(e)}};e.prototype.pluginField=function(e){var t=[];for(var r=0,n=this.plugins;r<n.length;r++){var i=n[r];i.takeField(e,t)}return t};e.prototype.plugin=function(e){for(var t=0,r=this.plugins;t<r.length;t++){var n=r[t];if(n.spec==e)return n.value}return null};e.prototype.blockAtHeight=function(e,t){this.readMeasured();return this.viewState.blockAtHeight(e,ensureTop(t,this.contentDOM))};e.prototype.visualLineAtHeight=function(e,t){this.readMeasured();return this.viewState.lineAtHeight(e,ensureTop(t,this.contentDOM))};e.prototype.visualLineAt=function(e,t){if(t===void 0){t=0}return this.viewState.lineAt(e,t)};e.prototype.viewportLines=function(e,t){var r=this.viewport,n=r.from,i=r.to;this.viewState.forEachLine(n,i,e,ensureTop(t,this.contentDOM))};Object.defineProperty(e.prototype,"contentHeight",{get:function(){return this.viewState.heightMap.height+this.viewState.paddingTop+this.viewState.paddingBottom},enumerable:false,configurable:true});e.prototype.moveByChar=function(e,t,r){return moveByChar(this,e,t,r)};e.prototype.moveByGroup=function(e,t){var r=this;return moveByChar(this,e,t,(function(t){return byGroup(r,e.head,t)}))};e.prototype.moveToLineBoundary=function(e,t,r){if(r===void 0){r=true}return moveToLineBoundary(this,e,t,r)};e.prototype.moveVertically=function(e,t,r){return moveVertically(this,e,t,r)};e.prototype.scrollPosIntoView=function(e){this.viewState.scrollTo=EditorSelection.cursor(e);this.requestMeasure()};e.prototype.posAtCoords=function(e){this.readMeasured();return posAtCoords(this,e)};e.prototype.coordsAtPos=function(e,t){if(t===void 0){t=1}this.readMeasured();var r=this.docView.coordsAt(e,t);if(!r||r.left==r.right)return r;var n=this.state.doc.lineAt(e),i=this.bidiSpans(n);var o=i[BidiSpan.find(i,e-n.from,-1,t)];return flattenRect(r,o.dir==Direction.LTR==t>0)};Object.defineProperty(e.prototype,"defaultCharacterWidth",{get:function(){return this.viewState.heightOracle.charWidth},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"defaultLineHeight",{get:function(){return this.viewState.heightOracle.lineHeight},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"textDirection",{get:function(){return this.viewState.heightOracle.direction},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"lineWrapping",{get:function(){return this.viewState.heightOracle.lineWrapping},enumerable:false,configurable:true});e.prototype.bidiSpans=function(e){if(e.length>MaxBidiLine)return trivialOrder(e.length);var t=this.textDirection;for(var r=0,n=this.bidiCache;r<n.length;r++){var i=n[r];if(i.from==e.from&&i.dir==t)return i.order}var o=computeOrder(e.slice(),this.textDirection);this.bidiCache.push(new CachedOrder(e.from,e.to,t,o));return o};Object.defineProperty(e.prototype,"hasFocus",{get:function(){return this.root.activeElement==this.contentDOM},enumerable:false,configurable:true});e.prototype.focus=function(){var e=this;this.observer.ignore((function(){focusPreventScroll(e.contentDOM);e.docView.updateSelection()}))};e.prototype.destroy=function(){for(var e=0,t=this.plugins;e<t.length;e++){var r=t[e];r.destroy(this)}this.inputState.destroy();this.dom.remove();this.observer.destroy();if(this.measureScheduled>-1)cancelAnimationFrame(this.measureScheduled)};e.domEventHandlers=function(e){return ViewPlugin.define((function(){return{}}),{eventHandlers:e})};e.theme=function(e,t){var r=StyleModule.newName();var n=[theme.of(r),styleModule.of(buildTheme("."+baseThemeID+"."+r,e))];if(t&&t.dark)n.push(darkTheme.of(true));return n};e.baseTheme=function(e){return precedence(styleModule.of(buildTheme("."+baseThemeID,e)),"fallback")};return e}();EditorView.styleModule=styleModule;EditorView.inputHandler=inputHandler;EditorView.exceptionSink=exceptionSink;EditorView.updateListener=updateListener;EditorView.editable=editable;EditorView.dragMovesSelection=dragMovesSelection;EditorView.clickAddsSelectionRange=clickAddsSelectionRange;EditorView.mouseSelectionStyle=mouseSelectionStyle;EditorView.decorations=decorations;EditorView.lineWrapping=EditorView.theme({$content:{whiteSpace:"pre-wrap"}});EditorView.contentAttributes=contentAttributes;EditorView.editorAttributes=editorAttributes;var MaxBidiLine=4096;function ensureTop(e,t){return e==null?t.getBoundingClientRect().top:e}var resizeDebounce=-1;function ensureGlobalHandler(){window.addEventListener("resize",(function(){if(resizeDebounce==-1)resizeDebounce=setTimeout(handleResize,50)}))}function handleResize(){resizeDebounce=-1;var e=document.querySelectorAll(".cm-content");for(var t=0;t<e.length;t++){var r=ContentView.get(e[t]);if(r)r.editorView.requestMeasure()}}var BadMeasure={};var CachedOrder=function(){function e(e,t,r,n){this.from=e;this.to=t;this.dir=r;this.order=n}e.update=function(t,r){if(r.empty)return t;var n=[],i=t.length?t[t.length-1].dir:Direction.LTR;for(var o=Math.max(0,t.length-10);o<t.length;o++){var a=t[o];if(a.dir==i&&!r.touchesRange(a.from,a.to))n.push(new e(r.mapPos(a.from,1),r.mapPos(a.to,-1),a.dir,a.order))}return n};return e}();var currentPlatform=typeof navigator=="undefined"?"key":/Mac/.test(navigator.platform)?"mac":/Win/.test(navigator.platform)?"win":/Linux|X11/.test(navigator.platform)?"linux":"key";function normalizeKeyName(e,t){var r=e.split(/-(?!$)/);var n=r[r.length-1];if(n=="Space")n=" ";var i,o,a,s;for(var l=0;l<r.length-1;++l){var c=r[l];if(/^(cmd|meta|m)$/i.test(c))s=true;else if(/^a(lt)?$/i.test(c))i=true;else if(/^(c|ctrl|control)$/i.test(c))o=true;else if(/^s(hift)?$/i.test(c))a=true;else if(/^mod$/i.test(c)){if(t=="mac")s=true;else o=true}else throw new Error("Unrecognized modifier name: "+c)}if(i)n="Alt-"+n;if(o)n="Ctrl-"+n;if(s)n="Meta-"+n;if(a)n="Shift-"+n;return n}function modifiers(e,t,r){if(t.altKey)e="Alt-"+e;if(t.ctrlKey)e="Ctrl-"+e;if(t.metaKey)e="Meta-"+e;if(r!==false&&t.shiftKey)e="Shift-"+e;return e}var keymaps=Facet.define();var handleKeyEvents=EditorView.domEventHandlers({keydown:function(e,t){return runHandlers(t.state.facet(keymaps),e,t,"editor")}});function keymap(e,t){return[handleKeyEvents,keymaps.of(buildKeymap(e,t))]}var storedPrefix=null;var PrefixTimeout=4e3;function buildKeymap(e,t){if(t===void 0){t=currentPlatform}var r=Object.create(null);var n=Object.create(null);var i=function(e,t){var r=n[e];if(r==null)n[e]=t;else if(r!=t)throw new Error("Key binding "+e+" is used both as a regular binding and as a multi-stroke prefix")};var o=function(e,n,o,a){var s=r[e]||(r[e]=Object.create(null));var l=n.split(/ (?!$)/).map((function(e){return normalizeKeyName(e,t)}));var c=function(t){var r=l.slice(0,t).join(" ");i(r,true);if(!s[r])s[r]={preventDefault:true,commands:[function(t){var n=storedPrefix={view:t,prefix:r,scope:e};setTimeout((function(){if(storedPrefix==n)storedPrefix=null}),PrefixTimeout);return true}]}};for(var u=1;u<l.length;u++){c(u)}var f=l.join(" ");i(f,false);var h=s[f]||(s[f]={preventDefault:false,commands:[]});h.commands.push(o);if(a)h.preventDefault=true};for(var a=0,s=e;a<s.length;a++){var l=s[a];var c=l[t]||l.key;if(!c)continue;for(var u=0,f=l.scope?l.scope.split(" "):["editor"];u<f.length;u++){var h=f[u];o(h,c,l.run,l.preventDefault);if(l.shift)o(h,"Shift-"+c,l.shift,l.preventDefault)}}return r}function runHandlers(e,t,r,n){var i=keyName(t),o=i.length==1&&i!=" ";var a="";if(storedPrefix&&storedPrefix.view==r&&storedPrefix.scope==n){a=storedPrefix.prefix+" ";storedPrefix=null}var s=!!a;var l=function(e){if(e){for(var t=0,n=e.commands;t<n.length;t++){var i=n[t];if(i(r))return true}if(e.preventDefault)s=true}return false};for(var c=0,u=e;c<u.length;c++){var f=u[c];var h=f[n],d=void 0;if(!h)continue;if(l(h[a+modifiers(i,t,!o)]))return true;if(o&&(t.shiftKey||t.altKey||t.metaKey)&&(d=base[t.keyCode])&&d!=i){if(l(h[a+modifiers(d,t,true)]))return true}else if(o&&t.shiftKey){if(l(h[a+modifiers(i,t,true)]))return true}}return s}var CanHidePrimary=!browser.ios;var selectionConfig=Facet.define({combine:function(e){return combineConfig(e,{cursorBlinkRate:1200,drawRangeCursor:true},{cursorBlinkRate:function(e,t){return Math.min(e,t)},drawRangeCursor:function(e,t){return e||t}})}});function drawSelection(e){if(e===void 0){e={}}return[selectionConfig.of(e),drawSelectionPlugin,hideNativeSelection]}var Piece=function(){function e(e,t,r,n,i){this.left=e;this.top=t;this.width=r;this.height=n;this.className=i}e.prototype.draw=function(){var e=document.createElement("div");e.className=this.className;e.style.left=this.left+"px";e.style.top=this.top+"px";if(this.width>=0)e.style.width=this.width+"px";e.style.height=this.height+"px";return e};e.prototype.eq=function(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className};return e}();var drawSelectionPlugin=ViewPlugin.fromClass(function(){function e(e){this.view=e;this.rangePieces=[];this.cursors=[];this.measureReq={read:this.readPos.bind(this),write:this.drawSel.bind(this)};this.selectionLayer=e.scrollDOM.appendChild(document.createElement("div"));this.selectionLayer.className=themeClass("selectionLayer");this.selectionLayer.setAttribute("aria-hidden","true");this.cursorLayer=e.scrollDOM.appendChild(document.createElement("div"));this.cursorLayer.className=themeClass("cursorLayer");this.cursorLayer.setAttribute("aria-hidden","true");e.requestMeasure(this.measureReq);this.setBlinkRate()}e.prototype.setBlinkRate=function(){this.cursorLayer.style.animationDuration=this.view.state.facet(selectionConfig).cursorBlinkRate+"ms"};e.prototype.update=function(e){var t=e.prevState.facet(selectionConfig)!=e.state.facet(selectionConfig);if(t||e.selectionSet||e.geometryChanged||e.viewportChanged)this.view.requestMeasure(this.measureReq);if(e.transactions.some((function(e){return e.scrollIntoView})))this.cursorLayer.style.animationName=this.cursorLayer.style.animationName=="cm-blink"?"cm-blink2":"cm-blink";if(t)this.setBlinkRate()};e.prototype.readPos=function(){var e=this;var t=this.view.state,r=t.facet(selectionConfig);var n=t.selection.ranges.map((function(t){return t.empty?[]:measureRange(e.view,t)})).reduce((function(e,t){return e.concat(t)}));var i=[];for(var o=0,a=t.selection.ranges;o<a.length;o++){var s=a[o];var l=s==t.selection.primary;if(s.empty?!l||CanHidePrimary:r.drawRangeCursor){var c=measureCursor(this.view,s,l);if(c)i.push(c)}}return{rangePieces:n,cursors:i}};e.prototype.drawSel=function(e){var t=this;var r=e.rangePieces,n=e.cursors;if(r.length!=this.rangePieces.length||r.some((function(e,r){return!e.eq(t.rangePieces[r])}))){this.selectionLayer.textContent="";for(var i=0,o=r;i<o.length;i++){var a=o[i];this.selectionLayer.appendChild(a.draw())}this.rangePieces=r}if(n.length!=this.cursors.length||n.some((function(e,r){return!e.eq(t.cursors[r])}))){this.cursorLayer.textContent="";for(var s=0,l=n;s<l.length;s++){var c=l[s];this.cursorLayer.appendChild(c.draw())}this.cursors=n}};e.prototype.destroy=function(){this.selectionLayer.remove();this.cursorLayer.remove()};return e}());var themeSpec={$content:{"& ::selection":{backgroundColor:"transparent !important"}}};if(CanHidePrimary)themeSpec.$content.caretColor="transparent !important";var hideNativeSelection=precedence(EditorView.theme(themeSpec),"override");var selectionClass=themeClass("selectionBackground");function getBase(e){var t=e.scrollDOM.getBoundingClientRect();return{left:t.left-e.scrollDOM.scrollLeft,top:t.top-e.scrollDOM.scrollTop}}function measureRange(e,t){if(t.to<=e.viewport.from||t.from>=e.viewport.to)return[];var r=Math.max(t.from,e.viewport.from),n=Math.min(t.to,e.viewport.to);var i=e.textDirection==Direction.LTR;var o=e.contentDOM,a=o.getBoundingClientRect(),s=getBase(e);var l=window.getComputedStyle(o.firstChild);var c=a.left+parseInt(l.paddingLeft);var u=a.right-parseInt(l.paddingRight);var f=e.visualLineAt(r),h=e.visualLineAt(n);if(f.from==h.from){return v(O(t.from,t.to))}else{var d=O(t.from,null);var p=O(null,t.to);var g=[];if(f.to<h.from-1)g.push(m(c,d.bottom,u,p.top));else if(d.bottom<p.top&&p.top-d.bottom<4)d.bottom=p.top=(d.bottom+p.top)/2;return v(d).concat(g).concat(v(p))}function m(e,t,r,n){return new Piece(e-s.left,t-s.top,r-e,n-t,selectionClass)}function v(e){var t=e.top,r=e.bottom,n=e.horizontal;var i=[];for(var o=0;o<n.length;o+=2)i.push(m(n[o],t,n[o+1],r));return i}function O(t,r){var n=1e9,o=-1e9,a=[];function s(t,r,s,l,f){var h=e.coordsAtPos(t,1),d=e.coordsAtPos(s,-1);n=Math.min(h.top,d.top,n);o=Math.max(h.bottom,d.bottom,o);if(f==Direction.LTR)a.push(i&&r?c:h.left,i&&l?u:d.right);else a.push(!i&&l?c:d.left,!i&&r?u:h.right)}var l=t!==null&&t!==void 0?t:e.moveToLineBoundary(EditorSelection.cursor(r,1),false).head;var f=r!==null&&r!==void 0?r:e.moveToLineBoundary(EditorSelection.cursor(t,-1),true).head;for(var h=0,d=e.visibleRanges;h<d.length;h++){var p=d[h];if(p.to>l&&p.from<f){for(var g=Math.max(p.from,l),m=Math.min(p.to,f);;){var v=e.state.doc.lineAt(g);for(var O=0,y=e.bidiSpans(v);O<y.length;O++){var b=y[O];var S=b.from+v.from,w=b.to+v.from;if(S>=m)break;if(w>g)s(Math.max(S,g),t==null&&S<=l,Math.min(w,m),r==null&&w>=f,b.dir)}g=v.to+1;if(g>=m)break}}}if(a.length==0){var x=e.coordsAtPos(l,-1);n=Math.min(x.top,n);o=Math.max(x.bottom,o)}return{top:n,bottom:o,horizontal:a}}}var primaryCursorClass=themeClass("cursor.primary");var cursorClass=themeClass("cursor.secondary");function measureCursor(e,t,r){var n=e.coordsAtPos(t.head,t.assoc||1);if(!n)return null;var i=getBase(e);return new Piece(n.left-i.left,n.top-i.top,-1,n.bottom-n.top,r?primaryCursorClass:cursorClass)}var Specials=/[\u0000-\u0008\u000a-\u001f\u007f-\u009f\u00ad\u061c\u200b-\u200c\u200e\u200f\u2028\u2029\ufeff\ufff9-\ufffc]/gu;var Names={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};var _supportsTabSize=null;function supportsTabSize(){if(_supportsTabSize==null&&typeof document!="undefined"&&document.body){var e=document.body.style;_supportsTabSize=(e.tabSize||e.MozTabSize)!=null}return _supportsTabSize||false}var UnicodeRegexpSupport=/x/.unicode!=null?"gu":"g";var specialCharConfig=Facet.define({combine:function(e){var t=combineConfig(e,{render:null,specialChars:Specials,addSpecialChars:null});if(t.replaceTabs=!supportsTabSize())t.specialChars=new RegExp("\t|"+t.specialChars.source,UnicodeRegexpSupport);if(t.addSpecialChars)t.specialChars=new RegExp(t.specialChars.source+"|"+t.addSpecialChars.source,UnicodeRegexpSupport);return t}});function highlightSpecialChars(e){if(e===void 0){e={}}var t=[specialCharConfig.of(e),specialCharPlugin];if(!supportsTabSize())t.push(tabStyle);return t}var specialCharPlugin=ViewPlugin.fromClass(function(){function e(e){this.view=e;this.decorations=Decoration.none;this.decorationCache=Object.create(null);this.recompute()}e.prototype.update=function(e){var t=e.prevState.facet(specialCharConfig)!=e.state.facet(specialCharConfig);if(t)this.decorationCache=Object.create(null);if(t||e.changes.length||e.viewportChanged)this.recompute()};e.prototype.recompute=function(){var e=[];for(var t=0,r=this.view.visibleRanges;t<r.length;t++){var n=r[t],i=n.from,o=n.to;this.getDecorationsFor(i,o,e)}this.decorations=Decoration.set(e)};e.prototype.getDecorationsFor=function(e,t,r){var n=this.view.state.facet(specialCharConfig);var i=this.view.state.doc;for(var o=e,a=i.iterRange(e,t),s=void 0;!a.next().done;){if(!a.lineBreak){while(s=n.specialChars.exec(a.value)){var l=codePointAt(s[0],0),c=void 0;if(l==null)continue;if(l==9){var u=i.lineAt(o+s.index);var f=this.view.state.tabSize,h=countColumn(i.sliceString(u.from,o+s.index),0,f);c=Decoration.replace({widget:new TabWidget((f-h%f)*this.view.defaultCharacterWidth)})}else{c=this.decorationCache[l]||(this.decorationCache[l]=Decoration.replace({widget:new SpecialCharWidget(n,l)}))}r.push(c.range(o+s.index,o+s.index+s[0].length))}}o+=a.value.length}};return e}(),{decorations:function(e){return e.decorations}});function placeHolder(e){if(e>=32)return null;if(e==10)return"␤";return String.fromCharCode(9216+e)}var DefaultPlaceholder="•";var SpecialCharWidget=function(e){__extends(t,e);function t(t,r){var n=e.call(this)||this;n.options=t;n.code=r;return n}t.prototype.eq=function(e){return e.code==this.code};t.prototype.toDOM=function(){var e=placeHolder(this.code)||DefaultPlaceholder;var t="Control character "+(Names[this.code]||this.code);var r=this.options.render&&this.options.render(this.code,t,e);if(r)return r;var n=document.createElement("span");n.textContent=e;n.title=t;n.setAttribute("aria-label",t);n.style.color="red";return n};t.prototype.ignoreEvent=function(){return false};return t}(WidgetType);var TabWidget=function(e){__extends(t,e);function t(t){var r=e.call(this)||this;r.width=t;return r}t.prototype.eq=function(e){return e.width==this.width};t.prototype.toDOM=function(){var e=document.createElement("span");e.textContent="\t";e.className=tab;e.style.width=this.width+"px";return e};t.prototype.ignoreEvent=function(){return false};return t}(WidgetType);var tab=StyleModule.newName(),tabStyle=EditorView.styleModule.of(new StyleModule((_g={},_g["."+tab]={display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},_g)));var Outside="-10000px";var tooltipPlugin=ViewPlugin.fromClass(function(){function e(e){var t=this;this.view=e;this.inView=true;this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this};this.tooltips=e.state.facet(showTooltip);this.tooltipViews=this.tooltips.map((function(e){return t.createTooltip(e)}))}e.prototype.update=function(e){var t=e.state.facet(showTooltip);if(t==this.tooltips){for(var r=0,n=this.tooltipViews;r<n.length;r++){var i=n[r];if(i.update)i.update(e)}}else{var o=[];for(var a=0;a<t.length;a++){var s=t[a],l=-1;for(var c=0;c<this.tooltips.length;c++)if(this.tooltips[c].create==s.create)l=c;if(l<0){o[a]=this.createTooltip(s)}else{var u=o[a]=this.tooltipViews[l];if(u.update)u.update(e)}}for(var f=0,h=this.tooltipViews;f<h.length;f++){var i=h[f];if(o.indexOf(i)<0)i.dom.remove()}this.tooltips=t;this.tooltipViews=o;this.maybeMeasure()}};e.prototype.createTooltip=function(e){var t=e.create(this.view);t.dom.className=themeClass("tooltip"+(e.style?"."+e.style:""));this.view.dom.appendChild(t.dom);if(t.mount)t.mount(this.view);return t};e.prototype.destroy=function(){for(var e=0,t=this.tooltipViews;e<t.length;e++){var r=t[e].dom;r.remove()}};e.prototype.readMeasure=function(){var e=this;return{editor:this.view.dom.getBoundingClientRect(),pos:this.tooltips.map((function(t){return e.view.coordsAtPos(t.pos)})),size:this.tooltipViews.map((function(e){var t=e.dom;return t.getBoundingClientRect()})),innerWidth:window.innerWidth,innerHeight:window.innerHeight}};e.prototype.writeMeasure=function(e){var t=e.editor;for(var r=0;r<this.tooltipViews.length;r++){var n=this.tooltips[r],i=this.tooltipViews[r],o=i.dom;var a=e.pos[r],s=e.size[r];if(!a||a.bottom<=t.top||a.top>=t.bottom||a.right<=t.left||a.left>=t.right){o.style.top=Outside;continue}var l=s.right-s.left,c=s.bottom-s.top;var u=this.view.textDirection==Direction.LTR?Math.min(a.left,e.innerWidth-l):Math.max(0,a.left-l);var f=!!n.above;if(!n.strictSide&&(f?a.top-(s.bottom-s.top)<0:a.bottom+(s.bottom-s.top)>e.innerHeight))f=!f;o.style.top=(f?a.top-c:a.bottom)+"px";o.style.left=u+"px";o.classList.toggle("cm-tooltip-above",f);o.classList.toggle("cm-tooltip-below",!f);if(i.positioned)i.positioned()}};e.prototype.maybeMeasure=function(){if(this.tooltips.length){if(this.view.inView||this.inView)this.view.requestMeasure(this.measureReq);this.inView=this.view.inView}};return e}(),{eventHandlers:{scroll:function(){this.maybeMeasure()}}});var baseTheme$1=EditorView.baseTheme({$tooltip:{position:"fixed",border:"1px solid #ddd",backgroundColor:"#f5f5f5",zIndex:100}});function tooltips(){return[tooltipPlugin,baseTheme$1]}var showTooltip=Facet.define();var CompletionContext=function(){function e(e,t,r){this.state=e;this.pos=t;this.explicit=r;this.abortListeners=[]}e.prototype.tokenBefore=function(e){var t=this.state.tree.resolve(this.pos,-1);while(t&&e.indexOf(t.name)<0)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null};e.prototype.matchBefore=function(e){var t=this.state.doc.lineAt(this.pos);var r=Math.max(t.from,this.pos-250);var n=t.slice(r-t.from,this.pos-t.from);var i=n.search(ensureAnchor(e,false));return i<0?null:{from:r+i,to:this.pos,text:n.slice(i)}};Object.defineProperty(e.prototype,"aborted",{get:function(){return this.abortListeners==null},enumerable:false,configurable:true});e.prototype.addEventListener=function(e,t){if(this.abortListeners)this.abortListeners.push(t)};return e}();var Option=function(){function e(e,t,r){this.completion=e;this.source=t;this.match=r}return e}();function cur(e){return e.selection.primary.head}function ensureAnchor(e,t){var r;var n=e.source;var i=t&&n[0]!="^",o=n[n.length-1]!="$";if(!i&&!o)return e;return new RegExp((i?"^":"")+"(?:"+n+")"+(o?"$":""),(r=e.flags)!==null&&r!==void 0?r:e.ignoreCase?"i":"")}function applyCompletion(e,t){var r=t.completion.apply||t.completion.label;var n=t.source;if(typeof r=="string"){e.dispatch({changes:{from:n.from,to:n.to,insert:r},selection:{anchor:n.from+r.length}})}else{r(e,t.completion,n.from,n.to)}}var FuzzyMatcher=function(){function e(e){this.pattern=e;this.chars=[];this.folded=[];this.any=[];this.precise=[];this.byWord=[];for(var t=0;t<e.length;){var r=codePointAt(e,t),n=codePointSize(r);this.chars.push(r);var i=e.slice(t,t+n),o=i.toUpperCase();this.folded.push(codePointAt(o==i?i.toLowerCase():o,0));t+=n}this.astral=e.length!=this.chars.length}e.prototype.match=function(e){if(this.pattern.length==0)return[0];if(e.length<this.pattern.length)return null;var t=this,r=t.chars,n=t.folded,i=t.any,o=t.precise,a=t.byWord;if(r.length==1){var s=codePointAt(e,0);return s==r[0]?[0,0,codePointSize(s)]:s==n[0]?[-200,0,codePointSize(s)]:null}var l=e.indexOf(this.pattern);if(l==0)return[0,0,this.pattern.length];var c=r.length,u=0;if(l<0){for(var f=0,h=Math.min(e.length,200);f<h&&u<c;){var d=codePointAt(e,f);if(d==r[u]||d==n[u])i[u++]=f;f+=codePointSize(d)}if(u<c)return null}var p=0;var g=0,m=false;var v=0,O=-1,y=-1;for(var b=0,h=Math.min(e.length,200),S=0;b<h&&g<c;){var d=codePointAt(e,b);if(l<0){if(p<c&&d==r[p])o[p++]=b;if(v<c){if(d==r[v]||d==n[v]){if(v==0)O=b;y=b;v++}else{v=0}}}var w=void 0,x=d<255?d>=48&&d<=57||d>=97&&d<=122?2:d>=65&&d<=90?1:0:(w=fromCodePoint(d))!=w.toLowerCase()?1:w!=w.toUpperCase()?2:0;if(x==1||S==0&&x!=0&&(this.chars[g]==d||this.folded[g]==d&&(m=true)))a[g++]=b;S=x;b+=codePointSize(d)}if(g==c&&a[0]==0)return this.result(-100+(m?-200:0),a,e);if(v==c&&O==0)return[-200,0,y];if(l>-1)return[-700,l,l+this.pattern.length];if(v==c)return[-200+-700,O,y];if(g==c)return this.result(-100+(m?-200:0)+-700,a,e);return r.length==2?null:this.result((i[0]?-700:0)+-200+-1100,i,e)};e.prototype.result=function(e,t,r){var n=[e],i=1;for(var o=0,a=t;o<a.length;o++){var s=a[o];var l=s+(this.astral?codePointSize(codePointAt(r,s)):1);if(i>1&&n[i-1]==s)n[i-1]=l;else{n[i++]=s;n[i++]=l}}return n};return e}();var completionConfig=Facet.define({combine:function(e){return combineConfig(e,{activateOnTyping:true,override:null,maxRenderedOptions:100})}});var MaxInfoWidth=300;var baseTheme$2=EditorView.baseTheme({"$tooltip.autocomplete":{"& > ul":{fontFamily:"monospace",overflowY:"auto",whiteSpace:"nowrap",maxHeight:"10em",listStyle:"none",margin:0,padding:0,"& > li":{cursor:"pointer",padding:"1px 1em 1px 3px",lineHeight:1.2},"& > li[aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"}}},"$completionListIncompleteTop:before, $completionListIncompleteBottom:after":{content:'"···"',opacity:.5,display:"block",textAlign:"center"},"$tooltip.completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:MaxInfoWidth+"px"},"$tooltip.completionInfo.left":{right:"100%"},"$tooltip.completionInfo.right":{left:"100%"},"$$light $snippetField":{backgroundColor:"#ddd"},"$$dark $snippetField":{backgroundColor:"#333"},$snippetFieldPosition:{verticalAlign:"text-top",width:0,height:"1.15em",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},$completionMatchedText:{textDecoration:"underline"},$completionDetail:{marginLeft:"0.5em",fontStyle:"italic"},$completionIcon:{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6"},"$completionIcon.function, $completionIcon.method":{"&:after":{content:"'ƒ'"}},"$completionIcon.class":{"&:after":{content:"'○'"}},"$completionIcon.interface":{"&:after":{content:"'◌'"}},"$completionIcon.variable":{"&:after":{content:"'𝑥'"}},"$completionIcon.constant":{"&:after":{content:"'𝐶'"}},"$completionIcon.type":{"&:after":{content:"'𝑡'"}},"$completionIcon.enum":{"&:after":{content:"'∪'"}},"$completionIcon.property":{"&:after":{content:"'□'"}},"$completionIcon.keyword":{"&:after":{content:"'🔑︎'"}},"$completionIcon.namespace":{"&:after":{content:"'▢'"}},"$completionIcon.text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});function createListBox(e,t,r){var n=document.createElement("ul");n.id=t;n.setAttribute("role","listbox");n.setAttribute("aria-expanded","true");for(var i=r.from;i<r.to;i++){var o=e[i],a=o.completion,s=o.match;var l=n.appendChild(document.createElement("li"));l.id=t+"-"+i;var c=l.appendChild(document.createElement("div"));c.className=themeClass("completionIcon"+(a.type?"."+a.type:""));c.setAttribute("aria-hidden","true");var u=l.appendChild(document.createElement("span"));u.className=themeClass("completionLabel");var f=a.label,h=a.detail,d=0;for(var p=1;p<s.length;){var g=s[p++],m=s[p++];if(g>d)u.appendChild(document.createTextNode(f.slice(d,g)));var v=u.appendChild(document.createElement("span"));v.appendChild(document.createTextNode(f.slice(g,m)));v.className=themeClass("completionMatchedText");d=m}if(d<f.length)u.appendChild(document.createTextNode(f.slice(d)));if(h){var O=l.appendChild(document.createElement("span"));O.className=themeClass("completionDetail");O.textContent=h}l.setAttribute("role","option")}if(r.from)n.classList.add(themeClass("completionListIncompleteTop"));if(r.to<e.length)n.classList.add(themeClass("completionListIncompleteBottom"));return n}function createInfoDialog(e){var t=document.createElement("div");t.className=themeClass("tooltip.completionInfo");var r=e.completion.info;if(typeof r=="string")t.textContent=r;else t.appendChild(r(e.completion));return t}function rangeAroundSelected(e,t,r){if(e<=r)return{from:0,to:e};if(t<=e>>1){var n=Math.floor(t/r);return{from:n*r,to:(n+1)*r}}var i=Math.floor((e-t)/r);return{from:e-(i+1)*r,to:e-i*r}}var CompletionTooltip=function(){function e(e,t){var r=this;this.view=e;this.stateField=t;this.info=null;this.placeInfo={read:function(){return r.measureInfo()},write:function(e){return r.positionInfo(e)},key:this};var n=e.state.field(t);var i=n.open,o=i.options,a=i.selected;var s=e.state.facet(completionConfig);this.range=rangeAroundSelected(o.length,a,s.maxRenderedOptions);this.dom=document.createElement("div");this.dom.addEventListener("mousedown",(function(t){for(var n=t.target,i=void 0;n&&n!=r.dom;n=n.parentNode){if(n.nodeName=="LI"&&(i=/-(\d+)$/.exec(n.id))&&+i[1]<o.length){applyCompletion(e,o[+i[1]]);t.preventDefault();return}}}));this.list=this.dom.appendChild(createListBox(o,n.id,this.range));this.list.addEventListener("scroll",(function(){if(r.info)r.view.requestMeasure(r.placeInfo)}))}e.prototype.mount=function(){this.updateSel()};e.prototype.update=function(e){if(e.state.field(this.stateField)!=e.prevState.field(this.stateField))this.updateSel()};e.prototype.positioned=function(){if(this.info)this.view.requestMeasure(this.placeInfo)};e.prototype.updateSel=function(){var e=this;var t=this.view.state.field(this.stateField),r=t.open;if(r.selected<this.range.from||r.selected>=this.range.to){this.range=rangeAroundSelected(r.options.length,r.selected,this.view.state.facet(completionConfig).maxRenderedOptions);this.list.remove();this.list=this.dom.appendChild(createListBox(r.options,t.id,this.range));this.list.addEventListener("scroll",(function(){if(e.info)e.view.requestMeasure(e.placeInfo)}))}if(this.updateSelectedOption(r.selected)){if(this.info){this.info.remove();this.info=null}var n=r.options[r.selected];if(n.completion.info){this.info=this.dom.appendChild(createInfoDialog(n));this.view.requestMeasure(this.placeInfo)}}};e.prototype.updateSelectedOption=function(e){var t=null;for(var r=this.list.firstChild,n=this.range.from;r;r=r.nextSibling,n++){if(n==e){if(!r.hasAttribute("aria-selected")){r.setAttribute("aria-selected","true");t=r}}else{if(r.hasAttribute("aria-selected"))r.removeAttribute("aria-selected")}}if(t)scrollIntoView(this.list,t);return t};e.prototype.measureInfo=function(){var e=this.dom.querySelector("[aria-selected]");if(!e)return null;var t=this.dom.getBoundingClientRect();var r=e.getBoundingClientRect().top-t.top;if(r<0||r>this.list.clientHeight-10)return null;var n=this.view.textDirection==Direction.RTL;var i=t.left,o=innerWidth-t.right;if(n&&i<Math.min(MaxInfoWidth,o))n=false;else if(!n&&o<Math.min(MaxInfoWidth,i))n=true;return{top:r,left:n}};e.prototype.positionInfo=function(e){if(this.info&&e){this.info.style.top=e.top+"px";this.info.classList.toggle("cm-tooltip-completionInfo-left",e.left);this.info.classList.toggle("cm-tooltip-completionInfo-right",!e.left)}};return e}();function completionTooltip(e){return function(t){return new CompletionTooltip(t,e)}}function scrollIntoView(e,t){var r=e.getBoundingClientRect();var n=t.getBoundingClientRect();if(n.top<r.top)e.scrollTop-=r.top-n.top;else if(n.bottom>r.bottom)e.scrollTop+=n.bottom-r.bottom}var MaxOptions=300;function sortOptions(e,t){var r=[];for(var n=0,i=e;n<i.length;n++){var o=i[n];if(o.hasResult()){var a=new FuzzyMatcher(t.sliceDoc(o.from,o.to)),s=void 0;for(var l=0,c=o.result.options;l<c.length;l++){var u=c[l];if(s=a.match(u.label)){if(u.boost!=null)s[0]+=u.boost;r.push(new Option(u,o,s))}}}}r.sort(cmpOption);return r.length>MaxOptions?r.slice(0,MaxOptions):r}var CompletionDialog=function(){function e(e,t,r,n,i){this.options=e;this.attrs=t;this.tooltip=r;this.timestamp=n;this.selected=i}e.prototype.setSelected=function(t,r){return t==this.selected||t>=this.options.length?this:new e(this.options,makeAttrs(r,t),this.tooltip,this.timestamp,t)};e.build=function(t,r,n,i){var o=sortOptions(t,r);if(!o.length)return null;var a=0;if(i){var s=i.options[i.selected].completion;for(var l=0;l<o.length&&!a;l++){if(o[l].completion==s)a=l}}return new e(o,makeAttrs(n,a),[{pos:t.reduce((function(e,t){return t.hasResult()?Math.min(e,t.from):e}),1e8),style:"autocomplete",create:completionTooltip(completionState)}],i?i.timestamp:Date.now(),a)};e.prototype.map=function(t){return new e(this.options,this.attrs,[Object.assign(Object.assign({},this.tooltip[0]),{pos:t.mapPos(this.tooltip[0].pos)})],this.timestamp,this.selected)};return e}();var CompletionState=function(){function e(e,t,r){this.active=e;this.id=t;this.open=r}e.start=function(){return new e(none$5,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)};e.prototype.update=function(t){var r=this;var n=t.state,i=n.facet(completionConfig);var o=i.override||n.languageDataAt("autocomplete",cur(n));var a=o.map((function(e){var n=r.active.find((function(t){return t.source==e}))||new ActiveSource(e,0,false);return n.update(t,i)}));if(a.length==this.active.length&&a.every((function(e,t){return e==r.active[t]})))a=this.active;var s=t.selection||a.some((function(e){return e.hasResult()&&t.changes.touchesRange(e.from,e.to)}))||!sameResults(a,this.active)?CompletionDialog.build(a,n,this.id,this.open):this.open&&t.docChanged?this.open.map(t.changes):this.open;for(var l=0,c=t.effects;l<c.length;l++){var u=c[l];if(u.is(setSelectedEffect))s=s&&s.setSelected(u.value,this.id)}return a==this.active&&s==this.open?this:new e(a,this.id,s)};Object.defineProperty(e.prototype,"tooltip",{get:function(){return this.open?this.open.tooltip:none$5},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"attrs",{get:function(){return this.open?this.open.attrs:baseAttrs},enumerable:false,configurable:true});return e}();function sameResults(e,t){if(e==t)return true;for(var r=0,n=0;;){while(r<e.length&&!e[r].hasResult)r++;while(n<t.length&&!t[n].hasResult)n++;var i=r==e.length,o=n==t.length;if(i||o)return i==o;if(e[r++].result!=t[n++].result)return false}}function makeAttrs(e,t){return{"aria-autocomplete":"list","aria-activedescendant":e+"-"+t,"aria-owns":e}}var baseAttrs={"aria-autocomplete":"list"},none$5=[];function cmpOption(e,t){var r=t.match[0]-e.match[0];if(r)return r;var n=e.completion.label,i=t.completion.label;return n<i?-1:n==i?0:1}var ActiveSource=function(){function e(e,t,r){this.source=e;this.state=t;this.explicit=r}e.prototype.hasResult=function(){return false};e.prototype.update=function(t,r){var n=t.annotation(Transaction.userEvent),i=this;if(n=="input"||n=="delete")i=i.handleUserEvent(t,n,r);else if(t.docChanged)i=i.handleChange(t);else if(t.selection&&i.state!=0)i=new e(i.source,0,false);for(var o=0,a=t.effects;o<a.length;o++){var s=a[o];if(s.is(toggleCompletionEffect)){i=s.value?new e(i.source,1,true):new e(i.source,0,false)}else if(s.is(setActiveEffect)){for(var l=0,c=s.value;l<c.length;l++){var u=c[l];if(u.source==i.source)i=u}}}return i};e.prototype.handleUserEvent=function(t,r,n){return r=="delete"||!n.activateOnTyping?this:new e(this.source,1,false)};e.prototype.handleChange=function(t){return t.changes.touchesRange(cur(t.startState))?new e(this.source,0,false):this};return e}();var ActiveResult=function(e){__extends(t,e);function t(t,r,n,i,o,a){var s=e.call(this,t,2,r)||this;s.result=n;s.from=i;s.to=o;s.span=a;return s}t.prototype.hasResult=function(){return true};t.prototype.handleUserEvent=function(e,r,n){var i=e.changes.mapPos(this.from),o=e.changes.mapPos(this.to,1);var a=cur(e.state);if((this.explicit?a<i:a<=i)||a>o)return new ActiveSource(this.source,r=="input"&&n.activateOnTyping?1:0,false);if(this.span&&(i==o||this.span.test(e.state.sliceDoc(i,o))))return new t(this.source,this.explicit,this.result,i,o,this.span);return new ActiveSource(this.source,1,this.explicit)};t.prototype.handleChange=function(e){return e.changes.touchesRange(this.from,this.to)?new ActiveSource(this.source,0,false):new t(this.source,this.explicit,this.result,e.changes.mapPos(this.from),e.changes.mapPos(this.to,1),this.span)};t.prototype.map=function(e){return new t(this.source,this.explicit,this.result,e.mapPos(this.from),e.mapPos(this.to,1),this.span)};return t}(ActiveSource);var toggleCompletionEffect=StateEffect.define();var setActiveEffect=StateEffect.define({map:function(e,t){return e.map((function(e){return e.hasResult()&&!t.empty?e.map(t):e}))}});var setSelectedEffect=StateEffect.define();var completionState=StateField.define({create:function(){return CompletionState.start()},update:function(e,t){return e.update(t)},provide:[showTooltip.nFrom((function(e){return e.tooltip})),EditorView.contentAttributes.from((function(e){return e.attrs}))]});var CompletionInteractMargin=75;function moveCompletionSelection(e,t){if(t===void 0){t="option"}return function(r){var n=r.state.field(completionState,false);if(!n||!n.open||Date.now()-n.open.timestamp<CompletionInteractMargin)return false;var i=1,o;if(t=="page"&&(o=r.dom.querySelector(".cm-tooltip-autocomplete")))i=Math.max(2,Math.floor(o.offsetHeight/o.firstChild.offsetHeight));var a=n.open.selected+i*(e?1:-1),s=n.open.options.length;if(a<0)a=t=="page"?0:s-1;else if(a>=s)a=t=="page"?s-1:0;r.dispatch({effects:setSelectedEffect.of(a)});return true}}var acceptCompletion=function(e){var t=e.state.field(completionState,false);if(!t||!t.open||Date.now()-t.open.timestamp<CompletionInteractMargin)return false;applyCompletion(e,t.open.options[t.open.selected]);return true};var startCompletion=function(e){var t=e.state.field(completionState,false);if(!t)return false;e.dispatch({effects:toggleCompletionEffect.of(true)});return true};var RunningQuery=function(){function e(e,t){this.source=e;this.context=t;this.time=Date.now();this.updates=[];this.done=undefined}return e}();var DebounceTime=50,MaxUpdateCount=50,MinAbortTime=1e3;var completionPlugin=ViewPlugin.fromClass(function(){function e(e){this.view=e;this.debounceUpdate=-1;this.running=[];this.debounceAccept=-1;for(var t=0,r=e.state.field(completionState).active;t<r.length;t++){var n=r[t];if(n.state==1)this.startQuery(n)}}e.prototype.update=function(e){var t;var r=this;var n=e.state.field(completionState);if(!e.selectionSet&&!e.docChanged&&e.prevState.field(completionState)==n)return;var i=e.transactions.some((function(e){var t=e.annotation(Transaction.userEvent);return(e.selection||e.docChanged)&&t!="input"&&t!="delete"}));for(var o=0;o<this.running.length;o++){var a=this.running[o];if(i||a.updates.length+e.transactions.length>MaxUpdateCount&&a.time-Date.now()>MinAbortTime){for(var s=0,l=a.context.abortListeners;s<l.length;s++){var c=l[s];try{c()}catch(u){logException(this.view.state,u)}}a.context.abortListeners=null;this.running.splice(o--,1)}else{(t=a.updates).push.apply(t,e.transactions)}}if(this.debounceUpdate>-1)clearTimeout(this.debounceUpdate);this.debounceUpdate=n.active.some((function(e){return e.state==1&&!r.running.some((function(t){return t.source==e.source}))}))?setTimeout((function(){return r.startUpdate()}),DebounceTime):-1};e.prototype.startUpdate=function(){this.debounceUpdate=-1;var e=this.view.state,t=e.field(completionState);var r=function(e){if(e.state==1&&!n.running.some((function(t){return t.source==e.source})))n.startQuery(e)};var n=this;for(var i=0,o=t.active;i<o.length;i++){var a=o[i];r(a)}};e.prototype.startQuery=function(e){var t=this;var r=this.view.state,n=cur(r);var i=new CompletionContext(r,n,e.explicit);var o=new RunningQuery(e.source,i);this.running.push(o);Promise.resolve(e.source(i)).then((function(e){if(!o.context.aborted){o.done=e||null;t.scheduleAccept()}}),(function(e){t.view.dispatch({effects:toggleCompletionEffect.of(false)});logException(t.view.state,e)}))};e.prototype.scheduleAccept=function(){var e=this;if(this.running.every((function(e){return e.done!==undefined})))this.accept();else if(this.debounceAccept<0)this.debounceAccept=setTimeout((function(){return e.accept()}),DebounceTime)};e.prototype.accept=function(){var e;if(this.debounceAccept>-1)clearTimeout(this.debounceAccept);this.debounceAccept=-1;var t=[];var r=this.view.state.facet(completionConfig);var n=function(n){var a=i.running[n];if(a.done===undefined)return o=n,"continue";i.running.splice(n--,1);if(a.done){var s=new ActiveResult(a.source,a.context.explicit,a.done,a.done.from,(e=a.done.to)!==null&&e!==void 0?e:cur(a.updates.length?a.updates[0].startState:i.view.state),a.done.span?ensureAnchor(a.done.span,true):null);for(var l=0,c=a.updates;l<c.length;l++){var u=c[l];s=s.update(u,r)}if(s.hasResult()){t.push(s);return o=n,"continue"}}var f=i.view.state.field(completionState).active.find((function(e){return e.source==a.source}));if(f&&f.state==1){if(a.done==null){var s=new ActiveSource(a.source,0,false);for(var h=0,d=a.updates;h<d.length;h++){var u=d[h];s=s.update(u,r)}if(s.state!=1)t.push(s)}else{i.startQuery(f)}}o=n};var i=this,o;for(var a=0;a<this.running.length;a++){n(a);a=o}if(t.length)this.view.dispatch({effects:setActiveEffect.of(t)})};return e}());var fieldMarker=Decoration.widget({widget:new(function(e){__extends(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.toDOM=function(){var e=document.createElement("span");e.className=themeClass("snippetFieldPosition");return e};t.prototype.ignoreEvent=function(){return false};return t}(WidgetType))});var fieldRange=Decoration.mark({class:themeClass("snippetField")});var ActiveSnippet=function(){function e(e,t){this.ranges=e;this.active=t;this.deco=Decoration.set(e.map((function(e){return(e.from==e.to?fieldMarker:fieldRange).range(e.from,e.to)})))}e.prototype.map=function(t){return new e(this.ranges.map((function(e){return e.map(t)})),this.active)};e.prototype.selectionInsideField=function(e){var t=this;return e.ranges.every((function(e){return t.ranges.some((function(r){return r.field==t.active&&r.from<=e.from&&r.to>=e.to}))}))};return e}();var setActive=StateEffect.define({map:function(e,t){return e&&e.map(t)}});var moveToField=StateEffect.define();var snippetState=StateField.define({create:function(){return null},update:function(e,t){for(var r=0,n=t.effects;r<n.length;r++){var i=n[r];if(i.is(setActive))return i.value;if(i.is(moveToField)&&e)return new ActiveSnippet(e.ranges,i.value)}if(e&&t.docChanged)e=e.map(t.changes);if(e&&t.selection&&!e.selectionInsideField(t.selection))e=null;return e},provide:[EditorView.decorations.from((function(e){return e?e.deco:Decoration.none}))]});function fieldSelection(e,t){return EditorSelection.create(e.filter((function(e){return e.field==t})).map((function(e){return EditorSelection.range(e.from,e.to)})))}function moveField(e){return function(t){var r=t.state,n=t.dispatch;var i=r.field(snippetState,false);if(!i||e<0&&i.active==0)return false;var o=i.active+e,a=e>0&&!i.ranges.some((function(t){return t.field==o+e}));n(r.update({selection:fieldSelection(i.ranges,o),effects:setActive.of(a?null:new ActiveSnippet(i.ranges,o))}));return true}}var clearSnippet=function(e){var t=e.state,r=e.dispatch;var n=t.field(snippetState,false);if(!n)return false;r(t.update({effects:setActive.of(null)}));return true};var snippetKeymap=precedence(keymap([{key:"Tab",run:moveField(1),shift:moveField(-1)},{key:"Escape",run:clearSnippet}]),"override");function autocompletion(e){if(e===void 0){e={}}return[completionState,completionConfig.of(e),completionPlugin,baseTheme$2,tooltips(),precedence(keymap([{key:"ArrowDown",run:moveCompletionSelection(true)},{key:"ArrowUp",run:moveCompletionSelection(false)},{key:"PageDown",run:moveCompletionSelection(true,"page")},{key:"PageUp",run:moveCompletionSelection(false,"page")},{key:"Enter",run:acceptCompletion}]),"override")]}var defaults={brackets:["(","[","{","'",'"'],before:")]}'\":;>"};function closeBrackets(){return EditorView.inputHandler.of(handleInput)}var definedClosing="()[]{}<>";function closing(e){for(var t=0;t<definedClosing.length;t+=2)if(definedClosing.charCodeAt(t)==e)return definedClosing.charAt(t+1);return fromCodePoint(e<128?e:e+1)}function config(e,t){return e.languageDataAt("closeBrackets",t)[0]||defaults}function handleInput(e,t,r,n){if(e.composing)return false;var i=e.state.selection.primary;if(n.length>2||n.length==2&&codePointSize(codePointAt(n,0))==1||t!=i.from||r!=i.to)return false;var o=handleInsertion(e.state,n);if(!o)return false;e.dispatch(o);return true}var deleteBracketPair=function(e){var t=e.state,r=e.dispatch;var n=config(t,t.selection.primary.head);var i=n.brackets||defaults.brackets;var o=null,a=t.changeByRange((function(e){if(e.empty){var r=prevChar(t.doc,e.head);for(var n=0,a=i;n<a.length;n++){var s=a[n];if(s==r&&nextChar(t.doc,e.head)==closing(codePointAt(s,0)))return{changes:{from:e.head-s.length,to:e.head+s.length},range:EditorSelection.cursor(e.head-s.length),annotations:Transaction.userEvent.of("delete")}}}return{range:o=e}}));if(!o)r(t.update(a,{scrollIntoView:true}));return!o};var closeBracketsKeymap=[{key:"Backspace",run:deleteBracketPair}];function handleInsertion(e,t){var r=config(e,e.selection.primary.head);var n=r.brackets||defaults.brackets;for(var i=0,o=n;i<o.length;i++){var a=o[i];var s=closing(codePointAt(a,0));if(t==a)return s==a?handleSame(e,a,n.indexOf(a+a+a)>-1):handleOpen(e,a,s,r.before||defaults.before);if(t==s)return handleClose(e,a,s)}return null}function nextChar(e,t){var r=e.sliceString(t,t+2);return r.slice(0,codePointSize(codePointAt(r,0)))}function prevChar(e,t){var r=e.sliceString(t-2,t);return codePointSize(codePointAt(r,0))==r.length?r:r.slice(1)}function handleOpen(e,t,r,n){var i=null,o=e.changeByRange((function(o){if(!o.empty)return{changes:[{insert:t,from:o.from},{insert:r,from:o.to}],range:EditorSelection.range(o.anchor+t.length,o.head+t.length)};var a=nextChar(e.doc,o.head);if(!a||/\s/.test(a)||n.indexOf(a)>-1)return{changes:{insert:t+r,from:o.head},range:EditorSelection.cursor(o.head+t.length)};return{range:i=o}}));return i?null:e.update(o,{scrollIntoView:true,annotations:Transaction.userEvent.of("input")})}function handleClose(e,t,r){var n=null,i=e.selection.ranges.map((function(t){if(t.empty&&nextChar(e.doc,t.head)==r)return EditorSelection.cursor(t.head+r.length);return n=t}));return n?null:e.update({selection:EditorSelection.create(i,e.selection.primaryIndex),scrollIntoView:true})}function handleSame(e,t,r){var n=null,i=e.changeByRange((function(i){if(!i.empty)return{changes:[{insert:t,from:i.from},{insert:t,from:i.to}],range:EditorSelection.range(i.anchor+t.length,i.head+t.length)};var o=i.head,a=nextChar(e.doc,o);if(a==t){if(nodeStart(e,o)){return{changes:{insert:t+t,from:o},range:EditorSelection.cursor(o+t.length)}}else{var s=r&&e.sliceDoc(o,o+t.length*3)==t+t+t;return{range:EditorSelection.cursor(o+t.length*(s?3:1))}}}else if(r&&e.sliceDoc(o-2*t.length,o)==t+t&&nodeStart(e,o-2*t.length)){return{changes:{insert:t+t+t+t,from:o},range:EditorSelection.cursor(o+t.length)}}else if(e.charCategorizer(o)(a)!=CharCategory.Word){var l=e.sliceDoc(o-1,o);if(l!=t&&e.charCategorizer(o)(l)!=CharCategory.Word)return{changes:{insert:t+t,from:o},range:EditorSelection.cursor(o+t.length)}}return{range:n=i}}));return n?null:e.update(i,{scrollIntoView:true,annotations:Transaction.userEvent.of("input")})}function nodeStart(e,t){var r=e.tree.resolve(t+1);return r.parent&&r.from==t}var baseTheme$3=EditorView.baseTheme({$matchingBracket:{color:"#0b0"},$nonmatchingBracket:{color:"#a22"}});var DefaultScanDist=1e4,DefaultBrackets="()[]{}";var bracketMatchingConfig=Facet.define({combine:function(e){return combineConfig(e,{afterCursor:true,brackets:DefaultBrackets,maxScanDistance:DefaultScanDist})}});var matchingMark=Decoration.mark({class:themeClass("matchingBracket")}),nonmatchingMark=Decoration.mark({class:themeClass("nonmatchingBracket")});var bracketMatchingState=StateField.define({create:function(){return Decoration.none},update:function(e,t){if(!t.docChanged&&!t.selection)return e;var r=[];var n=t.state.facet(bracketMatchingConfig);for(var i=0,o=t.state.selection.ranges;i<o.length;i++){var a=o[i];if(!a.empty)continue;var s=matchBrackets(t.state,a.head,-1,n)||a.head>0&&matchBrackets(t.state,a.head-1,1,n)||n.afterCursor&&(matchBrackets(t.state,a.head,1,n)||a.head<t.state.doc.length&&matchBrackets(t.state,a.head+1,-1,n));if(!s)continue;var l=s.matched?matchingMark:nonmatchingMark;r.push(l.range(s.start.from,s.start.to));if(s.end)r.push(l.range(s.end.from,s.end.to))}return Decoration.set(r,true)},provide:[EditorView.decorations]});var bracketMatchingUnique=[bracketMatchingState,baseTheme$3];function bracketMatching(e){if(e===void 0){e={}}return[bracketMatchingConfig.of(e),bracketMatchingUnique]}function matchingNodes(e,t,r){var n=e.prop(t<0?NodeProp.openedBy:NodeProp.closedBy);if(n)return n;if(e.name.length==1){var i=r.indexOf(e.name);if(i>-1&&i%2==(t<0?1:0))return[r[i+t]]}return null}function matchBrackets(e,t,r,n){if(n===void 0){n={}}var i=n.maxScanDistance||DefaultScanDist,o=n.brackets||DefaultBrackets;var a=e.tree,s=a.resolve(t,r),l;if(l=matchingNodes(s.type,r,o))return matchMarkedBrackets(e,t,r,s,l,o);else return matchPlainBrackets(e,t,r,a,s.type,i,o)}function matchMarkedBrackets(e,t,r,n,i,o){var a=n.parent,s={from:n.from,to:n.to};var l=0,c=a===null||a===void 0?void 0:a.cursor;if(c&&(r<0?c.childBefore(n.from):c.childAfter(n.to)))do{if(r<0?c.to<=n.from:c.from>=n.to){if(l==0&&i.indexOf(c.type.name)>-1){return{start:s,end:{from:c.from,to:c.to},matched:true}}else if(matchingNodes(c.type,r,o)){l++}else if(matchingNodes(c.type,-r,o)){l--;if(l==0)return{start:s,end:{from:c.from,to:c.to},matched:false}}}}while(r<0?c.prevSibling():c.nextSibling());return{start:s,matched:false}}function matchPlainBrackets(e,t,r,n,i,o,a){var s=r<0?e.sliceDoc(t-1,t):e.sliceDoc(t,t+1);var l=a.indexOf(s);if(l<0||l%2==0!=r>0)return null;var c={from:r<0?t-1:t,to:r>0?t+1:t};var u=e.doc.iterRange(t,r>0?e.doc.length:0),f=0;for(var h=0;!u.next().done&&h<=o;){var d=u.value;if(r<0)h+=d.length;var p=t+h*r;for(var g=r>0?0:d.length-1,m=r>0?d.length:-1;g!=m;g+=r){var v=a.indexOf(d[g]);if(v<0||n.resolve(p+g,1).type!=i)continue;if(v%2==0==r>0){f++}else if(f==1){return{start:c,end:{from:p+g,to:p+g+1},matched:v>>1==l>>1}}else{f--}}if(r>0)h+=d.length}return u.done?{start:c,matched:false}:null}function updateSel(e,t){return EditorSelection.create(e.ranges.map(t),e.primaryIndex)}function setSel(e,t){return e.update({selection:t,scrollIntoView:true,annotations:Transaction.userEvent.of("keyboardselection")})}function moveSel(e,t){var r=e.state,n=e.dispatch;var i=updateSel(r.selection,t);if(i.eq(r.selection))return false;n(setSel(r,i));return true}function rangeEnd(e,t){return EditorSelection.cursor(t?e.to:e.from)}function cursorByChar(e,t){return moveSel(e,(function(r){return r.empty?e.moveByChar(r,t):rangeEnd(r,t)}))}var cursorCharLeft=function(e){return cursorByChar(e,e.textDirection!=Direction.LTR)};var cursorCharRight=function(e){return cursorByChar(e,e.textDirection==Direction.LTR)};function cursorByGroup(e,t){return moveSel(e,(function(r){return r.empty?e.moveByGroup(r,t):rangeEnd(r,t)}))}var cursorGroupLeft=function(e){return cursorByGroup(e,e.textDirection!=Direction.LTR)};var cursorGroupRight=function(e){return cursorByGroup(e,e.textDirection==Direction.LTR)};var cursorGroupForward=function(e){return cursorByGroup(e,true)};var cursorGroupBackward=function(e){return cursorByGroup(e,false)};function interestingNode(e,t,r){if(t.type.prop(r))return true;var n=t.to-t.from;return n&&(n>2||/[^\s,.;:]/.test(e.sliceDoc(t.from,t.to)))||t.firstChild}function moveBySyntax(e,t,r){var n=e.tree.resolve(t.head);var i=r?NodeProp.closedBy:NodeProp.openedBy;for(var o=t.head;;){var a=r?n.childAfter(o):n.childBefore(o);if(!a)break;if(interestingNode(e,a,i))n=a;else o=r?a.to:a.from}var s=n.type.prop(i),l,c;if(s&&(l=r?matchBrackets(e,n.from,1):matchBrackets(e,n.to,-1))&&l.matched)c=r?l.end.to:l.end.from;else c=r?n.to:n.from;return EditorSelection.cursor(c,r?-1:1)}var cursorSyntaxLeft=function(e){return moveSel(e,(function(t){return moveBySyntax(e.state,t,e.textDirection!=Direction.LTR)}))};var cursorSyntaxRight=function(e){return moveSel(e,(function(t){return moveBySyntax(e.state,t,e.textDirection==Direction.LTR)}))};function cursorByLine(e,t){return moveSel(e,(function(r){return r.empty?e.moveVertically(r,t):rangeEnd(r,t)}))}var cursorLineUp=function(e){return cursorByLine(e,false)};var cursorLineDown=function(e){return cursorByLine(e,true)};function cursorByPage(e,t){return moveSel(e,(function(r){return r.empty?e.moveVertically(r,t,e.dom.clientHeight):rangeEnd(r,t)}))}var cursorPageUp=function(e){return cursorByPage(e,false)};var cursorPageDown=function(e){return cursorByPage(e,true)};function moveByLineBoundary(e,t,r){var n=e.visualLineAt(t.head),i=e.moveToLineBoundary(t,r);if(i.head==t.head&&i.head!=(r?n.to:n.from))i=e.moveToLineBoundary(t,r,false);if(!r&&i.head==n.from&&n.length){var o=/^\s*/.exec(e.state.sliceDoc(n.from,Math.min(n.from+100,n.to)))[0].length;if(o&&t.head>n.from+o)i=EditorSelection.cursor(n.from+o)}return i}var cursorLineBoundaryForward=function(e){return moveSel(e,(function(t){return moveByLineBoundary(e,t,true)}))};var cursorLineBoundaryBackward=function(e){return moveSel(e,(function(t){return moveByLineBoundary(e,t,false)}))};var cursorLineStart=function(e){return moveSel(e,(function(t){return EditorSelection.cursor(e.visualLineAt(t.head).from,1)}))};var cursorLineEnd=function(e){return moveSel(e,(function(t){return EditorSelection.cursor(e.visualLineAt(t.head).to,-1)}))};function toMatchingBracket(e,t,r){var n=false,i=updateSel(e.selection,(function(t){var i=matchBrackets(e,t.head,-1)||matchBrackets(e,t.head,1)||t.head>0&&matchBrackets(e,t.head-1,1)||t.head<e.doc.length&&matchBrackets(e,t.head+1,-1);if(!i||!i.end)return t;n=true;var o=i.start.from==t.head?i.end.to:i.end.from;return r?EditorSelection.range(t.anchor,o):EditorSelection.cursor(o)}));if(!n)return false;t(setSel(e,i));return true}var cursorMatchingBracket=function(e){var t=e.state,r=e.dispatch;return toMatchingBracket(t,r,false)};function extendSel(e,t){var r=updateSel(e.state.selection,(function(e){var r=t(e);return EditorSelection.range(e.anchor,r.head,r.goalColumn)}));if(r.eq(e.state.selection))return false;e.dispatch(setSel(e.state,r));return true}function selectByChar(e,t){return extendSel(e,(function(r){return e.moveByChar(r,t)}))}var selectCharLeft=function(e){return selectByChar(e,e.textDirection!=Direction.LTR)};var selectCharRight=function(e){return selectByChar(e,e.textDirection==Direction.LTR)};function selectByGroup(e,t){return extendSel(e,(function(r){return e.moveByGroup(r,t)}))}var selectGroupLeft=function(e){return selectByGroup(e,e.textDirection!=Direction.LTR)};var selectGroupRight=function(e){return selectByGroup(e,e.textDirection==Direction.LTR)};var selectGroupForward=function(e){return selectByGroup(e,true)};var selectGroupBackward=function(e){return selectByGroup(e,false)};var selectSyntaxLeft=function(e){return extendSel(e,(function(t){return moveBySyntax(e.state,t,e.textDirection!=Direction.LTR)}))};var selectSyntaxRight=function(e){return extendSel(e,(function(t){return moveBySyntax(e.state,t,e.textDirection==Direction.LTR)}))};function selectByLine(e,t){return extendSel(e,(function(r){return e.moveVertically(r,t)}))}var selectLineUp=function(e){return selectByLine(e,false)};var selectLineDown=function(e){return selectByLine(e,true)};function selectByPage(e,t){return extendSel(e,(function(r){return e.moveVertically(r,t,e.dom.clientHeight)}))}var selectPageUp=function(e){return selectByPage(e,false)};var selectPageDown=function(e){return selectByPage(e,true)};var selectLineBoundaryForward=function(e){return extendSel(e,(function(t){return moveByLineBoundary(e,t,true)}))};var selectLineBoundaryBackward=function(e){return extendSel(e,(function(t){return moveByLineBoundary(e,t,false)}))};var selectLineStart=function(e){return extendSel(e,(function(t){return EditorSelection.cursor(e.visualLineAt(t.head).from)}))};var selectLineEnd=function(e){return extendSel(e,(function(t){return EditorSelection.cursor(e.visualLineAt(t.head).to)}))};var cursorDocStart=function(e){var t=e.state,r=e.dispatch;r(setSel(t,{anchor:0}));return true};var cursorDocEnd=function(e){var t=e.state,r=e.dispatch;r(setSel(t,{anchor:t.doc.length}));return true};var selectDocStart=function(e){var t=e.state,r=e.dispatch;r(setSel(t,{anchor:t.selection.primary.anchor,head:0}));return true};var selectDocEnd=function(e){var t=e.state,r=e.dispatch;r(setSel(t,{anchor:t.selection.primary.anchor,head:t.doc.length}));return true};var selectAll=function(e){var t=e.state,r=e.dispatch;r(t.update({selection:{anchor:0,head:t.doc.length},annotations:Transaction.userEvent.of("keyboardselection")}));return true};var selectLine=function(e){var t=e.state,r=e.dispatch;var n=selectedLineBlocks(t).map((function(e){var r=e.from,n=e.to;return EditorSelection.range(r,Math.min(n+1,t.doc.length))}));r(t.update({selection:new EditorSelection(n),annotations:Transaction.userEvent.of("keyboardselection")}));return true};var selectParentSyntax=function(e){var t=e.state,r=e.dispatch;var n=updateSel(t.selection,(function(e){var r;var n=t.tree.resolve(e.head,1);while(!(n.from<e.from&&n.to>=e.to||n.to>e.to&&n.from<=e.from||!((r=n.parent)===null||r===void 0?void 0:r.parent)))n=n.parent;return EditorSelection.range(n.to,n.from)}));r(setSel(t,n));return true};var simplifySelection=function(e){var t=e.state,r=e.dispatch;var n=t.selection,i=null;if(n.ranges.length>1)i=new EditorSelection([n.primary]);else if(!n.primary.empty)i=new EditorSelection([EditorSelection.cursor(n.primary.head)]);if(!i)return false;r(setSel(t,i));return true};function deleteBy(e,t){var r=e.state,n=r.changeByRange((function(e){var r=e.from,n=e.to;if(r==n){var i=t(r);r=Math.min(r,i);n=Math.max(n,i)}return r==n?{range:e}:{changes:{from:r,to:n},range:EditorSelection.cursor(r)}}));if(n.changes.empty)return false;e.dispatch(n,{scrollIntoView:true,annotations:Transaction.userEvent.of("delete")});return true}var deleteByChar=function(e,t,r){return deleteBy(e,(function(n){var i=e.state,o=i.doc.lineAt(n),a;if(!t&&n>o.from&&n<o.from+200&&!/[^ \t]/.test(a=o.slice(0,n-o.from))){if(a[a.length-1]=="\t")return n-1;var s=countColumn(a,0,i.tabSize),l=s%i.indentUnit||i.indentUnit;for(var c=0;c<l&&a[a.length-1-c]==" ";c++)n--;return n}var u;if(r){var f=o.slice(n-o.from+(t?0:-2),n-o.from+(t?2:0));var h=f?codePointSize(codePointAt(f,0)):1;u=t?Math.min(i.doc.length,n+h):Math.max(0,n-h)}else{u=o.findClusterBreak(n-o.from,t)+o.from}if(u==n&&o.number!=(t?i.doc.lines:1))u+=t?1:-1;return u}))};var deleteCodePointBackward=function(e){return deleteByChar(e,false,true)};var deleteCharBackward=function(e){return deleteByChar(e,false,false)};var deleteCharForward=function(e){return deleteByChar(e,true,false)};var deleteByGroup=function(e,t){return deleteBy(e,(function(r){var n=e.state,i=n.doc.lineAt(r),o=n.charCategorizer(r);for(var a=null;;){var s=void 0,l=void 0;if(r==(t?i.to:i.from)){if(i.number==(t?n.doc.lines:1))break;i=n.doc.line(i.number+(t?1:-1));s=t?i.from:i.to;l="\n"}else{s=i.findClusterBreak(r-i.from,t)+i.from;l=i.slice(Math.min(r,s)-i.from,Math.max(r,s)-i.from)}var c=o(l);if(a!=null&&c!=a)break;if(c!=CharCategory.Space)a=c;r=s}return r}))};var deleteGroupBackward=function(e){return deleteByGroup(e,false)};var deleteGroupForward=function(e){return deleteByGroup(e,true)};var deleteToLineEnd=function(e){return deleteBy(e,(function(t){var r=e.visualLineAt(t).to;if(t<r)return r;return Math.max(e.state.doc.length,t+1)}))};var splitLine=function(e){var t=e.state,r=e.dispatch;var n=t.changeByRange((function(e){return{changes:{from:e.from,to:e.to,insert:Text.of(["",""])},range:EditorSelection.cursor(e.from)}}));r(t.update(n,{scrollIntoView:true,annotations:Transaction.userEvent.of("input")}));return true};var transposeChars=function(e){var t=e.state,r=e.dispatch;var n=t.changeByRange((function(e){if(!e.empty||e.from==0||e.from==t.doc.length)return{range:e};var r=e.from,n=t.doc.lineAt(r);var i=r==n.from?r-1:n.findClusterBreak(r-n.from,false)+n.from;var o=r==n.to?r+1:n.findClusterBreak(r-n.from,true)+n.from;return{changes:{from:i,to:o,insert:t.doc.slice(r,o).append(t.doc.slice(i,r))},range:EditorSelection.cursor(o)}}));if(n.changes.empty)return false;r(t.update(n,{scrollIntoView:true}));return true};function selectedLineBlocks(e){var t=[],r=-1;for(var n=0,i=e.selection.ranges;n<i.length;n++){var o=i[n];var a=e.doc.lineAt(o.from),s=e.doc.lineAt(o.to);if(r==a.number)t[t.length-1].to=s.to;else t.push({from:a.from,to:s.to});r=s.number}return t}function moveLine(e,t,r){var n=[];for(var i=0,o=selectedLineBlocks(e);i<o.length;i++){var a=o[i];if(r?a.to==e.doc.length:a.from==0)continue;var s=e.doc.lineAt(r?a.to+1:a.from-1);if(r)n.push({from:a.to,to:s.to},{from:a.from,insert:s.slice()+e.lineBreak});else n.push({from:s.from,to:a.from},{from:a.to,insert:e.lineBreak+s.slice()})}if(!n.length)return false;t(e.update({changes:n,scrollIntoView:true}));return true}var moveLineUp=function(e){var t=e.state,r=e.dispatch;return moveLine(t,r,false)};var moveLineDown=function(e){var t=e.state,r=e.dispatch;return moveLine(t,r,true)};function copyLine(e,t,r){var n=[];for(var i=0,o=selectedLineBlocks(e);i<o.length;i++){var a=o[i];if(r)n.push({from:a.from,insert:e.doc.slice(a.from,a.to)+e.lineBreak});else n.push({from:a.to,insert:e.lineBreak+e.doc.slice(a.from,a.to)})}t(e.update({changes:n,scrollIntoView:true}));return true}var copyLineUp=function(e){var t=e.state,r=e.dispatch;return copyLine(t,r,false)};var copyLineDown=function(e){var t=e.state,r=e.dispatch;return copyLine(t,r,true)};var deleteLine=function(e){var t=e.state,r=t.changes(selectedLineBlocks(t).map((function(e){var r=e.from,n=e.to;if(r>0)r--;else if(n<t.doc.length)n++;return{from:r,to:n}})));var n=updateSel(t.selection,(function(t){return e.moveVertically(t,true)})).map(r);e.dispatch({changes:r,selection:n,scrollIntoView:true});return true};function getIndentation(e,t){for(var r=0,n=e.state.facet(EditorState.indentation);r<n.length;r++){var i=n[r];var o=i(e,t);if(o>-1)return o}return-1}function isBetweenBrackets(e,t){if(/\(\)|\[\]|\{\}/.test(e.sliceDoc(t-1,t+1)))return{from:t,to:t};var r=e.tree.resolve(t);var n=r.childBefore(t),i=r.childAfter(t),o;if(n&&i&&n.to<=t&&i.from>=t&&(o=n.type.prop(NodeProp.closedBy))&&o.indexOf(i.name)>-1)return{from:n.to,to:i.from};return null}var insertNewlineAndIndent=function(e){var t=e.state,r=e.dispatch;var n=t.changeByRange((function(e){var r=e.from,n=e.to;var i=r==n&&isBetweenBrackets(t,r);var o=new IndentContext(t,{simulateBreak:r,simulateDoubleBreak:!!i});var a=getIndentation(o,r);if(a<0)a=/^\s*/.exec(t.doc.lineAt(r).slice(0,50))[0].length;var s=t.doc.lineAt(r);while(n<s.to&&/\s/.test(s.slice(n-s.from,n+1-s.from)))n++;if(i)r=i.from,n=i.to;else if(r>s.from&&r<s.from+100&&!/\S/.test(s.slice(0,r)))r=s.from;var l=["",t.indentString(a)];if(i)l.push(t.indentString(o.lineIndent(s)));return{changes:{from:r,to:n,insert:Text.of(l)},range:EditorSelection.cursor(r+1+a)}}));r(t.update(n,{scrollIntoView:true}));return true};function changeBySelectedLine(e,t){var r=-1;return e.changeByRange((function(n){var i=[];for(var o=e.doc.lineAt(n.from);;){if(o.number>r){t(o,i,n);r=o.number}if(n.to<=o.to)break;o=e.doc.lineAt(o.to+1)}var a=e.changes(i);return{changes:i,range:EditorSelection.range(a.mapPos(n.anchor,1),a.mapPos(n.head,1))}}))}var indentSelection=function(e){var t=e.state,r=e.dispatch;var n=Object.create(null);var i=new IndentContext(t,{overrideIndentation:function(e){var t=n[e];return t==null?-1:t}});var o=changeBySelectedLine(t,(function(e,r,o){var a=getIndentation(i,e.from);if(a<0)return;var s=/^\s*/.exec(e.slice(0,Math.min(e.length,200)))[0];var l=t.indentString(a);if(s!=l||o.from<e.from+s.length){n[e.from]=a;r.push({from:e.from,to:e.from+s.length,insert:l})}}));if(!o.changes.empty)r(t.update(o));return true};var indentMore=function(e){var t=e.state,r=e.dispatch;r(t.update(changeBySelectedLine(t,(function(e,r){r.push({from:e.from,insert:t.facet(EditorState.indentUnit)})}))));return true};var indentLess=function(e){var t=e.state,r=e.dispatch;r(t.update(changeBySelectedLine(t,(function(e,r){var n=e.slice(0,Math.min(e.length,200));var i=/^\s*/.exec(n)[0];if(!i)return;var o=countColumn(i,0,t.tabSize),a=t.indentString(Math.max(0,o-t.indentUnit)),s=0;while(s<i.length&&s<a.length&&i.charCodeAt(s)==a.charCodeAt(s))s++;r.push({from:e.from+s,to:e.from+i.length,insert:a.slice(s)})}))));return true};var emacsStyleKeymap=[{key:"Ctrl-b",run:cursorCharLeft,shift:selectCharLeft},{key:"Ctrl-f",run:cursorCharRight,shift:selectCharRight},{key:"Ctrl-p",run:cursorLineUp,shift:selectLineUp},{key:"Ctrl-n",run:cursorLineDown,shift:selectLineDown},{key:"Ctrl-a",run:cursorLineStart,shift:selectLineStart},{key:"Ctrl-e",run:cursorLineEnd,shift:selectLineEnd},{key:"Ctrl-d",run:deleteCharForward},{key:"Ctrl-h",run:deleteCharBackward},{key:"Ctrl-k",run:deleteToLineEnd},{key:"Alt-d",run:deleteGroupForward},{key:"Ctrl-Alt-h",run:deleteGroupBackward},{key:"Ctrl-o",run:splitLine},{key:"Ctrl-t",run:transposeChars},{key:"Alt-f",run:cursorGroupForward,shift:selectGroupForward},{key:"Alt-b",run:cursorGroupBackward,shift:selectGroupBackward},{key:"Alt-<",run:cursorDocStart},{key:"Alt->",run:cursorDocEnd},{key:"Ctrl-v",run:cursorPageDown},{key:"Alt-v",run:cursorPageUp}];var standardKeymap=[{key:"ArrowLeft",run:cursorCharLeft,shift:selectCharLeft},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:cursorGroupLeft,shift:selectGroupLeft},{mac:"Cmd-ArrowLeft",run:cursorLineStart,shift:selectLineStart},{key:"ArrowRight",run:cursorCharRight,shift:selectCharRight},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:cursorGroupRight,shift:selectGroupRight},{mac:"Cmd-ArrowRight",run:cursorLineEnd,shift:selectLineEnd},{key:"ArrowUp",run:cursorLineUp,shift:selectLineUp},{mac:"Cmd-ArrowUp",run:cursorDocStart,shift:selectDocStart},{mac:"Ctrl-ArrowUp",run:cursorPageUp,shift:selectPageUp},{key:"ArrowDown",run:cursorLineDown,shift:selectLineDown},{mac:"Cmd-ArrowDown",run:cursorDocEnd,shift:selectDocEnd},{mac:"Ctrl-ArrowDown",run:cursorPageDown,shift:selectPageDown},{key:"PageUp",run:cursorPageUp,shift:selectPageUp},{key:"PageDown",run:cursorPageDown,shift:selectPageDown},{key:"Home",run:cursorLineBoundaryBackward,shift:selectLineBoundaryBackward},{key:"Mod-Home",run:cursorDocStart,shift:selectDocStart},{key:"End",run:cursorLineBoundaryForward,shift:selectLineBoundaryForward},{key:"Mod-End",run:cursorDocEnd,shift:selectDocEnd},{key:"Enter",run:insertNewlineAndIndent},{key:"Mod-a",run:selectAll},{key:"Backspace",run:deleteCodePointBackward},{key:"Delete",run:deleteCharForward},{key:"Mod-Backspace",mac:"Alt-Backspace",run:deleteGroupBackward},{key:"Mod-Delete",mac:"Alt-Delete",run:deleteGroupForward}].concat(emacsStyleKeymap.map((function(e){return{mac:e.key,run:e.run,shift:e.shift}})));var defaultKeymap=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:cursorSyntaxLeft,shift:selectSyntaxLeft},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:cursorSyntaxRight,shift:selectSyntaxRight},{key:"Alt-ArrowUp",run:moveLineUp},{key:"Shift-Alt-ArrowUp",run:copyLineUp},{key:"Alt-ArrowDown",run:moveLineDown},{key:"Shift-Alt-ArrowDown",run:copyLineDown},{key:"Escape",run:simplifySelection},{key:"Mod-l",run:selectLine},{key:"Mod-i",run:selectParentSyntax},{key:"Mod-[",run:indentLess},{key:"Mod-]",run:indentMore},{key:"Mod-Alt-\\",run:indentSelection},{key:"Shift-Mod-k",run:deleteLine},{key:"Shift-Mod-\\",run:cursorMatchingBracket}].concat(standardKeymap);var toggleLineComment=function(e){return dispatch(toggleLineCommentWithOption(CommentOption.Toggle),e)};var toggleBlockComment=function(e){return dispatch(toggleBlockCommentWithOption(CommentOption.Toggle),e)};var commentKeymap=[{key:"Mod-/",run:toggleLineComment},{key:"Alt-A",run:toggleBlockComment}];function dispatch(e,t){var r=e(t.state);if(!r)return false;t.dispatch(r);return true}var CommentOption;(function(e){e[e["Toggle"]=0]="Toggle";e[e["OnlyComment"]=1]="OnlyComment";e[e["OnlyUncomment"]=2]="OnlyUncomment"})(CommentOption||(CommentOption={}));function getConfig(e,t){if(t===void 0){t=e.selection.primary.head}return e.languageDataAt("commentTokens",t)[0]||{}}var toggleBlockCommentWithOption=function(e){return function(t){var r=getConfig(t);return r.block?new BlockCommenter(r.block.open,r.block.close).toggle(e,t):null}};var toggleLineCommentWithOption=function(e){return function(t){var r=getConfig(t);return r.line?new LineCommenter(r.line).toggle(e,t):null}};var BlockCommenter=function(){function e(e,t,r){if(r===void 0){r=" "}this.open=e;this.close=t;this.margin=r}e.prototype.toggle=function(e,t){var r=this;var n=this.isSelectionCommented(t);if(n!==null){if(e!==CommentOption.OnlyComment){return t.update({changes:n.map((function(e){var t=e.open,n=e.close;return[{from:t.pos-r.open.length,to:t.pos+t.margin},{from:n.pos-n.margin,to:n.pos+r.close.length}]}))})}}else{if(e!==CommentOption.OnlyUncomment){return t.update(t.changeByRange((function(e){var t=(r.open+r.margin).length;return{changes:[{from:e.from,insert:r.open+r.margin},{from:e.to,insert:r.margin+r.close}],range:EditorSelection.range(e.anchor+t,e.head+t)}})))}}return null};e.prototype.isSelectionCommented=function(e){var t=[];for(var r=0,n=e.selection.ranges;r<n.length;r++){var i=n[r];var o=this.isRangeCommented(e,i);if(o===null)return null;t.push(o)}return t};e.prototype.isRangeCommented=function(e,t){var r=e.sliceDoc(t.from-SearchMargin,t.from);var n=e.sliceDoc(t.to,t.to+SearchMargin);var i=/\s*$/.exec(r)[0].length,o=/^\s*/.exec(n)[0].length;var a=r.length-i;if(r.slice(a-this.open.length,a)==this.open&&n.slice(o,o+this.close.length)==this.close){return{open:{pos:t.from-i,margin:i&&1},close:{pos:t.to+o,margin:o&&1}}}var s,l;if(t.to-t.from<=2*SearchMargin){s=l=e.sliceDoc(t.from,t.to)}else{s=e.sliceDoc(t.from,t.from+SearchMargin);l=e.sliceDoc(t.to-SearchMargin,t.to)}var c=/^\s*/.exec(s)[0].length,u=/\s*$/.exec(l)[0].length;var f=l.length-u-this.close.length;if(s.slice(c,c+this.open.length)==this.open&&l.slice(f,f+this.close.length)==this.close){return{open:{pos:t.from+c+this.open.length,margin:/\s/.test(s.charAt(c+this.open.length))?1:0},close:{pos:t.to-u-this.close.length,margin:/\s/.test(l.charAt(f-1))?1:0}}}return null};return e}();var SearchMargin=50;var LineCommenter=function(){function e(e,t){if(t===void 0){t=" "}this.lineCommentToken=e;this.margin=t}e.prototype.toggle=function(e,t){var r=[];var n={};for(var i=0;i<t.selection.ranges.length;i++){var o=getLinesInRange(t.doc,t.selection.ranges[i]);r.push.apply(r,o);n[i]=o}var a=this.isRangeCommented(t,r);if(a.isRangeLineSkipped){if(e!=CommentOption.OnlyComment){var s=[];for(var l=0;l<t.selection.ranges.length;l++){var o=n[l];for(var c=0,u=o;c<u.length;c++){var f=u[c];if(o.length>1&&a.isLineSkipped[f.number])continue;var h=f.from+a.minCol;var d=a.minCol+this.lineCommentToken.length;var p=f.slice(d,d+1)==" "?1:0;s.push({from:h,to:h+this.lineCommentToken.length+p})}}return t.update({changes:s})}}else{if(e!=CommentOption.OnlyUncomment){var s=[];for(var g=0;g<t.selection.ranges.length;g++){var o=n[g];for(var m=0,v=o;m<v.length;m++){var f=v[m];if(o.length<=1||!a.isLineSkipped[f.number])s.push({from:f.from+a.minCol,insert:this.lineCommentToken+this.margin})}}return t.update({changes:s})}}return null};e.prototype.isRangeCommented=function(e,t){var r=Infinity;var n=true;var i=[];for(var o=0,a=t;o<a.length;o++){var s=a[o];var l=s.slice(0,Math.min(s.length,SearchMargin));var c=/^\s*/.exec(l)[0].length;if((t.length==1||c<l.length)&&c<r){r=c}if(n&&(t.length==1||c<l.length)&&l.slice(c,c+this.lineCommentToken.length)!=this.lineCommentToken){n=false}i[s.number]=c==l.length}return{minCol:r,isRangeLineSkipped:n,isLineSkipped:i}};return e}();function getLinesInRange(e,t){var r=e.lineAt(t.from);var n=[];while(r.from+r.length<t.to||r.from<=t.to&&t.to<=r.to){n.push(r);if(r.number+1<=e.lines){r=e.line(r.number+1)}else{break}}return n}var GutterMarker=function(e){__extends(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.compare=function(e){return this==e||this.constructor==e.constructor&&this.eq(e)};t.prototype.toDOM=function(e){return null};t.prototype.at=function(e){return new Range(e,e,this)};return t}(RangeValue);GutterMarker.prototype.elementClass="";GutterMarker.prototype.mapMode=MapMode.TrackBefore;var defaults$1={style:"",renderEmptyElements:false,elementStyle:"",markers:function(){return RangeSet.empty},lineMarker:function(){return null},initialSpacer:null,updateSpacer:null,domEventHandlers:{}};var activeGutters=Facet.define();function gutter(e){return[gutters(),activeGutters.of(Object.assign(Object.assign({},defaults$1),e))]}var baseTheme$4=EditorView.baseTheme({$gutters:{display:"flex",height:"100%",boxSizing:"border-box",left:0},"$$light $gutters":{backgroundColor:"#f5f5f5",color:"#999",borderRight:"1px solid #ddd"},"$$dark $gutters":{backgroundColor:"#333338",color:"#ccc"},$gutter:{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",height:"100%",overflow:"hidden"},$gutterElement:{boxSizing:"border-box"},"$gutterElement.lineNumber":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"}});var unfixGutters=Facet.define({combine:function(e){return e.some((function(e){return e}))}});function gutters(e){var t=[gutterView,baseTheme$4];if(e&&e.fixed===false)t.push(unfixGutters.of(true));return t}var gutterView=ViewPlugin.fromClass(function(){function e(e){this.view=e;this.dom=document.createElement("div");this.dom.className=themeClass("gutters");this.dom.setAttribute("aria-hidden","true");this.gutters=e.state.facet(activeGutters).map((function(t){return new SingleGutterView(e,t)}));for(var t=0,r=this.gutters;t<r.length;t++){var n=r[t];this.dom.appendChild(n.dom)}this.fixed=!e.state.facet(unfixGutters);if(this.fixed){this.dom.style.position="sticky"}e.scrollDOM.insertBefore(this.dom,e.contentDOM)}e.prototype.update=function(e){var t=this;if(!this.updateGutters(e))return;var r=this.gutters.map((function(e){return new UpdateContext(e,t.view.viewport)}));this.view.viewportLines((function(e){var n;if(Array.isArray(e.type)){for(var i=0,o=e.type;i<o.length;i++){var a=o[i];if(a.type==BlockType.Text){n=a;break}}}else{n=e.type==BlockType.Text?e:undefined}if(!n)return;for(var s=0,l=r;s<l.length;s++){var c=l[s];c.line(t.view,n)}}),0);for(var n=0,i=r;n<i.length;n++){var o=i[n];o.finish()}this.dom.style.minHeight=this.view.contentHeight+"px";if(e.state.facet(unfixGutters)!=!this.fixed){this.fixed=!this.fixed;this.dom.style.position=this.fixed?"sticky":""}};e.prototype.updateGutters=function(e){var t=e.prevState.facet(activeGutters),r=e.state.facet(activeGutters);var n=e.docChanged||e.heightChanged||e.viewportChanged;if(t==r){for(var i=0,o=this.gutters;i<o.length;i++){var a=o[i];if(a.update(e))n=true}}else{n=true;var s=[];for(var l=0,c=r;l<c.length;l++){var u=c[l];var f=t.indexOf(u);if(f<0){s.push(new SingleGutterView(this.view,u))}else{this.gutters[f].update(e);s.push(this.gutters[f])}}for(var h=0,d=this.gutters;h<d.length;h++){var p=d[h];p.dom.remove()}for(var g=0,m=s;g<m.length;g++){var p=m[g];this.dom.appendChild(p.dom)}this.gutters=s}return n};e.prototype.destroy=function(){this.dom.remove()};return e}(),{provide:PluginField.scrollMargins.from((function(e){if(e.gutters.length==0||!e.fixed)return null;return e.view.textDirection==Direction.LTR?{left:e.dom.offsetWidth}:{right:e.dom.offsetWidth}}))});var UpdateContext=function(){function e(e,t){this.gutter=e;this.localMarkers=[];this.i=0;this.height=0;this.cursor=RangeSet.iter(Array.isArray(e.markers)?e.markers:[e.markers],t.from)}e.prototype.line=function(e,t){if(this.localMarkers.length)this.localMarkers=[];while(this.cursor.value&&this.cursor.from<=t.from){if(this.cursor.from==t.from)this.localMarkers.push(this.cursor.value);this.cursor.next()}var r=this.gutter.config.lineMarker(e,t,this.localMarkers);if(r)this.localMarkers.unshift(r);var n=this.gutter;if(this.localMarkers.length==0&&!n.config.renderEmptyElements)return;var i=t.top-this.height;if(this.i==n.elements.length){var o=new GutterElement(e,t.height,i,this.localMarkers,n.elementClass);n.elements.push(o);n.dom.appendChild(o.dom)}else{var a=this.localMarkers,s=n.elements[this.i];if(sameMarkers(a,s.markers)){a=s.markers;this.localMarkers.length=0}s.update(e,t.height,i,a,n.elementClass)}this.height=t.bottom;this.i++};e.prototype.finish=function(){var e=this.gutter;while(e.elements.length>this.i)e.dom.removeChild(e.elements.pop().dom)};return e}();var SingleGutterView=function(){function e(e,t){this.view=e;this.config=t;this.elements=[];this.spacer=null;this.dom=document.createElement("div");this.dom.className=themeClass("gutter"+(this.config.style?"."+this.config.style:""));this.elementClass=themeClass("gutterElement"+(this.config.style?"."+this.config.style:""));var r=function(r){n.dom.addEventListener(r,(function(n){var i=e.visualLineAtHeight(n.clientY,e.contentDOM.getBoundingClientRect().top);if(t.domEventHandlers[r](e,i,n))n.preventDefault()}))};var n=this;for(var i in t.domEventHandlers){r(i)}this.markers=t.markers(e.state);if(t.initialSpacer){this.spacer=new GutterElement(e,0,0,[t.initialSpacer(e)],this.elementClass);this.dom.appendChild(this.spacer.dom);this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none"}}e.prototype.update=function(e){var t=this.markers;this.markers=this.config.markers(e.state);if(this.spacer&&this.config.updateSpacer){var r=this.config.updateSpacer(this.spacer.markers[0],e);if(r!=this.spacer.markers[0])this.spacer.update(e.view,0,0,[r],this.elementClass)}return this.markers!=t};return e}();var GutterElement=function(){function e(e,t,r,n,i){this.height=-1;this.above=0;this.dom=document.createElement("div");this.update(e,t,r,n,i)}e.prototype.update=function(e,t,r,n,i){if(this.height!=t)this.dom.style.height=(this.height=t)+"px";if(this.above!=r)this.dom.style.marginTop=(this.above=r)?r+"px":"";if(this.markers!=n){this.markers=n;for(var o=void 0;o=this.dom.lastChild;)o.remove();var a=i;for(var s=0,l=n;s<l.length;s++){var c=l[s];var u=c.toDOM(e);if(u)this.dom.appendChild(u);var f=c.elementClass;if(f)a+=" "+f}this.dom.className=a}};return e}();function sameMarkers(e,t){if(e.length!=t.length)return false;for(var r=0;r<e.length;r++)if(!e[r].compare(t[r]))return false;return true}var lineNumberMarkers=Facet.define();var lineNumberConfig=Facet.define({combine:function(e){return combineConfig(e,{formatNumber:String,domEventHandlers:{}},{domEventHandlers:function(e,t){var r=Object.assign({},e);var n=function(e){var n=r[e],i=t[e];r[e]=n?function(e,t,r){return n(e,t,r)||i(e,t,r)}:i};for(var i in t){n(i)}return r}})}});var NumberMarker=function(e){__extends(t,e);function t(t){var r=e.call(this)||this;r.number=t;return r}t.prototype.eq=function(e){return this.number==e.number};t.prototype.toDOM=function(e){var t=e.state.facet(lineNumberConfig);return document.createTextNode(t.formatNumber(this.number))};return t}(GutterMarker);var lineNumberGutter=gutter({style:"lineNumber",markers:function(e){return e.facet(lineNumberMarkers)},lineMarker:function(e,t,r){if(r.length)return null;return new NumberMarker(e.state.doc.lineAt(t.from).number)},initialSpacer:function(e){return new NumberMarker(maxLineNumber(e.state.doc.lines))},updateSpacer:function(e,t){var r=maxLineNumber(t.view.state.doc.lines);return r==e.number?e:new NumberMarker(r)}});function lineNumbers(e){if(e===void 0){e={}}return[lineNumberConfig.of(e),lineNumberGutter]}function maxLineNumber(e){var t=9;while(t<e)t=t*10+9;return t}function mapRange(e,t){var r=t.mapPos(e.from,1),n=t.mapPos(e.to,-1);return r>=n?undefined:{from:r,to:n}}var foldEffect=StateEffect.define({map:mapRange});var unfoldEffect=StateEffect.define({map:mapRange});function selectedLines(e){var t=[];var r=function(r){if(t.some((function(e){return e.from<=r&&e.to>=r})))return"continue";t.push(e.visualLineAt(r))};for(var n=0,i=e.state.selection.ranges;n<i.length;n++){var o=i[n].head;r(o)}return t}var foldState=StateField.define({create:function(){return Decoration.none},update:function(e,t){e=e.map(t.changes);var r=function(t){if(t.is(foldEffect)&&!foldExists(e,t.value.from,t.value.to))e=e.update({add:[foldWidget.range(t.value.from,t.value.to)]});else if(t.is(unfoldEffect)){e=e.update({filter:function(e,r){return t.value.from!=e||t.value.to!=r},filterFrom:t.value.from,filterTo:t.value.to})}};for(var n=0,i=t.effects;n<i.length;n++){var o=i[n];r(o)}if(t.selection){var a=false,s=t.selection.primary.head;e.between(s,s,(function(e,t){if(e<s&&t>s)a=true}));if(a)e=e.update({filterFrom:s,filterTo:s,filter:function(e,t){return t<=s||e>=s}})}return e},provide:[EditorView.decorations]});function foldInside(e,t,r){var n;var i=null;(n=e.field(foldState,false))===null||n===void 0?void 0:n.between(t,r,(function(e,t){if(!i||i.from>e)i={from:e,to:t}}));return i}function foldExists(e,t,r){var n=false;e.between(t,t,(function(e,i){if(e==t&&i==r)n=true}));return n}function getFoldable(e,t,r){return e.facet(EditorState.foldable).reduce((function(n,i){return n||i(e,t,r)}),null)}function maybeEnable(e){return e.field(foldState,false)?undefined:{append:codeFolding()}}var foldCode=function(e){for(var t=0,r=selectedLines(e);t<r.length;t++){var n=r[t];var i=getFoldable(e.state,n.from,n.to);if(i){e.dispatch({effects:foldEffect.of(i),reconfigure:maybeEnable(e.state)});return true}}return false};var unfoldCode=function(e){if(!e.state.field(foldState,false))return false;var t=[];for(var r=0,n=selectedLines(e);r<n.length;r++){var i=n[r];var o=foldInside(e.state,i.from,i.to);if(o)t.push(unfoldEffect.of(o))}if(t.length)e.dispatch({effects:t});return t.length>0};var foldAll=function(e){var t=e.state,r=[];for(var n=0;n<t.doc.length;){var i=e.visualLineAt(n),o=getFoldable(t,i.from,i.to);if(o)r.push(foldEffect.of(o));n=(o?e.visualLineAt(o.to):i).to+1}if(r.length)e.dispatch({effects:r,reconfigure:maybeEnable(e.state)});return!!r.length};var unfoldAll=function(e){var t=e.state.field(foldState,false);if(!t||!t.size)return false;var r=[];t.between(0,e.state.doc.length,(function(e,t){r.push(unfoldEffect.of({from:e,to:t}))}));e.dispatch({effects:r});return true};var foldKeymap=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:foldCode},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:unfoldCode},{key:"Ctrl-Alt-[",run:foldAll},{key:"Ctrl-Alt-]",run:unfoldAll}];var defaultConfig={placeholderDOM:null,placeholderText:"…"};var foldConfig=Facet.define({combine:function(e){return combineConfig(e,defaultConfig)}});function codeFolding(e){var t=[foldState,baseTheme$5];if(e)t.push(foldConfig.of(e));return t}var foldWidget=Decoration.replace({widget:new(function(e){__extends(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.ignoreEvents=function(){return false};t.prototype.toDOM=function(e){var t=e.state,r=t.facet(foldConfig);if(r.placeholderDOM)return r.placeholderDOM();var n=document.createElement("span");n.textContent=r.placeholderText;n.setAttribute("aria-label",t.phrase("folded code"));n.title=t.phrase("unfold");n.className=themeClass("foldPlaceholder");n.onclick=function(t){var r=e.visualLineAt(e.posAtDOM(t.target));var n=foldInside(e.state,r.from,r.to);if(n)e.dispatch({effects:unfoldEffect.of(n)});t.preventDefault()};return n};return t}(WidgetType))});var foldGutterDefaults={openText:"⌄",closedText:"›"};var FoldMarker=function(e){__extends(t,e);function t(t,r){var n=e.call(this)||this;n.config=t;n.open=r;return n}t.prototype.eq=function(e){return this.config==e.config&&this.open==e.open};t.prototype.toDOM=function(e){var t=document.createElement("span");t.textContent=this.open?this.config.openText:this.config.closedText;t.title=e.state.phrase(this.open?"Fold line":"Unfold line");return t};return t}(GutterMarker);function foldGutter(e){if(e===void 0){e={}}var t=Object.assign(Object.assign({},foldGutterDefaults),e);var r=new FoldMarker(t,true),n=new FoldMarker(t,false);return[gutter({style:"foldGutter",lineMarker:function(e,t){var i=foldInside(e.state,t.from,t.to);if(i)return n;if(getFoldable(e.state,t.from,t.to))return r;return null},initialSpacer:function(){return new FoldMarker(t,false)},domEventHandlers:{click:function(e,t){var r=foldInside(e.state,t.from,t.to);if(r){e.dispatch({effects:unfoldEffect.of(r)});return true}var n=getFoldable(e.state,t.from,t.to);if(n){e.dispatch({effects:foldEffect.of(n)});return true}return false}}}),codeFolding()]}var baseTheme$5=EditorView.baseTheme({$foldPlaceholder:{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},"$gutterElement.foldGutter":{padding:"0 1px",cursor:"pointer"}});var TagSystem=function(){function e(e){var t=this;this.typeNames=[""];this.typeIDs=Object.create(null);this.prop=new NodeProp;this.flags=e.flags;this.types=e.types;this.flagMask=Math.pow(2,this.flags.length)-1;this.typeShift=this.flags.length;var r=e.subtypes||0;var n=[undefined];this.typeIDs[""]=0;var i=1;for(var o=0,a=e.types;o<a.length;o++){var s=a[o];var l=/^([\w\-]+)(?:=([\w-]+))?$/.exec(s);if(!l)throw new RangeError("Invalid type name "+s);var c=i++;this.typeNames[c]=l[1];this.typeIDs[l[1]]=c;n[c]=l[2];for(var u=0;u<r;u++){var f=i++,h=l[1]+"#"+(u+1);this.typeNames[f]=h;this.typeIDs[h]=f;n[f]=l[1]}}this.parents=n.map((function(e){if(e==null)return 0;var r=t.typeIDs[e];if(r==null)throw new RangeError("Unknown parent type '"+e+"' specified");return r}));if(this.flags.length>30||this.typeNames.length>Math.pow(2,30-this.flags.length))throw new RangeError("Too many style tag flags to fit in a 30-bit integer")}e.prototype.get=function(e){var t=0;for(var r=0,n=e.split(" ");r<n.length;r++){var i=n[r];if(i){var o=this.flags.indexOf(i);if(o>-1){t+=1<<o}else{var a=this.typeIDs[i];if(a==null)throw new RangeError("Unknown tag type '"+i+"'");if(t>>this.typeShift)throw new RangeError("Multiple tag types specified in '"+e+"'");t+=a<<this.typeShift}}}return t};e.prototype.getWithMode=function(e){var t=e[0]=="+"?1:e[0]=="!"?0:2;return{mode:t,tag:this.get(t==2?e:e.slice(1))}};e.prototype.addTagProp=function(e,t){if(t===void 0){t={}}var r=this.getWithMode(e),n=r.mode,i=r.tag;return this.prop.set(t,new Rule(i,n,noContext))};e.prototype.add=function(e){var t=Object.create(null);for(var r in e){var n=e[r];var i=this.getWithMode(n),o=i.mode,a=i.tag;for(var s=0,l=r.split(" ");s<l.length;s++){var c=l[s];var u=c.split("/"),f=u[u.length-1];var h=u.length>1?u.slice(0,u.length-1).map((function(e){return e=="*"?null:e})):noContext;var d=new Rule(a,o,h);t[f]=d.sort(t[f])}}return this.prop.add(t)};e.prototype.highlighter=function(e){var t=this;var r=new Styling(this,e);return[precedence(ViewPlugin.define((function(e){return new Highlighter(e,t.prop,r)}),{decorations:function(e){return e.decorations}}),"fallback"),EditorView.styleModule.of(r.module)]};e.prototype.specificity=function(e){var t=e&this.flagMask,r=0;for(var n=1;n<=this.flags.length;n++)if(t&1<<n)r++;for(var i=e>>this.typeShift;i;i=this.parents[i])r+=/#/.test(this.typeNames[i])?500:1e3;return r};return e}();var defaultTags=new TagSystem({flags:["invalid","meta","standard","definition","constant","local","control","link","strong","emphasis","monospace","changed","inserted","deleted"],subtypes:7,types:["comment","lineComment=comment","blockComment=comment","docComment=comment","name","variableName=name","typeName=name","propertyName=name","className=name","labelName=name","functionName=name","namespace=name","literal","string=literal","docString=string","character=string","number=literal","integer=number","float=number","bool=literal","regexp=literal","escape=literal","color=literal","content","heading=content","list=content","quote=content","keyword","self=keyword","null=keyword","atom=keyword","unit=keyword","modifier=keyword","operatorKeyword=keyword","operator","derefOperator=operator","arithmeticOperator=operator","logicOperator=operator","bitwiseOperator=operator","compareOperator=operator","updateOperator=operator","typeOperator=operator","punctuation","separator=punctuation","bracket=punctuation","angleBracket=bracket","squareBracket=bracket","paren=bracket","brace=bracket"]});var noContext=[];var Rule=function(){function e(e,t,r,n){this.tag=e;this.mode=t;this.context=r;this.next=n}e.prototype.sort=function(e){if(!e||e.context.length<this.context.length){this.next=e;return this}e.next=this.sort(e.next);return e};return e}();var styleTags=function(e){return defaultTags.add(e)};var highlighter=function(e){return defaultTags.highlighter(e)};var StyleRule=function(){function e(e,t,r,n){this.type=e;this.flags=t;this.specificity=r;this.cls=n}return e}();var Styling=function(){function e(e,t){this.tags=e;this.cache=Object.create(null);var r=Object.create(null);var n=[];for(var i in t){var o=StyleModule.newName();r["."+o]=t[i];for(var a=0,s=i.split(/\s*,\s*/);a<s.length;a++){var l=s[a];var c=e.get(l);n.push(new StyleRule(c>>e.typeShift,c&e.flagMask,e.specificity(c),o))}}this.rules=n.sort((function(e,t){return t.specificity-e.specificity}));this.module=new StyleModule(r)}e.prototype.match=function(e){var t=this.cache[e];if(t!=null)return t;var r="";var n=e>>this.tags.typeShift,i=e&this.tags.flagMask;for(;;){for(var o=0,a=this.rules;o<a.length;o++){var s=a[o];if(s.type==n&&(s.flags&i)==s.flags){if(r)r+=" ";r+=s.cls;i&=~s.flags;if(n)break}}if(n)n=this.tags.parents[n];else break}return this.cache[e]=r};return e}();var Highlighter=function(){function e(e,t,r){this.prop=t;this.styling=r;this.nodeStack=[""];this.classStack=[""];this.inheritStack=[""];this.tree=e.state.tree;this.decorations=this.buildDeco(e.visibleRanges,this.tree)}e.prototype.update=function(e){var t=e.state.facet(EditorState.syntax);if(!t.length){this.decorations=Decoration.none}else if(t[0].parsePos(e.state)<e.view.viewport.to){this.decorations=this.decorations.map(e.changes)}else if(this.tree!=t[0].getTree(e.state)||e.viewportChanged){this.tree=t[0].getTree(e.state);this.decorations=this.buildDeco(e.view.visibleRanges,this.tree)}};e.prototype.buildDeco=function(e,t){var r=this;var n=new RangeSetBuilder;var i,o,a;function s(e,t){if(e>i&&t)n.add(i,e,Decoration.mark({class:t}));i=e}var l=this,c=l.nodeStack,u=l.classStack,f=l.inheritStack;var h=function(e,n){o="";a=0;i=e;t.iterate({from:e,to:n,enter:function(e,t){a++;var n=f[a-1];var i=n;var l=e.prop(r.prop),h=false;while(l){if(!l.context.length||matchContext(l.context,c,a)){var d=r.styling.match(l.tag);if(d){if(i)i+=" ";i+=d;if(l.mode==1)n=i;else if(l.mode==0)h=true}break}l=l.next}if(i!=o){s(t,o);o=i}if(h){a--;return false}u[a]=i;f[a]=n;c[a]=e.name;return undefined},leave:function(e,t,r){a--;var i=u[a];if(i!=o){s(Math.min(n,r),o);o=i}}})};for(var d=0,p=e;d<p.length;d++){var g=p[d],m=g.from,v=g.to;h(m,v)}return n.finish()};return e}();function matchContext(e,t,r){if(e.length>r-1)return false;for(var n=r-1,i=e.length-1;i>=0;i--,n--){var o=e[i];if(o&&o!=t[n])return false}return true}var defaultHighlighter=highlighter({deleted:{textDecoration:"line-through"},inserted:{textDecoration:"underline"},link:{textDecoration:"underline"},strong:{fontWeight:"bold"},emphasis:{fontStyle:"italic"},keyword:{color:"#708"},"atom, bool":{color:"#219"},number:{color:"#164"},string:{color:"#a11"},"regexp, escape, string#2":{color:"#e40"},"variableName definition":{color:"#00f"},typeName:{color:"#085"},className:{color:"#167"},"name#2":{color:"#256"},"propertyName definition":{color:"#00c"},comment:{color:"#940"},meta:{color:"#555"},invalid:{color:"#f00"}});var fromHistory=Annotation.define();var isolateHistory=Annotation.define();var invertedEffects=Facet.define();var historyConfig=Facet.define({combine:function(e){return combineConfig(e,{minDepth:100,newGroupDelay:500},{minDepth:Math.max,newGroupDelay:Math.min})}});var historyField=StateField.define({create:function(){return HistoryState.empty},update:function(e,t){var r=t.state.facet(historyConfig);var n=t.annotation(fromHistory);if(n){var i=HistEvent.fromTransaction(t),o=n.side;var a=o==0?e.undone:e.done;if(i)a=updateBranch(a,a.length,r.minDepth,i);else a=addSelection(a,t.startState.selection);return new HistoryState(o==0?n.rest:a,o==0?a:n.rest)}var s=t.annotation(isolateHistory);if(s=="full"||s=="before")e=e.isolate();if(t.annotation(Transaction.addToHistory)===false)return t.changes.length?e.addMapping(t.changes.desc):e;var l=HistEvent.fromTransaction(t);var c=t.annotation(Transaction.time),u=t.annotation(Transaction.userEvent);if(l)e=e.addChanges(l,c,u,r.newGroupDelay,r.minDepth);else if(t.selection)e=e.addSelection(t.startState.selection,c,u,r.newGroupDelay);if(s=="full"||s=="after")e=e.isolate();return e}});function history(e){if(e===void 0){e={}}return[historyField,historyConfig.of(e)]}function cmd(e,t){return function(r){var n=r.state,i=r.dispatch;var o=n.field(historyField,false);if(!o)return false;var a=o.pop(e,n,t);if(!a)return false;i(a);return true}}var undo=cmd(0,false);var redo=cmd(1,false);var undoSelection=cmd(0,true);var redoSelection=cmd(1,true);var HistEvent=function(){function e(e,t,r,n,i){this.changes=e;this.effects=t;this.mapped=r;this.startSelection=n;this.selectionsAfter=i}e.prototype.setSelAfter=function(t){return new e(this.changes,this.effects,this.mapped,this.startSelection,t)};e.fromTransaction=function(t){var r=none$6;for(var n=0,i=t.startState.facet(invertedEffects);n<i.length;n++){var o=i[n];var a=o(t);if(a.length)r=r.concat(a)}if(!r.length&&t.changes.empty)return null;return new e(t.changes.invert(t.startState.doc),r,undefined,t.startState.selection,none$6)};e.selection=function(t){return new e(undefined,none$6,undefined,undefined,t)};return e}();function updateBranch(e,t,r,n){var i=t+1>r+20?t-r-1:0;var o=e.slice(i,t);o.push(n);return o}function isAdjacent(e,t){var r=[],n=false;e.iterChangedRanges((function(e,t){return r.push(e,t)}));t.iterChangedRanges((function(e,t,i,o){for(var a=0;a<r.length;){var s=r[a++],l=r[a++];if(o>=s&&i<=l)n=true}}));return n}function eqSelectionShape(e,t){return e.ranges.length==t.ranges.length&&e.ranges.filter((function(e,r){return e.empty!=t.ranges[r].empty})).length===0}function conc(e,t){return!e.length?t:!t.length?e:e.concat(t)}var none$6=[];var MaxSelectionsPerEvent=200;function addSelection(e,t){if(!e.length){return[HistEvent.selection([t])]}else{var r=e[e.length-1];var n=r.selectionsAfter.slice(Math.max(0,r.selectionsAfter.length-MaxSelectionsPerEvent));if(n.length&&n[n.length-1].eq(t))return e;n.push(t);return updateBranch(e,e.length-1,1e9,r.setSelAfter(n))}}function popSelection(e){var t=e[e.length-1];var r=e.slice();r[e.length-1]=t.setSelAfter(t.selectionsAfter.slice(0,t.selectionsAfter.length-1));return r}function addMappingToBranch(e,t){if(!e.length)return e;var r=e.length,n=none$6;while(r){var i=mapEvent(e[r-1],t,n);if(i.changes&&!i.changes.empty||i.effects.length){var o=e.slice(0,r);o[r-1]=i;return o}else{t=i.mapped;r--;n=i.selectionsAfter}}return n.length?[HistEvent.selection(n)]:none$6}function mapEvent(e,t,r){var n=conc(e.selectionsAfter.length?e.selectionsAfter.map((function(e){return e.map(t)})):none$6,r);if(!e.changes)return HistEvent.selection(n);var i=e.changes.map(t),o=t.mapDesc(e.changes,true);var a=e.mapped?e.mapped.composeDesc(o):o;return new HistEvent(i,StateEffect.mapEffects(e.effects,t),a,e.startSelection.map(o),n)}var HistoryState=function(){function e(e,t,r,n){if(r===void 0){r=0}if(n===void 0){n=undefined}this.done=e;this.undone=t;this.prevTime=r;this.prevUserEvent=n}e.prototype.isolate=function(){return this.prevTime?new e(this.done,this.undone):this};e.prototype.addChanges=function(t,r,n,i,o){var a=this.done,s=a[a.length-1];if(s&&s.changes&&r-this.prevTime<i&&!s.selectionsAfter.length&&s.changes.length&&t.changes&&isAdjacent(s.changes,t.changes)){a=updateBranch(a,a.length-1,o,new HistEvent(t.changes.compose(s.changes),conc(t.effects,s.effects),s.mapped,s.startSelection,none$6))}else{a=updateBranch(a,a.length,o,t)}return new e(a,none$6,r,n)};e.prototype.addSelection=function(t,r,n,i){var o=this.done.length?this.done[this.done.length-1].selectionsAfter:none$6;if(o.length>0&&r-this.prevTime<i&&n=="keyboardselection"&&this.prevUserEvent==n&&eqSelectionShape(o[o.length-1],t))return this;return new e(addSelection(this.done,t),this.undone,r,n)};e.prototype.addMapping=function(t){return new e(addMappingToBranch(this.done,t),addMappingToBranch(this.undone,t),this.prevTime,this.prevUserEvent)};e.prototype.pop=function(e,t,r){var n=e==0?this.done:this.undone;if(n.length==0)return null;var i=n[n.length-1];if(r&&i.selectionsAfter.length){return t.update({selection:i.selectionsAfter[i.selectionsAfter.length-1],annotations:fromHistory.of({side:e,rest:popSelection(n)})})}else if(!i.changes){return null}else{var o=n.length==1?none$6:n.slice(0,n.length-1);if(i.mapped)o=addMappingToBranch(o,i.mapped);return t.update({changes:i.changes,selection:i.startSelection,effects:i.effects,annotations:fromHistory.of({side:e,rest:o}),filter:false})}};return e}();HistoryState.empty=new HistoryState(none$6,none$6);var historyKeymap=[{key:"Mod-z",run:undo,preventDefault:true},{key:"Mod-y",mac:"Mod-Shift-z",run:redo,preventDefault:true},{key:"Mod-u",run:undoSelection,preventDefault:true},{key:"Alt-u",mac:"Mod-Shift-u",run:redoSelection,preventDefault:true}];
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var extendStatics=function(e,t){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r))e[r]=t[r]};return extendStatics(e,t)};function __extends(e,t){extendStatics(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Stack=function(){function e(e,t,r,n,i,o,a,s,l){this.cx=e;this.stack=t;this.state=r;this.reducePos=n;this.pos=i;this.score=o;this.buffer=a;this.bufferBase=s;this.parent=l}e.prototype.toString=function(){return"["+this.stack.filter((function(e,t){return t%3==0})).concat(this.state)+"]@"+this.pos+(this.score?"!"+this.score:"")};e.start=function(t,r,n){if(n===void 0){n=0}return new e(t,[],r,n,n,0,[],0,null)};e.prototype.pushState=function(e,t){this.stack.push(this.state,t,this.bufferBase+this.buffer.length);this.state=e};e.prototype.reduce=function(e){var t=e>>19,r=e&65535;var n=this.cx.parser;var i=n.dynamicPrecedence(r);if(i)this.score+=i;if(t==0){if(r<n.minRepeatTerm)this.storeNode(r,this.reducePos,this.reducePos,4,true);this.pushState(n.getGoto(this.state,r,true),this.reducePos);return}var o=this.stack.length-(t-1)*3-(e&262144?6:0);var a=this.stack[o-2];var s=this.stack[o-1],l=this.bufferBase+this.buffer.length-s;if(r<n.minRepeatTerm||e&131072){var c=n.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(r,a,c,l+4,true)}if(e&262144){this.state=this.stack[o]}else{var u=this.stack[o-3];this.state=n.getGoto(u,r,true)}while(this.stack.length>o)this.stack.pop()};e.prototype.storeNode=function(e,t,r,n,i){if(n===void 0){n=4}if(i===void 0){i=false}if(e==0){var o=this,a=this.buffer.length;if(a==0&&o.parent){a=o.bufferBase-o.parent.bufferBase;o=o.parent}if(a>0&&o.buffer[a-4]==0&&o.buffer[a-1]>-1){if(t==r)return;if(o.buffer[a-2]>=t){o.buffer[a-2]=r;return}}}if(!i||this.pos==r){this.buffer.push(e,t,r,n)}else{var s=this.buffer.length;if(s>0&&this.buffer[s-4]!=0)while(s>0&&this.buffer[s-2]>r){this.buffer[s]=this.buffer[s-4];this.buffer[s+1]=this.buffer[s-3];this.buffer[s+2]=this.buffer[s-2];this.buffer[s+3]=this.buffer[s-1];s-=4;if(n>4)n-=4}this.buffer[s]=e;this.buffer[s+1]=t;this.buffer[s+2]=r;this.buffer[s+3]=n}};e.prototype.shift=function(e,t,r){if(e&131072){this.pushState(e&65535,this.pos)}else if((e&262144)==0){var n=this.pos,i=e,o=this.cx.parser;if(r>this.pos||t<=o.maxNode){this.pos=r;if(!o.stateFlag(i,1))this.reducePos=r}this.pushState(i,n);if(t<=o.maxNode)this.buffer.push(t,n,r,4)}else{if(t<=this.cx.parser.maxNode)this.buffer.push(t,this.pos,r,4);this.pos=r}};e.prototype.apply=function(e,t,r){if(e&65536)this.reduce(e);else this.shift(e,t,r)};e.prototype.useNode=function(e,t){var r=this.cx.reused.length-1;if(r<0||this.cx.reused[r]!=e){this.cx.reused.push(e);r++}var n=this.pos;this.reducePos=this.pos=n+e.length;this.pushState(t,n);this.buffer.push(r,n,this.reducePos,-1)};e.prototype.split=function(){var t=this;var r=t.buffer.length;while(r>0&&t.buffer[r-2]>t.reducePos)r-=4;var n=t.buffer.slice(r),i=t.bufferBase+r;while(t&&i==t.bufferBase)t=t.parent;return new e(this.cx,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,n,i,t)};e.prototype.recoverByDelete=function(e,t){var r=e<=this.cx.parser.maxNode;if(r)this.storeNode(e,this.pos,t);this.storeNode(0,this.pos,t,r?8:4);this.pos=this.reducePos=t;this.score-=200};e.prototype.canShift=function(e){for(var t=new SimulatedStack(this);;){var r=this.cx.parser.stateSlot(t.top,4)||this.cx.parser.hasAction(t.top,e);if((r&65536)==0)return true;if(r==0)return false;t.reduce(r)}};Object.defineProperty(e.prototype,"ruleStart",{get:function(){for(var e=this.state,t=this.stack.length;;){var r=this.cx.parser.stateSlot(e,5);if(!(r&65536))return 0;t-=3*(r>>19);if((r&65535)<this.cx.parser.minRepeatTerm)return this.stack[t+1];e=this.stack[t]}},enumerable:true,configurable:true});e.prototype.startOf=function(e,t){var r=this.state,n=this.stack.length,i=this.cx.parser;for(;;){var o=i.stateSlot(r,5);var a=o>>19,s=o&65535;if(e.indexOf(s)>-1){var l=n-3*(o>>19),c=this.stack[l+1];if(t==null||t>c)return c}if(n==0)return null;if(a==0){n-=3;r=this.stack[n]}else{n-=3*(a-1);r=i.getGoto(this.stack[n-3],s,true)}}};e.prototype.recoverByInsert=function(e){var t=this;if(this.stack.length>=300)return[];var r=this.cx.parser.nextStates(this.state);if(r.length>4||this.stack.length>=120){var n=r.filter((function(r){return r!=t.state&&t.cx.parser.hasAction(r,e)}));if(this.stack.length<120)for(var i=0;n.length<4&&i<r.length;i++)if(n.indexOf(r[i])<0)n.push(r[i]);r=n}var o=[];for(var i=0;i<r.length&&o.length<4;i++){if(r[i]==this.state)continue;var a=this.split();a.storeNode(0,a.pos,a.pos,4,true);a.pushState(r[i],this.pos);a.score-=200;o.push(a)}return o};e.prototype.forceReduce=function(){var e=this.cx.parser.stateSlot(this.state,5);if((e&65536)==0)return false;if(!this.cx.parser.validAction(this.state,e)){this.storeNode(0,this.reducePos,this.reducePos,4,true);this.score-=100}this.reduce(e);return true};e.prototype.forceAll=function(){while(!this.cx.parser.stateFlag(this.state,2)&&this.forceReduce()){}return this};Object.defineProperty(e.prototype,"deadEnd",{get:function(){if(this.stack.length!=3)return false;var e=this.cx.parser;return e.data[e.stateSlot(this.state,1)]==65535&&!e.stateSlot(this.state,4)},enumerable:true,configurable:true});e.prototype.restart=function(){this.state=this.stack[0];this.stack.length=0};e.prototype.sameState=function(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return false;for(var t=0;t<this.stack.length;t+=3)if(this.stack[t]!=e.stack[t])return false;return true};e.prototype.toTree=function(){return Tree.build({buffer:StackBufferCursor.create(this),group:this.cx.parser.group,topID:this.cx.topTerm,maxBufferLength:this.cx.maxBufferLength,reused:this.cx.reused,minRepeatType:this.cx.parser.minRepeatTerm})};Object.defineProperty(e.prototype,"parser",{get:function(){return this.cx.parser},enumerable:true,configurable:true});e.prototype.dialectEnabled=function(e){return this.cx.dialect.flags[e]};return e}();var Recover;(function(e){e[e["Token"]=200]="Token";e[e["Reduce"]=100]="Reduce";e[e["MaxNext"]=4]="MaxNext";e[e["MaxInsertStackDepth"]=300]="MaxInsertStackDepth";e[e["DampenInsertStackDepth"]=120]="DampenInsertStackDepth"})(Recover||(Recover={}));var SimulatedStack=function(){function e(e){this.stack=e;this.top=e.state;this.rest=e.stack;this.offset=this.rest.length}e.prototype.reduce=function(e){var t=e&65535,r=e>>19;if(r==0){if(this.rest==this.stack.stack)this.rest=this.rest.slice();this.rest.push(this.top,0,0);this.offset+=3}else{this.offset-=(r-1)*3}var n=this.stack.cx.parser.getGoto(this.rest[this.offset-3],t,true);this.top=n};return e}();var StackBufferCursor=function(){function e(e,t,r){this.stack=e;this.pos=t;this.index=r;this.buffer=e.buffer;if(this.index==0)this.maybeNext()}e.create=function(t){return new e(t,t.bufferBase+t.buffer.length,t.buffer.length)};e.prototype.maybeNext=function(){var e=this.stack.parent;if(e!=null){this.index=this.stack.bufferBase-e.bufferBase;this.stack=e;this.buffer=e.buffer}};Object.defineProperty(e.prototype,"id",{get:function(){return this.buffer[this.index-4]},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"start",{get:function(){return this.buffer[this.index-3]},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"end",{get:function(){return this.buffer[this.index-2]},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"size",{get:function(){return this.buffer[this.index-1]},enumerable:true,configurable:true});e.prototype.next=function(){this.index-=4;this.pos-=4;if(this.index==0)this.maybeNext()};e.prototype.fork=function(){return new e(this.stack,this.pos,this.index)};return e}();var Token=function(){function e(){this.start=-1;this.value=-1;this.end=-1}e.prototype.accept=function(e,t){this.value=e;this.end=t};return e}();var StringStream=function(){function e(e,t){if(t===void 0){t=e.length}this.string=e;this.length=t}e.prototype.get=function(e){return e<0||e>=this.length?-1:this.string.charCodeAt(e)};e.prototype.read=function(e,t){return this.string.slice(e,Math.min(this.length,t))};e.prototype.clip=function(t){return new e(this.string,t)};return e}();var TokenGroup=function(){function e(e,t){this.data=e;this.id=t}e.prototype.token=function(e,t,r){readToken(this.data,e,t,r,this.id)};return e}();TokenGroup.prototype.contextual=TokenGroup.prototype.fallback=TokenGroup.prototype.extend=false;var ExternalTokenizer=function(){function e(e,t){if(t===void 0){t={}}this.token=e;this.contextual=!!t.contextual;this.fallback=!!t.fallback;this.extend=!!t.extend}return e}();function readToken(e,t,r,n,i){var o=0,a=1<<i,s=n.cx.dialect;e:for(var l=r.start;;){if((a&e[o])==0)break;var c=e[o+1];for(var u=o+3;u<c;u+=2)if((e[u+1]&a)>0){var f=e[u];if(s.allows(f)&&(r.value==-1||r.value==f||n.cx.parser.overrides(f,r.value))){r.accept(f,l);break}}var h=t.get(l++);for(var d=0,p=e[o+2];d<p;){var g=d+p>>1;var m=c+g+(g<<1);var v=e[m],O=e[m+1];if(h<v)p=g;else if(h>=O)d=g+1;else{o=e[m+2];continue e}}break}}function decodeArray(e,t){if(t===void 0){t=Uint16Array}if(typeof e!="string")return e;var r=null;for(var n=0,i=0;n<e.length;){var o=0;for(;;){var a=e.charCodeAt(n++),s=false;if(a==126){o=65535;break}if(a>=92)a--;if(a>=34)a--;var l=a-32;if(l>=46){l-=46;s=true}o+=l;if(s)break;o*=46}if(r)r[i++]=o;else r=new t(o)}return r}var verbose=typeof process!="undefined"&&/\bparse\b/.test(process.env.LOG);var stackIDs=null;var CacheCursor=function(){function e(e){this.start=[0];this.index=[0];this.nextStart=0;this.trees=[e]}e.prototype.nodeAt=function(e){if(e<this.nextStart)return null;for(;;){var t=this.trees.length-1;if(t<0){this.nextStart=1e9;return null}var r=this.trees[t],n=this.index[t];if(n==r.children.length){this.trees.pop();this.start.pop();this.index.pop();continue}var i=r.children[n];var o=this.start[t]+r.positions[n];if(o>=e)return o==e?i:null;if(i instanceof TreeBuffer){this.index[t]++;this.nextStart=o+i.length}else{this.index[t]++;if(o+i.length>=e){this.trees.push(i);this.start.push(o);this.index.push(0)}}}};return e}();var CachedToken=function(e){__extends(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.extended=-1;t.mask=0;return t}t.prototype.clear=function(e){this.start=e;this.value=this.extended=-1};return t}(Token);var dummyToken=new Token;var TokenCache=function(){function e(e){this.tokens=[];this.mainToken=dummyToken;this.actions=[];this.tokens=e.tokenizers.map((function(e){return new CachedToken}))}e.prototype.getActions=function(e,t){var r=0;var n=null;var i=e.cx.parser,o=i.tokenizers;var a=i.stateSlot(e.state,3);for(var s=0;s<o.length;s++){if((1<<s&a)==0)continue;var l=o[s],c=this.tokens[s];if(n&&!l.fallback)continue;if(l.contextual||c.start!=e.pos||c.mask!=a){this.updateCachedToken(c,l,e,t);c.mask=a}if(c.value!=0){var u=r;if(c.extended>-1)r=this.addActions(e,c.extended,c.end,r);r=this.addActions(e,c.value,c.end,r);if(!l.extend){n=c;if(r>u)break}}}while(this.actions.length>r)this.actions.pop();if(!n){n=dummyToken;n.start=e.pos;if(e.pos==t.length)n.accept(e.cx.parser.eofTerm,e.pos);else n.accept(0,e.pos+1)}this.mainToken=n;return this.actions};e.prototype.updateCachedToken=function(e,t,r,n){e.clear(r.pos);t.token(n,e,r);if(e.value>-1){var i=r.cx.parser;for(var o=0;o<i.specialized.length;o++)if(i.specialized[o]==e.value){var a=i.specializers[o](n.read(e.start,e.end),r);if(a>=0&&r.cx.dialect.allows(a>>1)){if((a&1)==0)e.value=a>>1;else e.extended=a>>1;break}}}else if(r.pos==n.length){e.accept(r.cx.parser.eofTerm,r.pos)}else{e.accept(0,r.pos+1)}};e.prototype.putAction=function(e,t,r,n){for(var i=0;i<n;i+=3)if(this.actions[i]==e)return n;this.actions[n++]=e;this.actions[n++]=t;this.actions[n++]=r;return n};e.prototype.addActions=function(e,t,r,n){var i=e.state,o=e.cx.parser,a=o.data;for(var s=0;s<2;s++){for(var l=o.stateSlot(i,s?2:1);;l+=3){if(a[l]==65535){if(a[l+1]==1){l=pair(a,l+2)}else{if(n==0&&a[l+1]==2)n=this.putAction(pair(a,l+1),t,r,n);break}}if(a[l]==t)n=this.putAction(pair(a,l+1),t,r,n)}}return n};return e}();var StackContext=function(){function e(e,t,r,n,i,o,a){if(o===void 0){o=null}if(a===void 0){a=-1}this.parser=e;this.maxBufferLength=t;this.input=r;this.topTerm=n;this.dialect=i;this.parent=o;this.wrapType=a;this.reused=[];this.tokens=new TokenCache(e)}return e}();var recoverDist=5,maxRemainingPerStep=3,minBufferLengthPrune=200,forceReduceLimit=10;var ParseContext=function(){function e(e,t,r){if(r===void 0){r={}}this.pos=0;this.recovering=0;this.tokenCount=0;this.nextStackID=9812;var n=r.cache,i=n===void 0?undefined:n,o=r.strict,a=o===void 0?false:o,s=r.bufferLength,l=s===void 0?DefaultBufferLength:s,c=r.top,u=c===void 0?undefined:c,f=r.dialect;var h=u?e.topRules[u]:e.defaultTop;if(!h)throw new RangeError("Invalid top rule name "+u);this.stacks=[Stack.start(new StackContext(e,l,t,h[1],e.parseDialect(f)),h[0])];this.strict=a;this.cache=i?new CacheCursor(i):null}e.prototype.putStack=function(e){this.stacks.push(e);if(this.pos<0||e.pos<this.pos)this.pos=e.pos};e.prototype.putStackDedup=function(e){for(var t=0;t<this.stacks.length;t++){var r=this.stacks[t];if(r.pos==e.pos&&r.sameState(e)){if(this.stacks[t].score<e.score)this.stacks[t]=e;return}}this.putStack(e)};e.prototype.advance=function(){var e=this.stacks,t=this.pos;this.stacks=[];this.pos=-1;var r=null,n=null;for(var i=0;i<e.length;i++){var o=e[i];for(;;){if(o.pos>t){this.putStack(o)}else{var a=this.advanceStack(o,e);if(a){o=a;continue}else{if(!r){r=[];n=[]}r.push(o);var s=o.cx.tokens.mainToken;n.push(s.value,s.end)}}break}}if(!this.stacks.length){var l=r&&findFinished(r);if(l)return l.toTree();if(this.strict){if(verbose&&r)console.log("Stuck with token "+r[0].cx.parser.getName(r[0].cx.tokens.mainToken.value));throw new SyntaxError("No parse at "+t)}if(!this.recovering)this.recovering=recoverDist}if(this.recovering&&r){var l=this.runRecovery(r,n);if(l)return l.forceAll().toTree()}if(this.recovering){var c=this.recovering==1?1:this.recovering*maxRemainingPerStep;if(this.stacks.length>c){this.stacks.sort((function(e,t){return t.score-e.score}));this.stacks.length=c}if(this.stacks.some((function(e){return e.reducePos>t})))this.recovering--}else if(this.stacks.length>1){e:for(var i=0;i<this.stacks.length-1;i++){var o=this.stacks[i];for(var u=i+1;u<this.stacks.length;u++){var f=this.stacks[u];if(o.sameState(f)||o.buffer.length>minBufferLengthPrune&&f.buffer.length>minBufferLengthPrune){if((o.score-f.score||o.buffer.length-f.buffer.length)>0){this.stacks.splice(u--,1)}else{this.stacks.splice(i--,1);continue e}}}}}this.tokenCount++;return null};e.prototype.advanceStack=function(e,t){var r=e.pos,n=e.cx,i=n.input,o=n.parser;var a=verbose?this.stackID(e)+" -> ":"";if(this.cache){for(var s=this.cache.nodeAt(r);s;){var l=o.group.types[s.type.id]==s.type?o.getGoto(e.state,s.type.id):-1;if(l>-1){e.useNode(s,l);if(verbose)console.log(a+this.stackID(e)+(" (via reuse of "+o.getName(s.type.id)+")"));return e}if(!(s instanceof Tree)||s.children.length==0||s.positions[0]>0)break;var c=s.children[0];if(c instanceof Tree)s=c;else break}}var u=o.startNested(e.state);e:if(u>-1){var f=o.nested[u],h=f.grammar,d=f.end,p=f.placeholder;var g=undefined,m=null,v=void 0,O=void 0,y=void 0,b=undefined;if(typeof h=="function"){var S=h(i,e);if(S.stay)break e;m=S.parseNode,v=S.parser,O=S.top,y=S.dialect,g=S.filterEnd,b=S.wrapType}else{v=h}var w=this.scanForNestEnd(e,d,g);var x=e.cx.input.clip(w);if(m||!v){var k=m?m(x,e.pos):Tree.empty;if(k.length!=w-e.pos)k=new Tree(k.type,k.children,k.positions,w-e.pos);if(b!=null)k=new Tree(o.group.types[b],[k],[0],k.length);e.useNode(k,o.getGoto(e.state,p,true));return e}else{var P=O?v.topRules[O]:v.defaultTop;var C=Stack.start(new StackContext(v,e.cx.maxBufferLength,x,P[1],v.parseDialect(y),e,b),P[0],e.pos);if(verbose)console.log(a+this.stackID(C)+" (nested)");return C}}var Q=o.stateSlot(e.state,4);if(Q>0){e.reduce(Q);if(verbose)console.log(a+this.stackID(e)+(" (via always-reduce "+o.getName(Q&65535)+")"));return e}var L=e.cx.tokens.getActions(e,i);for(var T=0;T<L.length;){var R=L[T++],$=L[T++],w=L[T++];var A=T==L.length||!t;var M=A?e:e.split();M.apply(R,$,w);if(verbose)console.log(a+this.stackID(M)+(" (via "+((R&65536)==0?"shift":"reduce of "+o.getName(R&65535))+" for "+o.getName($)+" @ "+r+(M==e?"":", split")+")"));if(A)return M;else if(M.pos>r)this.putStack(M);else t.push(M)}if(e.cx.parent&&e.pos==i.length)return this.finishNested(e);return null};e.prototype.advanceFully=function(e){var t=e.pos;for(;;){var r=this.advanceStack(e,null);if(!r)return e;if(r.pos>t){this.putStackDedup(r);return null}e=r}};e.prototype.runRecovery=function(e,t){var r=null,n=false;for(var i=0;i<e.length;i++){var o=e[i],a=t[i<<1],s=t[(i<<1)+1];var l=verbose?this.stackID(o)+" -> ":"";if(o.deadEnd){if(n)continue;n=true;o.restart();if(verbose)console.log(l+this.stackID(o)+" (restarted)");var c=this.advanceFully(o);if(c)o=c;else continue}var u=o.split(),f=l;for(var h=0;u.forceReduce()&&h<forceReduceLimit;h++){if(verbose)console.log(f+this.stackID(u)+" (via force-reduce)");var c=this.advanceFully(u);if(!c)break;u=c;if(verbose)f=this.stackID(c)+" -> "}for(var d=0,p=o.recoverByInsert(a);d<p.length;d++){var g=p[d];if(verbose)console.log(l+this.stackID(g)+" (via recover-insert)");this.advanceFully(g)}if(o.cx.input.length>o.pos){if(s==o.pos){s++;a=0}o.recoverByDelete(a,s);if(verbose)console.log(l+this.stackID(o)+(" (via recover-delete "+o.cx.parser.getName(a)+")"));this.putStackDedup(o)}else if(!o.cx.parent&&(!r||r.score<o.score)){r=o}}return r};e.prototype.forceFinish=function(){return this.stacks[0].split().forceAll().toTree()};Object.defineProperty(e.prototype,"badness",{get:function(){if(!this.stacks.length)return 0;return-(this.stacks[0].score/(200*this.tokenCount))},enumerable:true,configurable:true});e.prototype.scanForNestEnd=function(e,t,r){var n=e.cx.input;for(var i=e.pos;i<n.length;i++){dummyToken.start=i;dummyToken.value=-1;t.token(n,dummyToken,e);if(dummyToken.value>-1&&(!r||r(n.read(i,dummyToken.end))))return i}return n.length};e.prototype.finishNested=function(e){if(e.cx.wrapType==-2)return null;var t=e.cx.parent,r=e.forceAll().toTree();var n=t.cx.parser,i=n.nested[n.startNested(t.state)];r=new Tree(r.type,r.children,r.positions.map((function(e){return e-t.pos})),e.pos-t.pos);if(e.cx.wrapType>-1)r=new Tree(n.group.types[e.cx.wrapType],[r],[0],r.length);e.cx.wrapType=-2;t.useNode(r,n.getGoto(t.state,i.placeholder,true));if(verbose)console.log(this.stackID(t)+(" (via unnest "+(e.cx.wrapType>-1?n.getName(e.cx.wrapType):r.type.name)+")"));return t};e.prototype.stackID=function(e){var t=(stackIDs||(stackIDs=new WeakMap)).get(e);if(!t)stackIDs.set(e,t=String.fromCodePoint(this.nextStackID++));return t+e};return e}();var Dialect=function(){function e(e,t,r){this.source=e;this.flags=t;this.disabled=r}e.prototype.allows=function(e){return!this.disabled||this.disabled[e]==0};return e}();var Parser=function(){function e(e){var t=this;this.nextStateCache=[];this.cachedDialect=null;if(e.version!=12)throw new RangeError("Parser version ("+e.version+") doesn't match runtime version ("+12+")");var r=decodeArray(e.tokenData);var n=e.nodeNames.split(" ");this.minRepeatTerm=n.length;for(var i=0;i<e.repeatNodeCount;i++)n.push("");var o=[];for(var i=0;i<n.length;i++)o.push(noProps);function a(e,t,r){if(o[e]==noProps)o[e]=Object.create(null);t.set(o[e],t.deserialize(String(r)))}if(e.nodeProps)for(var s=0,l=e.nodeProps;s<l.length;s++){var c=l[s];var u=c[0];for(var i=1;i<c.length;){var f=c[i++];if(f>=0){a(f,u,c[i++])}else{var h=c[i+-f];for(var d=-f;d>0;d--)a(c[i++],u,h);i++}}}this.specialized=new Uint16Array(e.specialized?e.specialized.length:0);this.specializers=[];if(e.specialized)for(var i=0;i<e.specialized.length;i++){this.specialized[i]=e.specialized[i].term;this.specializers[i]=e.specialized[i].get}this.states=decodeArray(e.states,Uint32Array);this.data=decodeArray(e.stateData);this.goto=decodeArray(e.goto);var p=Object.keys(e.topRules).map((function(t){return e.topRules[t][1]}));this.group=new NodeGroup(n.map((function(r,n){var i=(n>=t.minRepeatTerm?8:0)|(p.indexOf(n)>-1?1:0)|(n==0?4:0)|(e.skippedNodes&&e.skippedNodes.indexOf(n)>-1?2:0);return new NodeType(r,o[n],n,i)})));this.maxTerm=e.maxTerm;this.tokenizers=e.tokenizers.map((function(e){return typeof e=="number"?new TokenGroup(r,e):e}));this.topRules=e.topRules;this.nested=(e.nested||[]).map((function(e){var t=e[0],r=e[1],n=e[2],i=e[3];return{name:t,grammar:r,end:new TokenGroup(decodeArray(n),0),placeholder:i}}));this.dialects=e.dialects||{};this.dynamicPrecedences=e.dynamicPrecedences||null;this.tokenPrecTable=e.tokenPrec;this.termNames=e.termNames||null;this.maxNode=this.group.types.length-1;for(var i=0,g=this.states.length/6;i<g;i++)this.nextStateCache[i]=null}e.prototype.parse=function(e,t){if(typeof e=="string")e=new StringStream(e);var r=new ParseContext(this,e,t);for(;;){var n=r.advance();if(n)return n}};e.prototype.startParse=function(e,t){if(typeof e=="string")e=new StringStream(e);return new ParseContext(this,e,t)};e.prototype.getGoto=function(e,t,r){if(r===void 0){r=false}var n=this.goto;if(t>=n[0])return-1;for(var i=n[t+1];;){var o=n[i++],a=o&1;var s=n[i++];if(a&&r)return s;for(var l=i+(o>>1);i<l;i++)if(n[i]==e)return s;if(a)return-1}};e.prototype.hasAction=function(e,t){var r=this.data;for(var n=0;n<2;n++){for(var i=this.stateSlot(e,n?2:1),o=void 0;;i+=3){if((o=r[i])==65535){if(r[i+1]==1)o=r[i=pair(r,i+2)];else if(r[i+1]==2)return pair(r,i+2);else break}if(o==t||o==0)return pair(r,i+1)}}return 0};e.prototype.stateSlot=function(e,t){return this.states[e*6+t]};e.prototype.stateFlag=function(e,t){return(this.stateSlot(e,0)&t)>0};e.prototype.startNested=function(e){var t=this.stateSlot(e,0);return t&4?t>>10:-1};e.prototype.validAction=function(e,t){if(t==this.stateSlot(e,4))return true;for(var r=this.stateSlot(e,1);;r+=3){if(this.data[r]==65535){if(this.data[r+1]==1)r=pair(this.data,r+2);else return false}if(t==pair(this.data,r+1))return true}};e.prototype.nextStates=function(e){var t=this.nextStateCache[e];if(t)return t;var r=[];for(var n=this.stateSlot(e,1);;n+=3){if(this.data[n]==65535){if(this.data[n+1]==1)n=pair(this.data,n+2);else break}if((this.data[n+2]&65536>>16)==0&&r.indexOf(this.data[n+1])<0)r.push(this.data[n+1])}var i=this.goto,o=i[0];for(var a=0;a<o;a++){for(var s=i[a+1];;){var l=i[s++],c=i[s++];for(var u=s+(l>>1);s<u;s++)if(i[s]==e&&r.indexOf(c)<0)r.push(c);if(l&1)break}}return this.nextStateCache[e]=r};e.prototype.overrides=function(e,t){var r=findOffset(this.data,this.tokenPrecTable,t);return r<0||findOffset(this.data,this.tokenPrecTable,e)<r};e.prototype.withNested=function(e){return this.copy({nested:this.nested.map((function(t){if(!Object.prototype.hasOwnProperty.call(e,t.name))return t;return{name:t.name,grammar:e[t.name],end:t.end,placeholder:t.placeholder}}))})};e.prototype.withProps=function(){var e;var t=[];for(var r=0;r<arguments.length;r++){t[r]=arguments[r]}return this.copy({group:(e=this.group).extend.apply(e,t)})};e.prototype.withTokenizer=function(e,t){return this.copy({tokenizers:this.tokenizers.map((function(r){return r==e?t:r}))})};e.prototype.copy=function(t){var r=Object.create(e.prototype);for(var n=0,i=Object.keys(this);n<i.length;n++){var o=i[n];r[o]=o in t?t[o]:this[o]}return r};e.prototype.getName=function(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.group.types[e].name||e)};Object.defineProperty(e.prototype,"eofTerm",{get:function(){return this.maxNode+1},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"hasNested",{get:function(){return this.nested.length>0},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"defaultTop",{get:function(){return this.topRules[Object.keys(this.topRules)[0]]},enumerable:true,configurable:true});e.prototype.dynamicPrecedence=function(e){var t=this.dynamicPrecedences;return t==null?0:t[e]||0};Object.defineProperty(e.prototype,"topType",{get:function(){return this.group.types[this.defaultTop[1]]},enumerable:true,configurable:true});e.prototype.parseDialect=function(e){if(this.cachedDialect&&this.cachedDialect.source==e)return this.cachedDialect;var t=Object.keys(this.dialects),r=t.map((function(){return false}));if(e)for(var n=0,i=e.split(" ");n<i.length;n++){var o=i[n];var a=t.indexOf(o);if(a>=0)r[a]=true}var s=null;for(var l=0;l<t.length;l++)if(!r[l]){for(var c=this.dialects[t[l]],a=void 0;(a=this.data[c++])!=65535;)(s||(s=new Uint8Array(this.maxTerm+1)))[a]=1}return this.cachedDialect=new Dialect(e,r,s)};e.deserialize=function(t){return new e(t)};return e}();function pair(e,t){return e[t]|e[t+1]<<16}Parser.TokenGroup=TokenGroup;var noProps=Object.create(null);function findOffset(e,t,r){for(var n=t,i=void 0;(i=e[n])!=65535;n++)if(i==r)return n-t;return-1}function findFinished(e){var t=null;for(var r=0,n=e;r<n.length;r++){var i=n[r];if(i.pos==i.cx.input.length&&i.cx.parser.stateFlag(i.state,2)&&(!t||t.score<i.score))t=i}return t}var printKeyword=1,newline=164,newlineBracketed=165,newlineEmpty=166,eof=167,continueBody=168,endBody=169,ParenthesizedExpression=21,TupleExpression=48,ComprehensionExpression=49,ArrayExpression=53,ArrayComprehensionExpression=56,DictionaryExpression=57,DictionaryComprehensionExpression=60,SetExpression=61,SetComprehensionExpression=62,compoundStatement=231;var newline$1=10,carriageReturn=13,space=32,tab$1=9,hash=35,parenOpen=40,dot=46;var bracketed=[ParenthesizedExpression,TupleExpression,ComprehensionExpression,ArrayExpression,ArrayComprehensionExpression,DictionaryExpression,DictionaryComprehensionExpression,SetExpression,SetComprehensionExpression],parentStatement=[compoundStatement];var caches=new WeakMap;var Cache=function(){function e(){this.last=this.lastIndent=-1;this.prev=[]}e.prototype.get=function(e){if(this.last==e)return this.lastIndent;for(var t=0;t<this.prev.length;t++)if(this.prev[t]==e)return t;return-1};e.prototype.set=function(e,t){if(e==this.last)return;if(this.last>-1)this.setPrev(this.last,this.lastIndent);this.last=e;this.lastIndent=t};e.prototype.setPrev=function(e,t){while(this.prev.length<t)this.prev.push(-1);this.prev[t]=e};e.for=function(t){var r=caches.get(t);if(!r)caches.set(t,r=new e);return r};return e}();var maxIndent=50;function getIndent(e,t){var r=Cache.for(e),n=r.get(t);if(n>-1)return n;var i=e.read(Math.max(0,t-maxIndent),t);var o=0,a=i.length;for(;a>0;a--){var s=i.charCodeAt(a-1);if(s==newline$1||s==carriageReturn)break}for(var l=a;l<i.length;l++){var c=i.charCodeAt(l);if(c==space)o++;else if(c==tab$1)o+=8-o%8;else break}r.setPrev(t,o);return o}var newlines=new ExternalTokenizer((function(e,t,r){var n=e.get(t.start);if(n<0){t.accept(eof,t.start);return}if(n!=newline$1&&n!=carriageReturn)return;if(r.startOf(bracketed)!=null){t.accept(newlineBracketed,t.start+1);return}var i=t.start+1,o=0;for(;i<e.length;i++){var a=e.get(i);if(a==space)o++;else if(a==tab$1)o+=8-o%8;else if(a==newline$1||o==carriageReturn||a==hash){t.accept(newlineEmpty,t.start+1);return}else{break}}t.accept(newline,t.start+1);Cache.for(e).set(i,o)}),{contextual:true,fallback:true});var bodyContinue=new ExternalTokenizer((function(e,t,r){var n=r.startOf(parentStatement);var i=n==null?0:getIndent(e,n);var o=getIndent(e,t.start);t.accept(o<=i?endBody:continueBody,t.start)}),{contextual:true,fallback:true});var legacyPrint=new ExternalTokenizer((function(e,t){var r=t.start;for(var n="print",i=0;i<n.length;i++,r++)if(e.get(r)!=n.charCodeAt(i))return;var o=r;if(/\w/.test(String.fromCharCode(e.get(r))))return;for(;;r++){var a=e.get(r);if(a==space||a==tab$1)continue;if(a!=parenOpen&&a!=dot&&a!=newline$1&&a!=carriageReturn&&a!=hash)t.accept(printKeyword,o);return}}));var spec_identifier={__proto__:null,await:40,or:48,and:50,in:54,not:56,is:58,if:64,else:66,lambda:70,self:74,yield:90,from:92,async:100,for:102,None:154,True:156,False:156,del:170,pass:174,break:178,continue:182,return:186,raise:194,import:198,as:200,global:204,nonlocal:206,assert:210,elif:220,while:224,try:230,except:232,finally:234,with:238,def:242,class:252};var parser=Parser.deserialize({version:12,states:"!;[O`Q!LTOOO%fQ!LUO'#GcOOQ!LQ'#Cm'#CmOOQ!LQ'#Cn'#CnO'UQ!LSO'#ClO(zQ!LUO'#GbOOQ!LQ'#Gc'#GcOOQ!LQ'#DS'#DSOOQ!LQ'#Gb'#GbO)hQ!LSO'#CqO)xQ!LSO'#DcO*YQ!LSO'#DgOOQ!LQ'#Dt'#DtO*mOWO'#DtO*uO`O'#DtO*}OpO'#DuO+YO!bO'#DuO+eO#tO'#DuO+pO&jO'#DuO-rQ!LUO'#GSOOQ!LQ'#GS'#GSO'UQ!LSO'#GRO/UQ!LUO'#GROOQ!LQ'#E^'#E^O/mQ!LSO'#E_OOQ!LQ'#GQ'#GQO/wQ!LSO'#GPOOQ&FV'#GP'#GPO0SQ!LSO'#FQOOQ!LQ'#Ft'#FtO0XQ!LSO'#FPOOQ&FV'#H]'#H]OOQ&FV'#GO'#GOOOQ!LR'#FS'#FSQ`Q!LTOOO'UQ!LSO'#CoO0gQ!LSO'#CzO0nQ!LSO'#DOO1PQ!LSO'#GgO1aQ!LUO'#ERO'UQ!LSO'#ESOOQ!LQ'#EU'#EUOOQ!LQ'#EW'#EWOOQ!LQ'#EY'#EYO1uQ!LSO'#E[O2SQ!LSO'#E`O0SQ!LSO'#EbO2gQ!LUO'#EbO0SQ!LSO'#EeO/mQ!LSO'#EhO/mQ!LSO'#ElO/mQ!LSO'#EoO2rQ!LSO'#EqO2yQ!LSO'#EvO3UQ!LSO'#ErO/mQ!LSO'#EvO0SQ!LSO'#ExO0SQ!LSO'#E}OOQ!LQ'#Cc'#CcOOQ!LQ'#Cd'#CdOOQ!LQ'#Ce'#CeOOQ!LQ'#Cf'#CfOOQ!LQ'#Cg'#CgOOQ!LQ'#Ch'#ChOOQ!LQ'#Cj'#CjO'UQ!LSO,58|O'UQ!LSO,58|O'UQ!LSO,58|O'UQ!LSO,58|O'UQ!LSO,58|O'UQ!LSO,58|O'UQ!LSO,58|O3ZQ!LSO'#DnOOQ!LQ,5:X,5:XO3nQ!LSO,5:[O3{Q#)WO,5:[O4QQ!LUO,59WO0gQ!LSO,59_O0gQ!LSO,59_O0gQ!LSO,59_O6pQ!LSO,59_O6uQ!LSO,59_O6|Q!LSO,59gO7TQ!LSO'#GbO8ZQ!LSO'#GaOOQ!LQ'#Ga'#GaOOQ!LQ'#DY'#DYO8rQ!LSO,59]O'UQ!LSO,59]O9QQ!LSO,59]O9VQ!LSO,5:QO'UQ!LSO,5:QOOQ!LQ,59},59}O9eQ!LSO,59}O9jQ!LSO,5:WO'UQ!LSO,5:WO'UQ!LSO,5:UOOQ!LQ,5:R,5:RO9{Q!LSO,5:RO:QQ!LSO,5:VOOOO'#F]'#F]O:VOWO,5:`OOQ!LQ,5:`,5:`OOOO'#F^'#F^O:_O`O,5:`O:gQ!LSO'#DvOOOO'#F_'#F_O:wOpO,5:aOOQ!LQ,5:a,5:aOOOO'#Fb'#FbO;SO!bO,5:aOOOO'#Fc'#FcO;_O#tO,5:aOOOO'#Fd'#FdO;jO&jO,5:aOOQ!LQ'#Fe'#FeO;uQ!LUO,5:eO>gQ!LUO,5<mO?QQ#4^O'#FfO?tQ!LUO,5<mOOQ!LQ,5:y,5:yO@]Q!LTO'#FmOAlQ!LSO,5;UOOQ&FV,5<k,5<kOAwQ!LUO'#HYOB`Q!LSO,5;lOOQ!LQ-E9r-E9rOOQ&FV,5;k,5;kO3PQ!LSO'#ExOOQ!LR-E9Q-E9QOBhQ!LUO,59ZODoQ!LUO,59fOEYQ!LSO'#GdOEeQ!LSO'#GdO0SQ!LSO'#GdOEpQ!LSO'#DQOExQ!LSO,59jOE}Q!LSO'#GhO'UQ!LSO'#GhO/mQ!LSO,5=ROOQ!LQ,5=R,5=RO/mQ!LSO'#D}OOQ!LQ'#EO'#EOOFlQ!LSO'#FgOF|Q!LSO,58zOG[Q!LSO,58zO)kQ!LSO,5:kOGaQ!LUO'#GjOOQ!LQ,5:n,5:nOOQ!LQ,5:v,5:vOGtQ!LSO,5:zOHVQ!LSO,5:|OOQ!LQ'#Fj'#FjOHeQ!LUO,5:|OHsQ!LSO,5:|OHxQ!LSO'#H[OOQ!LQ,5;P,5;POIWQ!LSO'#HXOOQ!LQ,5;S,5;SO3UQ!LSO,5;WO3UQ!LSO,5;ZOIiQ!LUO'#H^O'UQ!LSO'#H^OIsQ!LSO,5;]O2rQ!LSO,5;]O/mQ!LSO,5;bO0SQ!LSO,5;dOIxQ!LTO'#EmOKRQ&FXO,5;^ONjQ!LSO'#H_O3UQ!LSO,5;bONuQ!LSO,5;dONzQ!LSO,5;iO!#oQ!LUO1G.hO!#vQ!LUO1G.hO!&gQ!LUO1G.hO!&qQ!LUO1G.hO!)[Q!LUO1G.hO!)oQ!LUO1G.hO!*SQ!LUO1G.hO!,rQ!LSO'#GpO!-QQ!LUO'#GSO/mQ!LSO'#GpO!-[Q!LSO'#GoOOQ!LQ,5:Y,5:YO!-dQ!LSO,5:YO!-iQ!LSO'#GqO!-tQ!LSO'#GqO!.XQ!LSO1G/vOOQ!LQ'#Dr'#DrOOQ!LQ1G/v1G/vOOQ!LQ1G.y1G.yO!/XQ!LUO1G.yO!/`Q!LUO1G.yO0gQ!LSO1G.yO!/{Q!LSO1G/ROOQ!LQ'#DX'#DXO/mQ!LSO,59rOOQ!LQ1G.w1G.wO!0SQ!LSO1G/dO!0dQ!LSO1G/dO!0lQ!LSO1G/eO'UQ!LSO'#GiO!0qQ!LSO'#GiO!0vQ!LUO1G.wO!1WQ!LSO,59fO!2^Q!LSO'#FXO!2qQ!LSO,5=XO!2yQ!LSO1G/lO!3OQ!LUO1G/lOOQ!LQ1G/i1G/iO!3`Q!LSO'#FUO!4YQ!LSO,5=SO/mQ!LSO1G/pO!4wQ!LSO1G/rO!4|Q!LUO1G/rO!5^Q!LUO1G/pOOQ!LQ1G/m1G/mOOQ!LQ1G/q1G/qOOOO-E9Z-E9ZOOQ!LQ1G/z1G/zOOOO-E9[-E9[O!5nQ!LSO'#G|O/mQ!LSO'#G|O!5|Q!LSO,5:bOOOO-E9]-E9]OOQ!LQ1G/{1G/{OOOO-E9`-E9`OOOO-E9a-E9aOOOO-E9b-E9bOOQ!LQ-E9c-E9cO!6XQ!LUO1G2XO'UQ!LSO,5<QOOQ!LQ,5<Q,5<QOOQ!LQ-E9d-E9dOOQ!LQ,5<X,5<XOOQ!LQ-E9k-E9kOOQ&FV1G0p1G0pO0SQ!LSO'#FiO!6pQ!LUO,5=tOOQ!LQ1G1W1G1WO!7XQ!LSO1G1WOOQ!LQ'#DT'#DTO/mQ!LSO,5=OOOQ!LQ,5=O,5=OO!7^Q!LSO'#FTO!7lQ!LSO,59lO!7tQ!LSO1G/UO!8OQ!LUO,5=SOOQ!LQ1G2m1G2mOOQ!LQ,5:i,5:iO!8oQ!LSO'#GROOQ!LQ,5<R,5<ROOQ!LQ-E9e-E9eO!9QQ!LSO1G.fOOQ!LQ1G0V1G0VO!9`Q!LSO'#FWO!9sQ!LSO,5=UO/mQ!LSO1G0fO/mQ!LSO1G0fO0SQ!LSO1G0hOOQ!LQ-E9h-E9hO!:UQ!LSO1G0hO!:aQ!LSO1G0hO!:fQ!LSO'#FlO!:wQ!LSO,5=vO!;VQ!LSO'#FhO!;pQ!LSO,5=sO!<RQ&FXO1G0rO!?gQ&FXO1G0uO!BxQ!LSO'#FpO!CVQ!LSO,5=xO!C_Q!LUO,5=xO/mQ!LSO1G0wO!CiQ!LSO1G0wO3UQ!LSO1G0|ONuQ!LSO1G1OOOQ&FV,5;X,5;XO!CnQ!LTO,5;XO!EaQ&FXO1G0xO!HxQ!LSO'#FqO3UQ!LSO1G0xO3UQ!LSO1G0xO!IVQ!LSO'#FrO!IgQ!LSO,5=yO0SQ!LSO,5=yOOQ&FV1G0|1G0|O!JQQ!LSO'#EzO!JXQ#)WO1G1OOOQ&FV1G1T1G1TO3UQ!LSO1G1TOOQ!LQ,5=[,5=[OOQ!LQ'#Do'#DoO/mQ!LSO,5=[O!JaQ!LSO'#FZO!JwQ!LSO,5=ZOOQ!LQ1G/t1G/tO!KPQ!LSO'#F[O!KdQ!LSO,5=]O!KlQ!LSO,5=]O!LPQ!LSO,5=]O!LaQ!LSO,5=]OOQ!LQ7+%b7+%bOOQ!LQ7+$e7+$eO!7tQ!LSO7+$mO!NSQ!LSO1G.yO!NZQ!LSO1G.yOOQ!LQ1G/^1G/^OOQ!LQ,5;q,5;qO'UQ!LSO,5;qOOQ!LQ7+%O7+%OO!NbQ!LSO7+%OOOQ!LQ-E9T-E9TOOQ!LQ7+%P7+%PO!NrQ!LSO,5=TO'UQ!LSO,5=TOOQ!LQ7+$c7+$cO!NwQ!LSO7+%OO# PQ!LSO7+%POOQ!LQ,5;s,5;sO'UQ!LSO,5;sOOQ!LQ-E9V-E9VOOQ!LQ7+%W7+%WO# UQ!LSO1G2sO# ^Q!LSO7+%WOOQ!LQ,5;p,5;pO'UQ!LSO,5;pOOQ!LQ-E9S-E9SO# cQ!LSO7+%[OOQ!LQ7+%^7+%^O# qQ!LSO1G2nO#!`Q!LSO7+%^O#!eQ!LSO'#FYO#!xQ!LSO1G2tO##QQ!LSO7+%[O##VQ!LSO'#F`O##pQ!LSO,5=hO##pQ!LSO,5=hO#$OOMhO'#DxO#$ZOQO'#G}OOOO1G/|1G/|O#$`Q!LSO1G/|O#$hQ!LUO1G1lOOQ!LQ,5<T,5<TOOQ!LQ-E9g-E9gOOQ!LQ7+&r7+&rOOQ!LQ1G2j1G2jOOQ!LQ,5;o,5;oOOQ!LQ-E9R-E9ROOQ!LQ7+$p7+$pO#%RQ!LSO'#FfO#%oQ!LSO,5<mO#&QQ!LUO,5;rOOQ!LQ-E9U-E9UOOQ!LQ7+&Q7+&QO#&eQ!LSO7+&QOOQ!LQ7+&S7+&SO#&sQ!LSO'#HZO0SQ!LSO7+&SO#'XQ!LSO7+&SOOQ!LQ,5<W,5<WOOQ!LQ-E9j-E9jOOQ!LQ,5<S,5<SOOQ!LQ-E9f-E9fO#'dQ&FXO7+&^O!HxQ!LSO'#FoO3UQ!LSO7+&^O3UQ!LSO7+&aO#*xQ!LUO,5<[O'UQ!LSO,5<[OOQ!LQ-E9n-E9nO#+SQ!LSO1G3dO3UQ!LSO7+&cO/mQ!LSO7+&cOOQ&FV7+&h7+&hO!JXQ#)WO7+&jO#+[Q&FWO1G0sOOQ&FV-E9o-E9oO3UQ!LSO7+&dO3UQ!LSO7+&dOOQ&FV,5<],5<]O#+gQ!LSO,5<]OOQ&FV7+&d7+&dO#+rQ&FXO7+&dO#/TQ!LSO,5<^OOQ!LQ-E9p-E9pO#/`Q!LSO1G3eO#/hQ!LSO'#HaO#/vQ!LSO'#HaO0SQ!LSO'#HaOOQ!LQ'#Ha'#HaO#0RQ!LSO'#H`OOQ!LQ,5;f,5;fO#0ZQ!LSO,5;fO/mQ!LSO'#E|OOQ&FV7+&j7+&jO3UQ!LSO7+&jOOQ&FV7+&o7+&oOOQ!LQ1G2v1G2vOOQ!LQ,5;u,5;uOOQ!LQ-E9X-E9XO#0`Q!LSO,5;vO#0kQ!LSO,5;vOOQ!LQ-E9Y-E9YO#1OQ!LSO1G2wO#1WQ!LSO1G2wO#1hQ!LSO1G2wO#1OQ!LSO1G2wOOQ!LQ<<HX<<HXO#1sQ!LUO1G1]OOQ!LQ<<Hj<<HjP#1}Q!LSO'#FVO6|Q!LSO1G2oO#2[Q!LSO1G2oO#2aQ!LSO<<HjOOQ!LQ<<Hk<<HkO#2qQ!LUO1G1_OOQ!LQ<<Hr<<HrO#2{Q!LUO1G1[O#3lQ!LSO7+(`O#3tQ!LSO<<HvOOQ!LQ<<Hx<<HxO#3yQ!LSO,5;tO'UQ!LSO,5;tOOQ!LQ-E9W-E9WOOQ!LQ<<Hv<<HvOOQ!LQ,5;z,5;zO/mQ!LSO,5;zOOQ!LQ-E9^-E9^O#4OQ!LSO1G3SOOOO'#Fa'#FaO#4^OMhO,5:dOOOO,5=i,5=iOOOO7+%h7+%hO#4iQ!LSO1G2XO/mQ!LSO<<IlO#4zQ!LSO'#FkO#5`Q!LSO,5=uO0SQ!LSO,5=uO#5qQ!LSO<<InOOQ!LQ<<In<<InO0SQ!LSO<<InOOQ&FV-E9m-E9mO3UQ!LSO<<IxOOQ&FV,5<Z,5<ZO3UQ!LSO,5<ZOOQ&FV<<Ix<<IxOOQ&FV<<I{<<I{O#5vQ!LUO1G1vO#6QQ&FXO<<I}O3UQ!LSO<<I}OOQ&FV<<JU<<JUO3UQ!LSO<<JUO!CnQ!LTO'#FnO#9cQ&FWO7+&_OOQ&FV7+&_7+&_OOQ&FV<<JO<<JOO#9nQ&FXO<<JOOOQ&FV1G1w1G1wO0SQ!LSO1G1wO3UQ!LSO<<JOO0SQ!LSO1G1xO#=PQ!LSO7+)POOQ!LQ'#E{'#E{O/mQ!LSO,5={O#=XQ!LSO,5={OOQ!LQ,5={,5={O#=dQ!LSO'#FsO#=nQ!LSO,5=zOOQ!LQ1G1Q1G1QOOQ!LQ,5;h,5;hO#=vQ!LSO1G1bO#>ZQ!LSO1G1bO#>kQ!LSO1G1bO#>vQ!LSO7+(cO#>vQ!LSO7+(cO#?OQ!LSO7+(cO#?`Q!LSO7+(ZO6|Q!LSO7+(ZOOQ!LQAN>UAN>UOOQ!LQAN>bAN>bO/mQ!LSO1G1`O#?yQ!LUO1G1`OOQ!LQ1G1f1G1fOOOO-E9_-E9_OOQ!LQAN?WAN?WO#@TQ!LSO,5<VOOQ!LQ-E9i-E9iO#@iQ!LSO1G3aOOQ!LQAN?YAN?YO#@zQ!LSOAN?YOOQ&FVAN?dAN?dOOQ&FV1G1u1G1uO3UQ!LSOAN?iO#APQ&FXOAN?iOOQ&FVAN?pAN?pOOQ&FU,5<Y,5<YOOQ&FU-E9l-E9lOOQ&FV<<Iy<<IyO3UQ!LSOAN?jO3UQ!LSO7+'cOOQ&FVAN?jAN?jOOQ!LQ7+'d7+'dOOQ!LQ1G3g1G3gO/mQ!LSO1G3gOOQ!LQ,5<_,5<_OOQ!LQ-E9q-E9qO#DbQ!LSO7+&|O#DrQ!LSO7+&|OOQ!LQ7+&|7+&|O#D}Q!LSO<<K}O#D}Q!LSO<<K}O#EVQ!LSO'#GkOOQ!LQ<<Ku<<KuO#EaQ!LSO<<KuOOQ!LQ7+&z7+&zO0SQ!LSO1G1qO#EzQ!LSO7+({OOQ!LQG24tG24tOOQ&FVG25TG25TO3UQ!LSOG25TOOQ&FVG25UG25UOOQ&FV<<J}<<J}OOQ!LQ7+)R7+)ROOQ!LQ<<Jh<<JhO#F]Q!LSO<<JhO#FmQ!LSOANAiO#FuQ!LSO'#GlOOQ!LQ'#Gl'#GlO0nQ!LSO'#DbO#G`Q!LSO,5=VOOQ!LQANAaANAaOOQ!LQ7+']7+']OOQ&FVLD*oLD*oOOQ!LQAN@SAN@SO#GwQ!LSO,59|OOQ!LQ1G2q1G2qO#EVQ!LSO1G/hOOQ!LQ7+%S7+%SO6|Q!LSO'#CzO6|Q!LSO,59_O6|Q!LSO,59_O6|Q!LSO,59_O#G|Q!LUO,5<mO6|Q!LSO1G.yO/mQ!LSO1G/UO/mQ!LSO7+$mO'UQ!LSO'#GRO#HaQ!LSO,59_O#HfQ!LSO,59_O#HmQ!LSO,59jO#HrQ!LSO1G/RO0nQ!LSO'#DOO6|Q!LSO,59g",stateData:"#IT~O$qOS$lOS$kOSQOS~OPhOTeOdsOfXOltOp!SOsuOudO}vO!O!PO!S!VO!T!UO!WYO![ZO!gdO!ndO!odO!pdO!wxO!yyO!{zO!}{O#P|O#T}O#V!OO#Y!QO#Z!QO#]!RO#d!TO#g!WO#k!XO#m!YO#r!ZO#ulO$jqO$|QO$}QO%RRO%SVO%g[O%h]O%k^O%n_O%t`O%waO%ybO~OT!aO]!aO_!bOf!jO!W!lO!e!mO$w![O$x!]O$y!^O$z!_O${!_O$|!`O$}!`O%O!aO%P!aO%Q!aO~Oh%VXi%VXj%VXk%VXl%VXm%VXp%VXx%VXy%VX!t%VX#_%VX$j%VX$m%VX%X%VX!P%VX!S%VX!T%VX%Y%VX!X%VX!]%VX!O%VX#W%VXq%VX!k%VX~P$bOdsOfXOudO!WYO![ZO!gdO!ndO!odO!pdO$|QO$}QO%RRO%SVO%g[O%h]O%k^O%n_O%t`O%waO%ybO~Ox%UXy%UX#_%UX$j%UX$m%UX%X%UX~Oh!pOi!qOj!oOk!oOl!rOm!sOp!tO!t%UX~P(fOT!zOl,qOs-OO}vO~P'UOT!}Ol,qOs-OO!X#OO~P'UOT#RO_#SOl,qOs-OO!]#TO~P'UO%i#WO%j#YO~O%l#ZO%m#YO~O![#]O%o#^O%s#`O~O![#]O%u#aO%v#`O~O![#]O%j#`O%x#cO~O![#]O%m#`O%z#eO~OT$vX]$vX_$vXf$vXh$vXi$vXj$vXk$vXl$vXm$vXp$vXx$vX!W$vX!e$vX$w$vX$x$vX$y$vX$z$vX${$vX$|$vX$}$vX%O$vX%P$vX%Q$vX!P$vX!S$vX!T$vX~O%g[O%h]O%k^O%n_O%t`O%waO%ybOy$vX!t$vX#_$vX$j$vX$m$vX%X$vX%Y$vX!X$vX!]$vX!O$vX#W$vXq$vX!k$vX~P+{Ox#jOy$uX!t$uX#_$uX$j$uX$m$uX%X$uX~Ol,qOs-OO~P'UO#_#mO$j#oO$m#oO~O%SVO~O!S#tO#m!YO#r!ZO#ulO~OltO~P'UOT#yO_#zOu#xO%SVOytP~OT$OOl,qOs-OO!O$PO~P'UOy$RO!t$WO%X$SO#_!uX$j!uX$m!uX~OT$OOl,qOs-OO~P'UOl,qOs-OO#_#SX$j#SX$m#SX~P'UO!e$^O!n$^O%SVO~OT$hO~P'UO!T$jO#k$kO#m$lO~Oy$mO~OT$|O_$|Ol,qOs-OO!P%OO~P'UOl,qOs-OOy%RO~P'UO%f%TO~O_!bOf!jO!W!lO!e!mOT`a]`ah`ai`aj`ak`al`am`ap`ax`ay`a!t`a#_`a$j`a$m`a$w`a$x`a$y`a$z`a${`a$|`a$}`a%O`a%P`a%Q`a%X`a!P`a!S`a!T`a%Y`a!X`a!]`a!O`a#W`aq`a!k`a~Ok%YO~Ol%YO~P'UOl,qO~P'UOh,sOi,tOj,rOk,rOl,zOm,{Op-PO!P%UX!S%UX!T%UX%Y%UX!X%UX!]%UX!O%UX#W%UX!k%UX~P(fO%Y%[Ox%TX!P%TX!S%TX!T%TX!X%TXy%TX~Ox%_O!P%^O!S%cO!T%bO~O!P%^O~Ox%fO!S%cO!T%bO!X%aX~O!X%jO~Ox%kOy%mO!S%cO!T%bO!]%[X~O!]%qO~O!]%rO~O%i#WO%j%tO~O%l#ZO%m%tO~OT%wOl,qOs-OO}vO~P'UO![#]O%o#^O%s%zO~O![#]O%u#aO%v%zO~O![#]O%j%zO%x#cO~O![#]O%m%zO%z#eO~OT!ma]!ma_!maf!mah!mai!maj!mak!mal!mam!map!max!may!ma!W!ma!e!ma!t!ma#_!ma$j!ma$m!ma$w!ma$x!ma$y!ma$z!ma${!ma$|!ma$}!ma%O!ma%P!ma%Q!ma%X!ma!P!ma!S!ma!T!ma%Y!ma!X!ma!]!ma!O!ma#W!maq!ma!k!ma~P#yOx#jOy$ua!t$ua#_$ua$j$ua$m$ua%X$ua~P$bOT&QOltOsuOx$YXy$YX!t$YX#_$YX$j$YX$m$YX%X$YX~P'UOx#jOy$ua!t$ua#_$ua$j$ua$m$ua%X$ua~OPhOTeOltOsuO}vO!O!PO!wxO!yyO!{zO!}{O#P|O#T}O#V!OO#Y!QO#Z!QO#]!RO#_$aX$j$aX$m$aX~P'UO#_#mO$j&VO$m&VO~O!e&WOf%|X$j%|X#W%|X#_%|X$m%|X#V%|X~Of!jO$j&YO~Ohcaicajcakcalcamcapcaxcayca!tca#_ca$jca$mca%Xca!Pca!Sca!Tca%Yca!Xca!]ca!Oca#Wcaqca!kca~P$bOpnaxnayna#_na$jna$mna%Xna~Oh!pOi!qOj!oOk!oOl!rOm!sO!tna~PDWO%X&[Ox%WXy%WX~O%SVOx%WXy%WX~Ox&_OytX~Oy&aO~Ox%kO#_%[X$j%[X$m%[X!P%[Xy%[X!]%[X!k%[X%X%[X~OT,yOl,qOs-OO}vO~P'UO%X$SO#_Sa$jSa$mSa~O%X$SO~Ox&jO#_%^X$j%^X$m%^Xk%^X~P$bOx&mO!O&lO#_#Sa$j#Sa$m#Sa~O#W&nO#_#Ua$j#Ua$m#Ua~O!e$^O!n$^O#V&pO%SVO~O#V&pO~Ox&rO#_&OX$j&OX$m&OX~Ox&tO#_%{X$j%{X$m%{Xy%{X~Ox&xOk&QX~P$bOk&{O~OPhOTeOltOsuO}vO!O!PO!wxO!yyO!{zO!}{O#P|O#T}O#V!OO#Y!QO#Z!QO#]!RO$j'QO~P'UOq'UO#h'SO#i'TOP#faT#fad#faf#fal#fap#fas#fau#fa}#fa!O#fa!S#fa!T#fa!W#fa![#fa!g#fa!n#fa!o#fa!p#fa!w#fa!y#fa!{#fa!}#fa#P#fa#T#fa#V#fa#Y#fa#Z#fa#]#fa#d#fa#g#fa#k#fa#m#fa#r#fa#u#fa$i#fa$j#fa$|#fa$}#fa%R#fa%S#fa%g#fa%h#fa%k#fa%n#fa%t#fa%w#fa%y#fa$m#fa$n#fa$o#fa~Ox'VO#W'XOy&RX~Of'ZO~Of!jOy$mO~OT!aO]!aO_!bOf!jO!W!lO!e!mO$y!^O$z!_O${!_O$|!`O$}!`O%O!aO%P!aO%Q!aOhUiiUijUikUilUimUipUixUiyUi!tUi#_Ui$jUi$mUi$wUi%XUi!PUi!SUi!TUi%YUi!XUi!]Ui!OUi#WUiqUi!kUi~O$x!]O~P! SO$xUi~P! SOT!aO]!aO_!bOf!jO!W!lO!e!mO$|!`O$}!`O%O!aO%P!aO%Q!aOhUiiUijUikUilUimUipUixUiyUi!tUi#_Ui$jUi$mUi$wUi$xUi$yUi%XUi!PUi!SUi!TUi%YUi!XUi!]Ui!OUi#WUiqUi!kUi~O$z!_O${!_O~P!#}O$zUi${Ui~P!#}O_!bOf!jO!W!lO!e!mOhUiiUijUikUilUimUipUixUiyUi!tUi#_Ui$jUi$mUi$wUi$xUi$yUi$zUi${Ui$|Ui$}Ui%XUi!PUi!SUi!TUi%YUi!XUi!]Ui!OUi#WUiqUi!kUi~OT!aO]!aO%O!aO%P!aO%Q!aO~P!&{OTUi]Ui%OUi%PUi%QUi~P!&{Of!jO!W!lO!e!mOTUi]Ui_UihUiiUijUikUilUimUipUixUiyUi!tUi#_Ui$jUi$mUi$wUi$xUi$yUi$zUi${Ui$|Ui$}Ui%OUi%PUi%QUi%XUi!PUi!SUi!TUi%YUi!XUi!]Ui!OUi#WUiqUi!kUi~O!S%cO!T%bOx%dX!P%dX~O%X'`O%Y'`O~P+{Ox'bO!P%cX~O!P'dO~Ox'eOy'gO!X%eX~Ol,qOs-OOx'eOy'hO!X%eX~P'UO!X'jO~Oj!oOk!oOl!rOm!sOhgipgixgiygi!tgi#_gi$jgi$mgi%Xgi~Oi!qO~P!.^Oigi~P!.^Oh,sOi,tOj,rOk,rOl,zOm,{O~Oq'lO~P!/gOT'qOl,qOs-OO!P'rO~P'UOx'sO!P'rO~O!P'uO~O!T'wO~Ox'sO!P'xO!S%cO!T%bO~P$bOh,sOi,tOj,rOk,rOl,zOm,{O!Pna!Sna!Tna%Yna!Xna!]na!Ona#Wnaqna!kna~PDWOT'|Ol,qOs-OOx#{X!X#{X~P'UOx%fO!X%aa~O!X(OO~Ox%fO!S%cO!T%bO!X%aa~P$bOT(SOl,qOs-OOx#xX!]#xX#_#xX$j#xX$m#xX!P#xXy#xX!k#xX%X#xX~P'UOx%kO!]%[a#_%[a$j%[a$m%[a!P%[ay%[a!k%[a%X%[a~O!](VO~Ox%kO!S%cO!T%bO!]%[a~P$bOx(YO!S%cO!T%bO!]%ba~P$bOx(]Oy%pX!]%pX!k%pX~Oy(`O!](bO!k(cO~Ox#jOy$ui!t$ui#_$ui$j$ui$m$ui%X$ui~O!e&WOf%|a$j%|a#W%|a#_%|a$m%|a#V%|a~O$j(gO~OT#yO_#zOu#xO%SVO~Ox&_Oyta~OltOsuO~P'UOx%kO#_%[a$j%[a$m%[a!P%[ay%[a!]%[a!k%[a%X%[a~P$bOx(lO#_$uX$j$uX$m$uX%X$uX~O%X$SO#_Si$jSi$mSi~Ox#zX#_#zX$j#zX$m#zXk#zX~P'UOx&jO#_%^a$j%^a$m%^ak%^a~OT(rOf(tO%SVO~O#V(uO~O%SVOx$`X#_$`X$j$`X$m$`X~Ox&rO#_&Oa$j&Oa$m&Oa~Ol,qOs-OOx$[X#_$[X$j$[X$m$[Xy$[X~P'UOx&tO#_%{a$j%{a$m%{ay%{a~Oq(|O#b({OP#`iT#`id#`if#`il#`ip#`is#`iu#`i}#`i!O#`i!S#`i!T#`i!W#`i![#`i!g#`i!n#`i!o#`i!p#`i!w#`i!y#`i!{#`i!}#`i#P#`i#T#`i#V#`i#Y#`i#Z#`i#]#`i#d#`i#g#`i#k#`i#m#`i#r#`i#u#`i$i#`i$j#`i$|#`i$}#`i%R#`i%S#`i%g#`i%h#`i%k#`i%n#`i%t#`i%w#`i%y#`i$m#`i$n#`i$o#`i~Oq(}OP#ciT#cid#cif#cil#cip#cis#ciu#ci}#ci!O#ci!S#ci!T#ci!W#ci![#ci!g#ci!n#ci!o#ci!p#ci!w#ci!y#ci!{#ci!}#ci#P#ci#T#ci#V#ci#Y#ci#Z#ci#]#ci#d#ci#g#ci#k#ci#m#ci#r#ci#u#ci$i#ci$j#ci$|#ci$}#ci%R#ci%S#ci%g#ci%h#ci%k#ci%n#ci%t#ci%w#ci%y#ci$m#ci$n#ci$o#ci~OT)POk$dXx$dX~P'UOx&xOk&Qa~Ox&xOk&Qa~P$bOk)TO~OPhOTeOltOp!SOsuO}vO!O!PO!S!VO!T!UO!wxO!yyO!{zO!}{O#P|O#T}O#V!OO#Y!QO#Z!QO#]!RO#d!TO#g!WO#k!XO#m!YO#r!ZO#ulO~P'UOq)ZO#h'SO#i)YOP#fiT#fid#fif#fil#fip#fis#fiu#fi}#fi!O#fi!S#fi!T#fi!W#fi![#fi!g#fi!n#fi!o#fi!p#fi!w#fi!y#fi!{#fi!}#fi#P#fi#T#fi#V#fi#Y#fi#Z#fi#]#fi#d#fi#g#fi#k#fi#m#fi#r#fi#u#fi$i#fi$j#fi$|#fi$}#fi%R#fi%S#fi%g#fi%h#fi%k#fi%n#fi%t#fi%w#fi%y#fi$m#fi$n#fi$o#fi~Ol,qOs-OOy$mO~P'UOl,qOs-OOx$fXy$fX~P'UOx'VOy&Ra~OT)dO_)eOu)cO%O)fO%SVO~O!P)hO~P!IoOy$mO&U)jO~OT$|O_$|Ol,qOs-OOx#}X!P#}X~P'UOx'bO!P%ca~Ol,qOs-OOy)rOx$OX!X$OX~P'UOx'eO!X%ea~Ol,qOs-OOx'eOy)uO!X%ea~P'UOl,qOs-OOx'eO!X%ea~P'UOx'eOy)uO!X%ea~Oj,rOk,rOl,zOm,{Ohgipgixgi!Pgi!Sgi!Tgi%Ygi!Xgiygi!]gi#_gi$jgi$mgi!Ogi#Wgiqgi!kgi%Xgi~Oi,tO~P!LlOigi~P!LlOT'qOl,qOs-OO!P)zO~P'UOk)|O~Ox*OO!P)zO~O!P*PO~Ox%fO!X%ai~O!X*RO~Ox(YO!S%cO!T%bO!]%bi~Ox%kO!]%[i#_%[i$j%[i$m%[i!P%[iy%[i!k%[i%X%[i~O!]*VO~O_*XOl,qOs-OOx#|X!]#|X~P'UOx(YO!]%bi~O!]*ZO~OT*]Ol,qOs-OOx$SXy$SX!]$SX!k$SX~P'UOx(]Oy%pa!]%pa!k%pa~O![#]O%r*`O!]!lX~O!]*bO~Oy(`O!]*cO~Ox$Yiy$Yi!t$Yi#_$Yi$j$Yi$m$Yi%X$Yi~P$bOT&QOl,qOs-OOx$YX#_$YX$j$YX$m$YX%X$YX~P'UOx(lO#_$ua$j$ua$m$ua%X$ua~Ox#za#_#za$j#za$m#zak#za~P$bOx*eO#_#Sq$j#Sq$m#Sq~Ox*fO#W*hO#_%}X$j%}X$m%}X!P%}X~OT*jOf*kO%SVO~Oq*mO#b({OP#`qT#`qd#`qf#`ql#`qp#`qs#`qu#`q}#`q!O#`q!S#`q!T#`q!W#`q![#`q!g#`q!n#`q!o#`q!p#`q!w#`q!y#`q!{#`q!}#`q#P#`q#T#`q#V#`q#Y#`q#Z#`q#]#`q#d#`q#g#`q#k#`q#m#`q#r#`q#u#`q$i#`q$j#`q$|#`q$}#`q%R#`q%S#`q%g#`q%h#`q%k#`q%n#`q%t#`q%w#`q%y#`q$m#`q$n#`q$o#`q~Ok$dax$da~P$bOx&xOk&Qi~O$m*yO$n*wO$o*yO~Ox*}Oy$mO#W*}O~O#i+OOP#fqT#fqd#fqf#fql#fqp#fqs#fqu#fq}#fq!O#fq!S#fq!T#fq!W#fq![#fq!g#fq!n#fq!o#fq!p#fq!w#fq!y#fq!{#fq!}#fq#P#fq#T#fq#V#fq#Y#fq#Z#fq#]#fq#d#fq#g#fq#k#fq#m#fq#r#fq#u#fq$i#fq$j#fq$|#fq$}#fq%R#fq%S#fq%g#fq%h#fq%k#fq%n#fq%t#fq%w#fq%y#fq$m#fq$n#fq$o#fq~O#W+POx$fay$fa~Ox'VOy&Ri~Oy$RO%X+ROx&TX!P&TX~O%SVOx&TX!P&TX~Ox+VO!P&SX~O!P+XO~Oy+ZOx$Oa!X$Oa~Ol,qOs-OOy+[Ox$Oa!X$Oa~P'UOx'eO!X%ei~Ol,qOs-OOx'eO!X%ei~P'UOx'eOy+`O!X%ei~Ox#yi!P#yi~P$bOT'qOl,qOs-OO~P'UOk+bO~OT'qOl,qOs-OO!P+cO~P'UOx#{i!X#{i~P$bOx#xi!]#xi#_#xi$j#xi$m#xi!P#xiy#xi!k#xi%X#xi~P$bOx(YO!]%bq~O!]+dO~Oy+eO~Ox(]Oy%pi!]%pi!k%pi~O![#]O%r*`O!]!la~Ox(lO#_$ui$j$ui$m$ui%X$ui~O%SVOx$_X#_$_X$j$_X$m$_X!P$_X~Ox*fO#_%}a$j%}a$m%}a!P%}a~O!P+mO~Ok$dix$di~P$bOq+qOP#eyT#eyd#eyf#eyl#eyp#eys#eyu#ey}#ey!O#ey!S#ey!T#ey!W#ey![#ey!g#ey!n#ey!o#ey!p#ey!w#ey!y#ey!{#ey!}#ey#P#ey#T#ey#V#ey#Y#ey#Z#ey#]#ey#d#ey#g#ey#k#ey#m#ey#r#ey#u#ey$i#ey$j#ey$|#ey$}#ey%R#ey%S#ey%g#ey%h#ey%k#ey%n#ey%t#ey%w#ey%y#ey$m#ey$n#ey$o#ey~O$m+vO$n*wO$o+vO~O#i+wOP#fyT#fyd#fyf#fyl#fyp#fys#fyu#fy}#fy!O#fy!S#fy!T#fy!W#fy![#fy!g#fy!n#fy!o#fy!p#fy!w#fy!y#fy!{#fy!}#fy#P#fy#T#fy#V#fy#Y#fy#Z#fy#]#fy#d#fy#g#fy#k#fy#m#fy#r#fy#u#fy$i#fy$j#fy$|#fy$}#fy%R#fy%S#fy%g#fy%h#fy%k#fy%n#fy%t#fy%w#fy%y#fy$m#fy$n#fy$o#fy~Ox'VOy&Rq~O%X+ROx&Ta!P&Ta~Ox$gX!P$gX~P!IoOx+VO!P&Sa~Ol,qOs-OOy,POx$Oi!X$Oi~P'UOl,qOs-OOx$Oi!X$Oi~P'UOy,POx$Oi!X$Oi~Ox'eO!X%eq~Ol,qOs-OOx'eO!X%eq~P'UOp,UO!S%cO!T%bO!P%]q!X%]q!]%]qx%]q~P!/gOx#|i!]#|i~P$bO#W,YOx$_a#_$_a$j$_a$m$_a!P$_a~Ox*fO#_%}i$j%}i$m%}i!P%}i~O!P,[O~Oq,^OP#e!RT#e!Rd#e!Rf#e!Rl#e!Rp#e!Rs#e!Ru#e!R}#e!R!O#e!R!S#e!R!T#e!R!W#e!R![#e!R!g#e!R!n#e!R!o#e!R!p#e!R!w#e!R!y#e!R!{#e!R!}#e!R#P#e!R#T#e!R#V#e!R#Y#e!R#Z#e!R#]#e!R#d#e!R#g#e!R#k#e!R#m#e!R#r#e!R#u#e!R$i#e!R$j#e!R$|#e!R$}#e!R%R#e!R%S#e!R%g#e!R%h#e!R%k#e!R%n#e!R%t#e!R%w#e!R%y#e!R$m#e!R$n#e!R$o#e!R~Ol,qOs-OOx$Oq!X$Oq~P'UOy,cOx$Oq!X$Oq~Ox'eO!X%ey~Ol,qOs,gO~P'UOp,UO!S%cO!T%bO!P%]y!X%]y!]%]yx%]y~P!/gOx*fO#_%}q$j%}q$m%}q!P%}q~Ol,qOs-OOx$Oy!X$Oy~P'UOx'eO!X%e!R~Op%`X!P%`X!S%`X!T%`X!X%`X!]%`Xx%`X~P!/gOp,UO!S%cO!T%bO!P%_a!X%_a!]%_ax%_a~Oy,oO~Ox(lO#_$ua$j$ua$m$ua%X$ua~P$bOk,vO~Ol,vO~P'UOy,wO~Oq,xO~P!/gO%h%k%w%y%g%n%t%S%g~",goto:"!&h&UPPPP&VP&_(|)d){*e+O+jP,VP&_,t,t&_P&_P/cPPPPPP/c1bPP1bP2}P3W7`PP7c7o7rPPP&_&_PP8O&_PP&_&_PP&_&_&_&_8S8x&_P8{P9O9O;qP<V&_PPP<Z<a&VP&V&VP&VP&VP&VP&VP&V&V&VP&VPP&VPP&VP<gP<n<tP<nP<n<nPPP<nP>mP>v>|?S>mP<n?YP?a?g?m?y@T@Z@e@o@uAcAiAoAuBPBVB]BcBiBoCRC]CcCiCoCyDPDVD]DcDmDsD}ETPPPPPPPPPE^EhEqE{FWPPPPPPPPPPPPI}JgNU!!qPP!!y!#X!#b!$W!#}!$a!$g!$j!$m!$p!$vPPPPPPPPPP!$y!$|PPPPPPPPP!%S!%`!%l!%x!%{!&R!&X!&_!&b]iOr#m$m'Q*w&XdOSXYZehrstvx|}!R!S!T!U!X!c!d!e!f!g!h!i!j!l!o!p!q!s!t!z!}#R#S#]#j#m$O$P$R$T$W$h$j$k$m$|%R%Y%]%_%b%f%k%m%w&Q&]&a&j&l&m&t&x&{'Q'S'V'a'b'e'g'h'l'q's'w'|(S(Y(](l({)P)T)j)r)u){)|*O*X*]*e*w+S+Z+[+`+b+e+|,P,U,c,o,q,r,s,t,v,w,x,y,{-Py!cP#i#v$X$g%d%i%o%p&b&z(d(n)O)y*Q*S*r+f,u{!dP#i#v$X$g$s%d%i%o%p&b&z(d(n)O)y*Q*S*r+f,u}!eP#i#v$X$g$s$t%d%i%o%p&b&z(d(n)O)y*Q*S*r+f,u!P!fP#i#v$X$g$s$t$u%d%i%o%p&b&z(d(n)O)y*Q*S*r+f,u!R!gP#i#v$X$g$s$t$u$v%d%i%o%p&b&z(d(n)O)y*Q*S*r+f,u!T!hP#i#v$X$g$s$t$u$v$w%d%i%o%p&b&z(d(n)O)y*Q*S*r+f,u!X!iP!n#i#v$X$g$s$t$u$v$w$x%d%i%o%p&b&z(d(n)O)y*Q*S*r+f,u&XSOSXYZehrstvx|}!R!S!T!U!X!c!d!e!f!g!h!i!j!l!o!p!q!s!t!z!}#R#S#]#j#m$O$P$R$T$W$h$j$k$m$|%R%Y%]%_%b%f%k%m%w&Q&]&a&j&l&m&t&x&{'Q'S'V'a'b'e'g'h'l'q's'w'|(S(Y(](l({)P)T)j)r)u){)|*O*X*]*e*w+S+Z+[+`+b+e+|,P,U,c,o,q,r,s,t,v,w,x,y,{-P$yUOXYZhrtv|}!R!S!T!X!j!l!o!p!q!s!t#]#j#m$P$R$T$W$k$m$|%R%Y%]%_%f%k%m%w&]&a&l&m&t&{'Q'S'V'a'b'e'g'h'l's(Y(](l({)T)j)r)u){)|*O*]*e*w+S+Z+[+`+b+e+|,P,U,c,o,q,r,s,t,v,w,x,{-P$TWOXYZhrv|}!R!S!T!X!j!l#]#j#m$P$R$T$W$k$m$|%R%]%_%f%k%m%w&]&a&l&m&t&{'Q'S'V'a'b'e'g'h'l's(Y(](l({)T)j)r)u){*O*]*e*w+S+Z+[+`+e+|,P,c,w,xQ#|uQ,m,gR,|-O&SdOSXYZehrstvx|}!R!S!T!U!X!c!d!e!f!g!h!i!l!o!p!q!s!t!z!}#R#S#]#j#m$O$P$R$T$W$h$j$k$m$|%R%Y%]%_%b%f%k%m%w&Q&]&a&j&l&m&t&x&{'Q'S'V'a'e'g'h'l'q's'w'|(S(Y(](l({)P)T)j)r)u){)|*O*X*]*e*w+S+Z+[+`+b+e+|,P,U,c,o,q,r,s,t,v,w,x,y,{-PW#pl!O!P$_W#xu&_,g-OQ$a!QQ$q!YQ$r!ZS${!j'bS&^#y#zQ'O$lQ(e&WQ(r&nW(s&p(t(u*kQ(v&rQ)b'XS)c'Z+VS+U)d)eQ+j*fQ+l*hQ+x*}Q+z+PR,j,YR&]#xe!wXY!S!T%_%f's({){*OR%]!vQ!{XQ%x#]Q&f$TR&i$WT,f,U,o!Y!kP!n#i#v$X$g$s$t$u$v$w$x$y%d%i%o%p&b&z(d(n)O)y*Q*S*r+f,uQ&Z#qR'^$rR'a${R%U!m&WcOSXYZehrstvx|}!R!S!T!U!X!c!d!e!f!g!h!i!j!l!o!p!q!s!t!z!}#R#S#]#j#m$O$P$R$T$W$h$j$k$m$|%R%Y%]%_%b%f%k%m%w&Q&]&a&j&l&m&t&x&{'Q'S'V'a'b'e'g'h'l'q's'w'|(S(Y(](l({)P)T)j)r)u){)|*O*X*]*e*w+S+Z+[+`+b+e+|,P,U,c,o,q,r,s,t,v,w,x,y,{-PT#gc#hS#^_#_S#a`#bS#ca#dS#eb#fT*`(`*aT(a%x(cQ$VwR+T)cX$Tw$U$V&hZkOr$m'Q*wXoOr'Q*wQ$n!WQ&v$eQ&w$fQ'Y$pQ']$rQ)U&}Q)['SQ)^'TQ)_'UQ)k'[Q)m'^Q*n({Q*p(|Q*q(}Q*s)SS*u)V)lQ*z)YQ*{)ZQ*|)]Q+o*mQ+p*oQ+r*tQ+s*vQ+y+OQ,]+qQ,_+wQ,`+xR,k,^WoOr'Q*wR#snQ'[$qR)V'OQ+S)cR+|+TQ)l'[R*v)VZmOnr'Q*wQrOR#urQ&`#{R(j&`S%l#Q#}S(T%l(WT(W%o&bQ%`!yS't%`'yR'y%dQ&k$XR(o&kQ%g!|S'}%g(PR(P%iQ(Z%pQ*T(UT*Y(Z*TQ'c$}R)p'cS'f%Q%RY)s'f)t+^,S,dU)t'g'h'iU+^)u)v)wS,S+_+`R,d,TQ#X]R%s#XQ#[^R%u#[Q#__R%y#_Q(^%vS*^(^*_R*_(_Q*a(`R+h*aQ#b`R%{#bQ#daR%|#dQ#fbR%}#fQ#hcR&O#hQ#kfQ&P#iW&S#k&P(m*dQ(m&eR*d,uQ$UwS&g$U&hR&h$VQ&u$cR(y&uQ&X#pR(f&XQ$_!PR&o$_Q*g(sS+k*g,ZR,Z+lQ&s$aR(w&sQ#njR&U#nQ*x)WR+u*xQ(z&vR*l(zQ&y$gS)Q&y)RR)R&zQ'R$nR)X'RQ'W$oS)a'W+QR+Q)bQ+W)gR,O+WWnOr'Q*wR#rnSqOrQ)W'QR+t*wWpOr'Q*wR'P$mYjOr$m'Q*wR&T#m[wOr#m$m'Q*wR&f$T$xPOXYZhrtv|}!R!S!T!X!j!l!o!p!q!s!t#]#j#m$P$R$T$W$k$m$|%R%Y%]%_%f%k%m%w&]&a&l&m&t&{'Q'S'V'a'b'e'g'h'l's(Y(](l({)T)j)r)u){)|*O*]*e*w+S+Z+[+`+b+e+|,P,U,c,o,q,r,s,t,v,w,x,{-PQ!nSQ#ieQ#vsU$Xx%b'wS$g!U$jQ$s!cQ$t!dQ$u!eQ$v!fQ$w!gQ$x!hQ$y!iQ%d!zQ%i!}Q%o#RQ%p#SQ&b$OQ&z$hQ(d&QQ(n&jQ)O&xQ)y'qQ*Q'|Q*S(SQ*r)PQ+f*XR,u,yQ!yXQ!|YQ$e!SQ$f!TW'p%_'s){*OQ'{%fR*o({[fOr#m$m'Q*wd!vXY!S!T%_%f's({){*OQ#QZQ#lhS#}v|Q$[}W$c!R$W&{)TS$o!X$kS$z!j'bQ%Q!lQ%v#]S&R#j(lQ&c$PQ&d$RQ&e$TQ'_$|Q'i%RQ'o%]Q(R%kQ(U%mQ(_%wQ(h&]S(k&a,wQ(p&lQ(q&mQ(x&tQ)]'SQ)`'VQ)n'aQ)q'eQ)v'gQ)w'hS)x'l,xQ*W(YQ*[(]Q+Y)jQ+])rQ+_)uQ+g*]Q+i*eQ+{+SQ,Q+ZQ,R+[Q,T+`Q,X+eQ,a+|Q,b,PR,l,cbTOr#j#m$m&a'Q'l*w#p!uXYZhv|}!R!S!T!X!j!l#]$P$R$T$W$k$|%R%]%_%f%k%m%w&]&l&m&t&{'S'V'a'b'e'g'h's(Y(](l({)T)j)r)u){*O*]*e+S+Z+[+`+e+|,P,c,w,xQ#wtW%V!o!s,r,{Q%W!pQ%X!qQ%Z!tQ%e,qS'k%Y,vQ'm,sQ'n,tQ+a)|Q,W+bS,e,U,oR,}-PU#{u,g-OR(i&_[gOr#m$m'Q*wX!xX#]$T$WQ#VZQ$QvR$Z|Q%a!yQ%h!|Q%n#QQ'_$zQ'z%dQ(Q%iQ(X%oQ([%pQ*U(UQ,V+aQ,i,WR,n,hQ$YxQ'v%bR)}'wQ,h,UR,p,oR#PYR#UZR%P!jQ$}!jR)o'bR%S!lR%x#]Q(b%xR*c(cQ$d!RQ&i$WQ)S&{R*t)TQ#qlQ$]!OQ$`!PR&q$_Q(r&pQ*i(tQ*j(uR+n*kR$b!QXpOr'Q*wQ$i!UR&|$jQ$p!XR&}$kR)i'ZQ)g'ZR+}+V",nodeNames:"⚠ print Comment Script AssignStatement * BinaryExpression BitOp BitOp BitOp BitOp ArithOp ArithOp @ ArithOp ** UnaryExpression ArithOp BitOp AwaitExpression await ParenthesizedExpression ( BinaryExpression or and CompareOp in not is UnaryExpression ConditionalExpression if else LambdaExpression lambda ParamList self VariableName AssignOp , : NamedExpression AssignOp YieldExpression yield from ) TupleExpression ComprehensionExpression async for LambdaExpression ArrayExpression [ ] ArrayComprehensionExpression DictionaryExpression { } DictionaryComprehensionExpression SetExpression SetComprehensionExpression CallExpression ArgList AssignOp MemberExpression . PropertyName Number String FormatString FormatReplacement FormatConversion FormatSpec ContinuedString Ellipsis None Boolean TypeDef AssignOp UpdateStatement UpdateOp ExpressionStatement DeleteStatement del PassStatement pass BreakStatement break ContinueStatement continue ReturnStatement return YieldStatement PrintStatement RaiseStatement raise ImportStatement import as ScopeStatement global nonlocal AssertStatement assert StatementGroup ; IfStatement Body elif WhileStatement while ForStatement TryStatement try except finally WithStatement with FunctionDefinition def ParamList AssignOp TypeDef ClassDefinition class DecoratedStatement Decorator At",maxTerm:236,nodeProps:[[NodeProp.group,-14,4,81,83,84,86,88,90,92,94,95,96,98,101,104,"Statement Statement",-23,6,16,19,21,37,38,48,49,53,56,57,60,61,62,63,66,69,70,71,75,76,77,78,"Expression",-9,106,108,111,113,114,118,120,125,127,"Statement"]],skippedNodes:[0,2],repeatNodeCount:33,tokenData:"!E}MgR!^OX$}XY%wY[$}[]%w]p$}pq%wqr(crs*Ust2Otu$}uv4Qvw5Uwx5xxyAWyzAtz{Bb{|Cr|}Df}!OES!O!PFZ!P!QKa!Q!RLq!R![!(P![!]!)i!]!^!*m!^!_!+Z!_!`!,k!`!a!-_!a!b$}!b!c!.l!c!d!/b!d!e!1f!e!h!/b!h!i!8O!i!t!/b!t!u!=b!u!w!/b!w!x!?`!x!}!/b!}#O!@t#O#P!Ab#P#Q!Bc#Q#R!CP#R#S!/b#S#T$}#T#U!/b#U#V!1f#V#Y!/b#Y#Z!8O#Z#f!/b#f#g!=b#g#i!/b#i#j!?`#j#o!/b#o#p!Cs#p#q!D[#q#r!EO#r#s!Ea#s$g$}$g~!/b<r%`R%o`%up%r7[%x!b%z#t%iS%lWO#o%i#p#q%i#r~%i7[%nR%r7[O#o%i#p#q%i#r~%iMg&[Z%o`%up%r7[%x!b%z#t%iS%lW$q1sOX%iXY&}Y[%i[]&}]p%ipq&}q#O%i#O#P'w#P#o%i#p#q%i#r~%iHP'UZ%r7[$q1sOX%iXY&}Y[%i[]&}]p%ipq&}q#O%i#O#P'w#P#o%i#p#q%i#r~%iHP'|V%r7[OY%iYZ&}Z]%i]^&}^#o%i#p#q%i#r~%i<u(tY%o`%up%r7[%x!b%z#t%iS%lWO!_%i!_!`)d!`#T%i#T#U)t#U#f%i#f#g)t#g#h)t#h#o%i#p#q%i#r~%i7_)kRjR%r7[O#o%i#p#q%i#r~%i7_){R!kR%r7[O#o%i#p#q%i#r~%iG{*e]%vp%o`%r7[%x!b%iS%g,XOY+^YZ.{Z]+^]^.{^r+^rs/]s#O+^#O#P0|#P#o+^#o#p1b#p#q+^#q#r1b#r~+^Bm+g]%r7[%lW%g,XOY,`YZ%iZ],`]^%i^r,`rs-`s#O,`#O#P-p#P#o,`#o#p.U#p#q,`#q#r.U#r~,`Be,g]%r7[%g,XOY,`YZ%iZ],`]^%i^r,`rs-`s#O,`#O#P-p#P#o,`#o#p.U#p#q,`#q#r.U#r~,`Be-gR%r7[%g,XO#o%i#p#q%i#r~%iBe-uT%r7[O#o,`#o#p.U#p#q,`#q#r.U#r~,`,X.ZV%g,XOY.UZ].U^r.Urs.ps#O.U#O#P.u#P~.U,X.uO%g,X,X.xPO~.U7d/SR%r7[%lWO#o%i#p#q%i#r~%iEc/dX%r7[%g,XOr.{rs0Ps#O.{#O#P0c#P#o.{#o#p0w#p#q.{#q#r0w#r~.{Ec0YR%m#|%r7[%k,XO#o%i#p#q%i#r~%i7d0hT%r7[O#o.{#o#p0w#p#q.{#q#r0w#r~.{W0|O%lWBm1RT%r7[O#o+^#o#p1b#p#q+^#q#r1b#r~+^,a1iV%lW%g,XOY.UZ].U^r.Urs.ps#O.U#O#P.u#P~.UMg2cXQ1s%o`%up%r7[%x!b%z#t%iS%lWOY3OYZ%iZ]3O]^%i^#o3O#o#p3r#p#q3O#q#r3r#r~3OHP3VXQ1s%r7[OY3OYZ%iZ]3O]^%i^#o3O#o#p3r#p#q3O#q#r3r#r~3O1s3wRQ1sOY3rZ]3r^~3rGz4eT%PQ%o`%up%r7[%x!b%z#t%iS%lWO!_%i!_!`4t!`#o%i#p#q%i#r~%iBd4{R!t,W%r7[O#o%i#p#q%i#r~%iGz5iT$yQ%o`%up%r7[%x!b%z#t%iS%lWO!_%i!_!`4t!`#o%i#p#q%i#r~%iG{6X_%s`%up%r7[%z#t%lW%g,XOY7WYZ:dZ]7W]^:d^r7Wrs:xsw7Wwx;|x#O7W#O#P>n#P#o7W#o#p?t#p#q7W#q#r?S#r~7WFq7e]%r7[%x!b%z#t%iS%g,XOY8^YZ%iZ]8^]^%i^w8^wx-`x#O8^#O#P9^#P#o8^#o#p9r#p#q8^#q#r9r#r~8^Be8e]%r7[%g,XOY8^YZ%iZ]8^]^%i^w8^wx-`x#O8^#O#P9^#P#o8^#o#p9r#p#q8^#q#r9r#r~8^Be9cT%r7[O#o8^#o#p9r#p#q8^#q#r9r#r~8^,X9wV%g,XOY9rZ]9r^w9rwx.px#O9r#O#P:^#P~9r,X:aPO~9r;h:oR%r7[%x!b%z#t%iSO#o%i#p#q%i#r~%iC{;T]%r7[%x!b%iS%g,XOY8^YZ%iZ]8^]^%i^w8^wx-`x#O8^#O#P9^#P#o8^#o#p9r#p#q8^#q#r9r#r~8^Fq<VZ%r7[%z#t%g,XOr:drs<xsw:dwx=[x#O:d#O#P=p#P#o:d#o#p>_#p#q:d#q#r>U#r~:d8r=RR%r7[%x!b%iSO#o%i#p#q%i#r~%iFq=gR%j!f%r7[%z#t%h,XO#o%i#p#q%i#r~%i;h=uT%r7[O#o:d#o#p>U#p#q:d#q#r>U#r~:d%[>_O%x!b%z#t%iS%[>dP%iS#o#p>g%W>nO%x!b%z#tFq>sT%r7[O#o7W#o#p?S#p#q7W#q#r?S#r~7W0e?_V%x!b%z#t%iS%g,XOY9rZ]9r^w9rwx.px#O9r#O#P:^#P~9r0e?{X%iS%g,XOY9rZ]9r^w9rwx.px#O9r#O#P:^#P#o9r#o#p@h#p~9r0a@qV%x!b%z#t%g,XOY9rZ]9r^w9rwx.px#O9r#O#P:^#P~9rG{AkRf,X%o`%up%r7[%x!b%z#t%iS%lWO#o%i#p#q%i#r~%i<uBXR!PR%o`%up%r7[%x!b%z#t%iS%lWO#o%i#p#q%i#r~%iG{BuVT,X%o`%up%r7[%x!b%z#t%iS%lWOz%iz{C[{!_%i!_!`4t!`#o%i#p#q%i#r~%iBeCcT_R%r7[O!_%i!_!`4t!`#o%i#p#q%i#r~%iG{DVT$|,X%o`%up%r7[%x!b%z#t%iS%lWO!_%i!_!`4t!`#o%i#p#q%i#r~%iG{DyRx,X%o`%up%r7[%x!b%z#t%iS%lWO#o%i#p#q%i#r~%iMgEgU$},X%o`%up%r7[%x!b%z#t%iS%lWO!_%i!_!`4t!`!aEy!a#o%i#p#q%i#r~%i<vFQR&U&j%r7[O#o%i#p#q%i#r~%iG{FnV!eQ%o`%up%r7[%x!b%z#t%iS%lWO!O%i!O!PGT!P!Q%i!Q![Gy![#o%i#p#q%i#r~%iBeGYT%r7[O!O%i!O!PGi!P#o%i#p#q%i#r~%iBeGpR!n,X%r7[O#o%i#p#q%i#r~%iBcHQ_!g,V%r7[O!Q%i!Q![Gy![!g%i!g!hIP!h!l%i!l!mKP!m#R%i#R#SGy#S#X%i#X#YIP#Y#^%i#^#_KP#_#o%i#p#q%i#r~%iBcIUX%r7[O{%i{|Iq|}%i}!OIq!O!Q%i!Q![JV![#o%i#p#q%i#r~%iBcIvT%r7[O!Q%i!Q![JV![#o%i#p#q%i#r~%iBcJ^Z!g,V%r7[O!Q%i!Q![JV![!l%i!l!mKP!m#R%i#R#SJV#S#^%i#^#_KP#_#o%i#p#q%i#r~%iBcKWR!g,V%r7[O#o%i#p#q%i#r~%iG{KtV%OR%o`%up%r7[%x!b%z#t%iS%lWO!P%i!P!QLZ!Q!_%i!_!`4t!`#o%i#p#q%i#r~%iBdLbT%QQ%r7[O!_%i!_!`4t!`#o%i#p#q%i#r~%iGyMUm!g,V%o`%up%r7[%x!b%z#t%iS%lWO!O%i!O!P! P!P!Q%i!Q![!!k![!d%i!d!e!#w!e!g%i!g!hIP!h!l%i!l!mKP!m!q%i!q!r!%V!r!z%i!z!{!&_!{#R%i#R#S!!k#S#U%i#U#V!#w#V#X%i#X#YIP#Y#^%i#^#_KP#_#c%i#c#d!%V#d#l%i#l#m!&_#m#o%i#p#q%i#r~%iBc! UT%r7[O!Q%i!Q![! e![#o%i#p#q%i#r~%iBc! l_!g,V%r7[O!Q%i!Q![! e![!g%i!g!hIP!h!l%i!l!mKP!m#R%i#R#S! e#S#X%i#X#YIP#Y#^%i#^#_KP#_#o%i#p#q%i#r~%iBc!!ra!g,V%r7[O!O%i!O!P! P!P!Q%i!Q![!!k![!g%i!g!hIP!h!l%i!l!mKP!m#R%i#R#S!!k#S#X%i#X#YIP#Y#^%i#^#_KP#_#o%i#p#q%i#r~%iBc!#|W%r7[O!Q%i!Q!R!$f!R!S!$f!S#R%i#R#S!$f#S#o%i#p#q%i#r~%iBc!$mW!g,V%r7[O!Q%i!Q!R!$f!R!S!$f!S#R%i#R#S!$f#S#o%i#p#q%i#r~%iBc!%[V%r7[O!Q%i!Q!Y!%q!Y#R%i#R#S!%q#S#o%i#p#q%i#r~%iBc!%xV!g,V%r7[O!Q%i!Q!Y!%q!Y#R%i#R#S!%q#S#o%i#p#q%i#r~%iBc!&dZ%r7[O!Q%i!Q![!'V![!c%i!c!i!'V!i#R%i#R#S!'V#S#T%i#T#Z!'V#Z#o%i#p#q%i#r~%iBc!'^Z!g,V%r7[O!Q%i!Q![!'V![!c%i!c!i!'V!i#R%i#R#S!'V#S#T%i#T#Z!'V#Z#o%i#p#q%i#r~%iGy!(da!g,V%o`%up%r7[%x!b%z#t%iS%lWO!O%i!O!P! P!P!Q%i!Q![!!k![!g%i!g!hIP!h!l%i!l!mKP!m#R%i#R#S!!k#S#X%i#X#YIP#Y#^%i#^#_KP#_#o%i#p#q%i#r~%iMg!)|Ty1s%o`%up%r7[%x!b%z#t%iS%lWO!_%i!_!`!*]!`#o%i#p#q%i#r~%i7_!*dR%YR%r7[O#o%i#p#q%i#r~%iG{!+QR#_,X%o`%up%r7[%x!b%z#t%iS%lWO#o%i#p#q%i#r~%iG{!+nVjR%o`%up%r7[%x!b%z#t%iS%lWO!^%i!^!_!,T!_!`)d!`!a)d!a#o%i#p#q%i#r~%iBd!,[T$zQ%r7[O!_%i!_!`4t!`#o%i#p#q%i#r~%iG{!-OT%X,X%o`%up%r7[%x!b%z#t%iS%lWO!_%i!_!`)d!`#o%i#p#q%i#r~%iG{!-rUjR%o`%up%r7[%x!b%z#t%iS%lWO!_%i!_!`)d!`!a!.U!a#o%i#p#q%i#r~%iBd!.]T${Q%r7[O!_%i!_!`4t!`#o%i#p#q%i#r~%iG{!/RT]Q#uP%o`%up%r7[%x!b%z#t%iS%lWO!_%i!_!`4t!`#o%i#p#q%i#r~%iMg!/wZ%o`%up%r7[%x!b%z#t%iS%lW%f&j%S,XO!Q%i!Q![!0j![!c%i!c!}!0j!}#R%i#R#S!0j#S#T%i#T#o!0j#p#q%i#r$g%i$g~!0jHP!0sZ%r7[%f&j%S,XO!Q%i!Q![!0j![!c%i!c!}!0j!}#R%i#R#S!0j#S#T%i#T#o!0j#p#q%i#r$g%i$g~!0jMg!1{c%o`%up%r7[%x!b%z#t%iS%lW%f&j%S,XOr%irs!3Wsw%iwx!5Ox!Q%i!Q![!0j![!c%i!c!t!0j!t!u!6v!u!}!0j!}#R%i#R#S!0j#S#T%i#T#f!0j#f#g!6v#g#o!0j#p#q%i#r$g%i$g~!0jBe!3_]%r7[%g,XOY,`YZ%iZ],`]^%i^r,`rs!4Ws#O,`#O#P-p#P#o,`#o#p.U#p#q,`#q#r.U#r~,`Be!4_T%r7[%g,XOr%irs!4ns#o%i#p#q%i#r~%iBe!4uR%r7[%k,XO#o%i#p#q%i#r~%iBe!5V]%r7[%g,XOY8^YZ%iZ]8^]^%i^w8^wx!6Ox#O8^#O#P9^#P#o8^#o#p9r#p#q8^#q#r9r#r~8^Be!6VT%r7[%g,XOw%iwx!6fx#o%i#p#q%i#r~%iBe!6mR%r7[%h,XO#o%i#p#q%i#r~%iHP!7P_%r7[%f&j%S,XOr%irs!3Wsw%iwx!5Ox!Q%i!Q![!0j![!c%i!c!}!0j!}#R%i#R#S!0j#S#T%i#T#o!0j#p#q%i#r$g%i$g~!0jMg!8ec%o`%up%r7[%x!b%z#t%iS%lW%f&j%S,XOr%irs!9psw%iwx!:|x!Q%i!Q![!0j![!c%i!c!t!0j!t!u!<Y!u!}!0j!}#R%i#R#S!0j#S#T%i#T#f!0j#f#g!<Y#g#o!0j#p#q%i#r$g%i$g~!0jBe!9wT%r7[%t,XOr%irs!:Ws#o%i#p#q%i#r~%iBe!:]T%r7[Or%irs!:ls#o%i#p#q%i#r~%iBe!:sR%r7[%y,XO#o%i#p#q%i#r~%iBe!;TT%r7[%n,XOw%iwx!;dx#o%i#p#q%i#r~%iBe!;iT%r7[Ow%iwx!;xx#o%i#p#q%i#r~%iBe!<PR%r7[%w,XO#o%i#p#q%i#r~%iHP!<c_%r7[%f&j%S,XOr%irs!9psw%iwx!:|x!Q%i!Q![!0j![!c%i!c!}!0j!}#R%i#R#S!0j#S#T%i#T#o!0j#p#q%i#r$g%i$g~!0jMg!=wg%o`%up%r7[%x!b%z#t%iS%lW%f&j%S,XOr%irs!3Wsw%iwx!5Ox!Q%i!Q![!0j![!c%i!c!h!0j!h!i!<Y!i!t!0j!t!u!6v!u!}!0j!}#R%i#R#S!0j#S#T%i#T#U!0j#U#V!6v#V#Y!0j#Y#Z!<Y#Z#o!0j#p#q%i#r$g%i$g~!0jMg!?u_%o`%up%r7[%x!b%z#t%iS%lW%f&j%S,XOr%irs!3Wsw%iwx!5Ox!Q%i!Q![!0j![!c%i!c!}!0j!}#R%i#R#S!0j#S#T%i#T#o!0j#p#q%i#r$g%i$g~!0jG{!AXR!W,X%o`%up%r7[%x!b%z#t%iS%lWO#o%i#p#q%i#r~%iMg!AgX%r7[OY$}YZ%wZ]$}]^%w^#o$}#o#p!BS#p#q$}#q#r!BS#r~$}&f!BcO%o`%up%x!b%z#t%iS%lW<u!BvR!XR%o`%up%r7[%x!b%z#t%iS%lWO#o%i#p#q%i#r~%iGz!CdT$xQ%o`%up%r7[%x!b%z#t%iS%lWO!_%i!_!`4t!`#o%i#p#q%i#r~%iGy!C|P![Gm%iS%lW#o#p!DP&Y!D[O%o`%up%x!b%z#tGz!DoT$wQ%o`%up%r7[%x!b%z#t%iS%lWO!_%i!_!`4t!`#o%i#p#q%i#r~%i<u!EaO!]7_%o`%up%x!b%z#t%iS%lWGy!EtR%R,V%o`%up%r7[%x!b%z#t%iS%lWO#o%i#p#q%i#r~%i",tokenizers:[legacyPrint,0,1,2,3,4,5,6,7,8,9,10,newlines,bodyContinue],topRules:{Script:[0,3]},specialized:[{term:188,get:function(e){return spec_identifier[e]||-1}}],tokenPrec:6067});var indentNodeProp=new NodeProp;function syntaxIndentation(e){return EditorState.indentation.of((function(t,r){return computeIndentation(t,e.getTree(t.state),r)}))}function computeIndentation(e,t,r){var n=t.resolve(r);for(var i=n,o=r;;){var a=i.childBefore(o);if(!a)break;if(a.type.isError&&a.from==a.to){n=i;o=a.from}else{i=a;o=i.to+1}}for(;n;n=n.parent){var s=indentStrategy(n);if(s)return s(new TreeIndentContext(e,r,n))}return-1}function ignoreClosed(e){var t,r;return e.pos==((t=e.options)===null||t===void 0?void 0:t.simulateBreak)&&((r=e.options)===null||r===void 0?void 0:r.simulateDoubleBreak)}function indentStrategy(e){var t=e.type.prop(indentNodeProp);if(t)return t;var r=e.firstChild,n;if(r&&(n=r.type.prop(NodeProp.closedBy))){var i=e.lastChild,o=i&&n.indexOf(i.name)>-1;return function(e){return delimitedStrategy(e,true,1,undefined,o&&!ignoreClosed(e)?i.from:undefined)}}return e.parent==null?topIndent:null}function topIndent(){return 0}var TreeIndentContext=function(e){__extends(t,e);function t(t,r,n){var i=e.call(this,t.state,t.options)||this;i.pos=r;i.node=n;return i}Object.defineProperty(t.prototype,"textAfter",{get:function(){return this.textAfterPos(this.pos)},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"baseIndent",{get:function(){var e=this.state.doc.lineAt(this.node.from);for(;;){var t=this.node.resolve(e.from);while(t.parent&&t.parent.from==t.from)t=t.parent;if(isParent(t,this.node))break;e=this.state.doc.lineAt(t.from)}return this.lineIndent(e)},enumerable:false,configurable:true});return t}(IndentContext);function isParent(e,t){for(var r=t;r;r=r.parent)if(e==r)return true;return false}function bracketedAligned(e){var t;var r=e.node;var n=r.childAfter(r.from),i=r.lastChild;if(!n)return null;var o=(t=e.options)===null||t===void 0?void 0:t.simulateBreak;var a=e.state.doc.lineAt(n.from);var s=o==null||o<=a.from?a.to:Math.min(a.to,o);for(var l=n.to;;){var c=r.childAfter(l);if(!c||c==i)return null;if(!c.type.isSkipped)return c.from<s?n:null;l=c.to}}function delimitedStrategy(e,t,r,n,i){var o=e.textAfter,a=o.match(/^\s*/)[0].length;var s=n&&o.slice(a,a+n.length)==n||i==e.pos+a;var l=t?bracketedAligned(e):null;if(l)return s?e.column(l.from):e.column(l.to);return e.baseIndent+(s?0:e.unit*r)}function continuedIndent(e){var t=e===void 0?{}:e,r=t.except,n=t.units,i=n===void 0?1:n;return function(e){var t=r&&r.test(e.textAfter);return e.baseIndent+(t?0:i*e.unit)}}var foldNodeProp=new NodeProp;function syntaxFolding(e){return EditorState.foldable.of((function(t,r,n){var i=e.getTree(t).resolve(n);var o=null;for(var a=i;a;a=a.parent){if(a.to<=n||a.from>n)continue;if(o&&a.from<r)break;var s=a.type.prop(foldNodeProp);if(s){var l=s(a,t);if(l&&l.from<=n&&l.from>=r&&l.to>n)o=l}}return o}))}var LezerSyntax=function(){function e(e,t,r){var n=this;this.parser=e;this.dialect=t;this.languageData=r;var i=StateEffect.define();this.field=StateField.define({create:function(e){return SyntaxState.advance(Tree.empty,n,e.doc)},update:function(e,t){return e.apply(t,n,i)}});this.extension=[EditorState.syntax.of(this),this.field,ViewPlugin.define((function(e){return new HighlightWorker(e,n,i)})),syntaxIndentation(this),syntaxFolding(this)]}e.define=function(t,r){var n;if(r===void 0){r={}}var i=Facet.define({combine:r.languageData?function(e){return e.concat(r.languageData)}:undefined});return new e(t.withProps(languageDataProp.add((n={},n[t.topType.name]=i,n))),r.dialect||"",i)};e.prototype.withDialect=function(t){return new e(this.parser,t,this.languageData)};e.prototype.getTree=function(e){return e.field(this.field).tree};e.prototype.parsePos=function(e){return e.field(this.field).upto};e.prototype.ensureTree=function(e,t,r){if(r===void 0){r=100}var n=e.field(this.field);if(n.upto>=t)return n.updatedTree;if(!n.parse)n.startParse(this,e.doc);if(n.parse.pos<t){var i=work(n.parse,r,t);if(i)return n.stopParse(i,e.doc.length)}return n.parse.pos<t?null:n.stopParse()};e.prototype.languageDataFacetAt=function(e,t){if(this.parser.hasNested){var r=this.getTree(e);var n=r.resolve(t,-1);while(n){var i=n.type.prop(languageDataProp);if(i)return i;n=n.parent}}return this.languageData};return e}();var DocStream=function(){function e(e,t){if(t===void 0){t=e.length}this.doc=e;this.length=t;this.cursorPos=0;this.string="";this.cursor=e.iter()}e.prototype.get=function(e){if(e>=this.length)return-1;var t=this.cursorPos-this.string.length;if(e<t||e>=this.cursorPos){if(e<this.cursorPos){this.cursor=this.doc.iter();this.cursorPos=0}this.string=this.cursor.next(e-this.cursorPos).value;this.cursorPos=e+this.string.length;t=this.cursorPos-this.string.length}return this.string.charCodeAt(e-t)};e.prototype.read=function(e,t){var r=this.cursorPos-this.string.length;if(e<r||t>=this.cursorPos)return this.doc.sliceString(e,t);else return this.string.slice(e-r,t-r)};e.prototype.clip=function(t){return new e(this.doc,t)};return e}();function work(e,t,r){if(r===void 0){r=5e6}var n=Date.now()+t;for(;;){var i=e.advance();if(i)return i;if(e.pos>r||Date.now()>n)return null}}function takeTree(e,t){var r=e.forceFinish();var n=r.applyChanges([{fromA:e.pos,toA:r.length,fromB:e.pos,toB:r.length}]).append(t.applyChanges([{fromA:0,toA:e.pos,fromB:0,toB:e.pos}]));return{parsed:r,cache:n}}var SyntaxState=function(){function e(e,t,r){this.tree=e;this.upto=t;this.cache=r;this.parse=null;this.updatedTree=e}e.advance=function(t,r,n){var i=r.parser.startParse(new DocStream(n),{cache:t,dialect:r.dialect});var o=work(i,25);if(o)return new e(o,n.length,o);var a=takeTree(i,t);return new e(a.parsed,i.pos,a.cache)};e.prototype.apply=function(t,r,n){for(var i=0,o=t.effects;i<o.length;i++){var a=o[i];if(a.is(n))return a.value}if(!t.docChanged)return this;var s=[];t.changes.iterChangedRanges((function(e,t,r,n){return s.push({fromA:e,toA:t,fromB:r,toB:n})}));return e.advance((this.parse?takeTree(this.parse,this.updatedTree).cache:this.cache).applyChanges(s),r,t.state.doc)};e.prototype.startParse=function(e,t){this.parse=e.parser.startParse(new DocStream(t),{cache:this.cache,dialect:e.dialect})};e.prototype.stopParse=function(e,t){var r;if(!e)r=takeTree(this.parse,this.updatedTree),e=r.parsed,this.cache=r.cache;else this.cache=e;this.updatedTree=e;this.upto=t!==null&&t!==void 0?t:this.parse.pos;this.parse=null;return e};return e}();var requestIdle=typeof window!="undefined"&&window.requestIdleCallback||function(e,t){var r=t.timeout;return setTimeout(e,r)};var cancelIdle=typeof window!="undefined"&&window.cancelIdleCallback||clearTimeout;var HighlightWorker=function(){function e(e,t,r){this.view=e;this.syntax=t;this.setSyntax=r;this.working=-1;this.work=this.work.bind(this);this.scheduleWork()}e.prototype.update=function(e){if(e.docChanged)this.scheduleWork()};e.prototype.scheduleWork=function(){if(this.working>-1)return;var e=this.view.state,t=e.field(this.syntax.field);if(t.upto>=e.doc.length)return;this.working=requestIdle(this.work,{timeout:200})};e.prototype.work=function(e){this.working=-1;var t=this.view.state,r=t.field(this.syntax.field);if(r.upto>=t.doc.length)return;if(!r.parse)r.startParse(this.syntax,t.doc);var n=work(r.parse,e?Math.max(25,e.timeRemaining()):100);if(n||r.parse.badness>.8){var i=r.stopParse(n,t.doc.length);this.view.dispatch({effects:this.setSyntax.of(new SyntaxState(i,t.doc.length,r.cache))})}else{this.scheduleWork()}};e.prototype.destroy=function(){if(this.working>=0)cancelIdle(this.working)};return e}();var pythonSyntax=LezerSyntax.define(parser.withProps(indentNodeProp.add({Body:continuedIndent()}),foldNodeProp.add({Body:function(e){return{from:e.from+1,to:e.to-1}},ArrayExpression:function(e){return{from:e.from+1,to:e.to-1}},DictionaryExpression:function(e){return{from:e.from+1,to:e.to-1}}}),styleTags({"async * ** FormatConversion":"modifier","for while if elif else try except finally return raise break continue with pass assert await yield":"keyword control","in not and or is del":"operatorKeyword","import from def class global nonlocal lambda":"keyword definition","with as print":"keyword",self:"self",Boolean:"bool",None:"null",VariableName:"variableName",PropertyName:"propertyName",Comment:"lineComment",Number:"number",String:"string",FormatString:"string#2",UpdateOp:"updateOperator",ArithOp:"arithmeticOperator",BitOp:"bitwiseOperator",CompareOp:"compareOperator",AssignOp:"operator definition",Ellipsis:"punctuation",At:"punctuation meta","( )":"paren","[ ]":"squareBracket","{ }":"brace",".":"derefOperator",", ;":"separator"})),{languageData:{closeBrackets:{brackets:["(","[","{","'",'"',"'''",'"""']},commentTokens:{line:"#"},indentOnInput:/^\s*[\}\]\)]$/}});function python(){return pythonSyntax}function deleteBy$1(e,t){var r=e.state;var n=r.changeByRange((function(e){var r=e.from,n=e.to;if(r===n){var i=t(r);r=Math.min(r,i);n=Math.max(n,i)}return r===n?{range:e}:{changes:{from:r,to:n},range:EditorSelection.cursor(r)}}));if(n.changes.empty)return false;e.dispatch(e.state.update(n,{scrollIntoView:true,annotations:Transaction.userEvent.of("delete")}));return true}var deleteToLineStart=function(e){return deleteBy$1(e,(function(t){var r=e.visualLineAt(t).from;if(t>r)return r;return Math.max(0,e.visualLineAt(t-1).to)}))};var defaultEditorCss="*.sc-stencila-editor-default,.sc-stencila-editor-default:after,.sc-stencila-editor-default:before{-webkit-box-sizing:border-box;box-sizing:border-box;border:0 solid}html.sc-stencila-editor-default{font-size:16px}.hidden.sc-stencila-editor-default{display:none}.sc-stencila-editor-default-h,stencila-editor.sc-stencila-editor-default{--line-number-background:var(--color-background,var(--color-neutral-200,#edf2f7));all:initial;display:-ms-flexbox;display:flex;max-width:100%;--border-width:1px;--background-color:transparent}.sc-stencila-editor-default-h .editorContainer.sc-stencila-editor-default,stencila-editor.sc-stencila-editor-default .editorContainer.sc-stencila-editor-default{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-positive:1;flex-grow:1;max-width:100%;border-width:1px;border-radius:.25rem;border-color:#e2e8f0;border-color:var(--color-neutral-300,#e2e8f0);background-color:var(--background-color);border-width:var(--border-width)}.sc-stencila-editor-default-h .editorContainer.sc-stencila-editor-default:focus-within,stencila-editor.sc-stencila-editor-default .editorContainer.sc-stencila-editor-default:focus-within{-webkit-box-shadow:inset 0 0 0 2px var(--color-neutral-400);box-shadow:inset 0 0 0 2px var(--color-neutral-400)}.sc-stencila-editor-default-h .editor.sc-stencila-editor-default,stencila-editor.sc-stencila-editor-default .editor.sc-stencila-editor-default{-ms-flex-positive:1;flex-grow:1;max-width:100%;overflow:auto;font-family:monospace;font-family:var(--font-family-mono,monospace);cursor:text}.sc-stencila-editor-default-h.sc-stencila-editor-default-s>.editorContainer .codemirror-content *,.sc-stencila-editor-default-h.sc-stencila-editor-default-s>.editorContainer .gutterElement *,stencila-editor.sc-stencila-editor-default-s>.editorContainer .codemirror-content *,stencila-editor.sc-stencila-editor-default-s>.editorContainer .gutterElement *{font-family:monospace;font-family:var(--font-family-mono,monospace);font-size:.875rem}.sc-stencila-editor-default-h.sc-stencila-editor-default-s>.editorContainer .codemirror-focused,stencila-editor.sc-stencila-editor-default-s>.editorContainer .codemirror-focused{outline:2px solid transparent;outline-offset:2px}.sc-stencila-editor-default-h.sc-stencila-editor-default-s>.editorContainer .codemirror-scroller,stencila-editor.sc-stencila-editor-default-s>.editorContainer .codemirror-scroller{overflow:auto}.sc-stencila-editor-default-h.sc-stencila-editor-default-s>.editorContainer .cm-gutters,stencila-editor.sc-stencila-editor-default-s>.editorContainer .cm-gutters{background-color:var(--line-number-background)}.sc-stencila-editor-default-h menu.sc-stencila-editor-default,stencila-editor.sc-stencila-editor-default menu.sc-stencila-editor-default{display:-ms-flexbox;display:flex;-ms-flex-pack:end;justify-content:flex-end;padding:1px 0;margin:0;border-top-width:1px;border-color:#e2e8f0;border-color:var(--color-neutral-300,#e2e8f0)}.sc-stencila-editor-default-h menu.sc-stencila-editor-default stencila-icon.sc-stencila-editor-default,stencila-editor.sc-stencila-editor-default menu.sc-stencila-editor-default stencila-icon.sc-stencila-editor-default{--height:1em;--width:1em;margin-right:.25rem}.sc-stencila-editor-default-h menu.sc-stencila-editor-default select.sc-stencila-editor-default,stencila-editor.sc-stencila-editor-default menu.sc-stencila-editor-default select.sc-stencila-editor-default{margin-right:.5rem;font-size:.75rem;text-align:left;background-color:transparent;border-style:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;color:#4a5568;color:var(--color-neutral-700,#4a5568);font-family:sans-serif;font-family:var(--font-family-body,sans-serif)}.sc-stencila-editor-default-h menu.sc-stencila-editor-default select.sc-stencila-editor-default option.sc-stencila-editor-default,stencila-editor.sc-stencila-editor-default menu.sc-stencila-editor-default select.sc-stencila-editor-default option.sc-stencila-editor-default{text-align:right;font-family:sans-serif;font-family:var(--font-family-body,sans-serif)}.sc-stencila-editor-default-h menu.sc-stencila-editor-default select.sc-stencila-editor-default:active,.sc-stencila-editor-default-h menu.sc-stencila-editor-default select.sc-stencila-editor-default:focus,.sc-stencila-editor-default-h menu.sc-stencila-editor-default select.sc-stencila-editor-default:hover,stencila-editor.sc-stencila-editor-default menu.sc-stencila-editor-default select.sc-stencila-editor-default:active,stencila-editor.sc-stencila-editor-default menu.sc-stencila-editor-default select.sc-stencila-editor-default:focus,stencila-editor.sc-stencila-editor-default menu.sc-stencila-editor-default select.sc-stencila-editor-default:hover{color:#1a202c;color:var(--color-neutral-900,#1a202c)}";var editorMaterialCss="*.sc-stencila-editor-material,.sc-stencila-editor-material:after,.sc-stencila-editor-material:before{-webkit-box-sizing:border-box;box-sizing:border-box;border:0 solid}html.sc-stencila-editor-material{font-size:16px}.hidden.sc-stencila-editor-material{display:none}.sc-stencila-editor-material-h,stencila-editor.sc-stencila-editor-material{--line-number-background:var(--color-background,var(--color-neutral-200,#edf2f7));all:initial;display:-ms-flexbox;display:flex;max-width:100%;--border-width:1px;--background-color:transparent}.sc-stencila-editor-material-h .editorContainer.sc-stencila-editor-material,stencila-editor.sc-stencila-editor-material .editorContainer.sc-stencila-editor-material{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-positive:1;flex-grow:1;max-width:100%;border-width:1px;border-radius:.25rem;border-color:#e2e8f0;border-color:var(--color-neutral-300,#e2e8f0);background-color:var(--background-color);border-width:var(--border-width)}.sc-stencila-editor-material-h .editorContainer.sc-stencila-editor-material:focus-within,stencila-editor.sc-stencila-editor-material .editorContainer.sc-stencila-editor-material:focus-within{-webkit-box-shadow:inset 0 0 0 2px var(--color-neutral-400);box-shadow:inset 0 0 0 2px var(--color-neutral-400)}.sc-stencila-editor-material-h .editor.sc-stencila-editor-material,stencila-editor.sc-stencila-editor-material .editor.sc-stencila-editor-material{-ms-flex-positive:1;flex-grow:1;max-width:100%;overflow:auto;font-family:monospace;font-family:var(--font-family-mono,monospace);cursor:text}.sc-stencila-editor-material-h.sc-stencila-editor-material-s>.editorContainer .codemirror-content *,.sc-stencila-editor-material-h.sc-stencila-editor-material-s>.editorContainer .gutterElement *,stencila-editor.sc-stencila-editor-material-s>.editorContainer .codemirror-content *,stencila-editor.sc-stencila-editor-material-s>.editorContainer .gutterElement *{font-family:monospace;font-family:var(--font-family-mono,monospace);font-size:.875rem}.sc-stencila-editor-material-h.sc-stencila-editor-material-s>.editorContainer .codemirror-focused,stencila-editor.sc-stencila-editor-material-s>.editorContainer .codemirror-focused{outline:2px solid transparent;outline-offset:2px}.sc-stencila-editor-material-h.sc-stencila-editor-material-s>.editorContainer .codemirror-scroller,stencila-editor.sc-stencila-editor-material-s>.editorContainer .codemirror-scroller{overflow:auto}.sc-stencila-editor-material-h.sc-stencila-editor-material-s>.editorContainer .cm-gutters,stencila-editor.sc-stencila-editor-material-s>.editorContainer .cm-gutters{background-color:var(--line-number-background)}.sc-stencila-editor-material-h menu.sc-stencila-editor-material,stencila-editor.sc-stencila-editor-material menu.sc-stencila-editor-material{display:-ms-flexbox;display:flex;-ms-flex-pack:end;justify-content:flex-end;padding:1px 0;margin:0;border-top-width:1px;border-color:#e2e8f0;border-color:var(--color-neutral-300,#e2e8f0)}.sc-stencila-editor-material-h menu.sc-stencila-editor-material stencila-icon.sc-stencila-editor-material,stencila-editor.sc-stencila-editor-material menu.sc-stencila-editor-material stencila-icon.sc-stencila-editor-material{--height:1em;--width:1em;margin-right:.25rem}.sc-stencila-editor-material-h menu.sc-stencila-editor-material select.sc-stencila-editor-material,stencila-editor.sc-stencila-editor-material menu.sc-stencila-editor-material select.sc-stencila-editor-material{margin-right:.5rem;font-size:.75rem;text-align:left;background-color:transparent;border-style:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;color:#4a5568;color:var(--color-neutral-700,#4a5568);font-family:sans-serif;font-family:var(--font-family-body,sans-serif)}.sc-stencila-editor-material-h menu.sc-stencila-editor-material select.sc-stencila-editor-material option.sc-stencila-editor-material,stencila-editor.sc-stencila-editor-material menu.sc-stencila-editor-material select.sc-stencila-editor-material option.sc-stencila-editor-material{text-align:right;font-family:sans-serif;font-family:var(--font-family-body,sans-serif)}.sc-stencila-editor-material-h menu.sc-stencila-editor-material select.sc-stencila-editor-material:active,.sc-stencila-editor-material-h menu.sc-stencila-editor-material select.sc-stencila-editor-material:focus,.sc-stencila-editor-material-h menu.sc-stencila-editor-material select.sc-stencila-editor-material:hover,stencila-editor.sc-stencila-editor-material menu.sc-stencila-editor-material select.sc-stencila-editor-material:active,stencila-editor.sc-stencila-editor-material menu.sc-stencila-editor-material select.sc-stencila-editor-material:focus,stencila-editor.sc-stencila-editor-material menu.sc-stencila-editor-material select.sc-stencila-editor-material:hover{color:#1a202c;color:var(--color-neutral-900,#1a202c)}";var slots$1={text:"text"};var cssClasses={container:"editorContainer",editor:"editor"};var cssIds={editorTarget:"editorTarget"};var Editor=function(){function e(e){var t=this;registerInstance(this,e);var r,n;this.languageCapabilities=["Bash","R","Python"];this.readOnly=false;this.readOnlyTag=Symbol("readOnly");this.setLanguage=function(e){var r=e.currentTarget;t.activeLanguage=r.value.toLowerCase();if(t.onSetLanguage){t.onSetLanguage(r.value)}};this.activeLanguage=(n=(r=this.languageCapabilities[0])===null||r===void 0?void 0:r.toLowerCase())!==null&&n!==void 0?n:"";this.execute=function(){t.getContents().then((function(e){return t.executeHandler?t.executeHandler(e):e})).catch((function(e){console.error(e);return false}));return true};this.autofocus=false;this.lineNumbers=true;this.foldGutter=true;this.keymap=[];this.initCodeMirror=function(){var e,r,n,i;var o=t.el;var a=o.querySelector("[slot]");var s=(n=(e=a===null||a===void 0?void 0:a.textContent)!==null&&e!==void 0?e:(r=o===null||o===void 0?void 0:o.querySelector("#"+cssIds.editorTarget))===null||r===void 0?void 0:r.textContent)!==null&&n!==void 0?n:"";var l=[history(),autocompletion(),bracketMatching(),closeBrackets(),defaultHighlighter,python(),drawSelection(),EditorState.allowMultipleSelections.of(true),highlightSpecialChars(),keymap(__spreadArrays(defaultKeymap,commentKeymap,closeBracketsKeymap,historyKeymap,foldKeymap,[{key:"Ctrl-Space",run:startCompletion},{key:"Mod-Backspace",run:deleteToLineStart},{key:"Shift-Enter",run:t.execute}],t.keymap)),tagExtension(t.readOnlyTag,EditorView.editable.of(!t.readOnly))];if(t.lineNumbers){l.push(lineNumbers())}if(t.foldGutter){l.push(foldGutter())}t.editorRef=new EditorView({state:EditorState.create({doc:s,extensions:l})});return(i=o===null||o===void 0?void 0:o.querySelector("#"+cssIds.editorTarget))===null||i===void 0?void 0:i.replaceWith(t.editorRef.dom)};this.getContent=function(){return t.editorRef.state.doc.toString()};this.stopEventPropagation=function(e){e.stopPropagation()};this.focusEditor=function(){t.editorRef.focus()}}e.prototype.readOnlyChanged=function(e,t){var r;if(e!==t){this.editorRef.dispatch({reconfigure:(r={},r[this.readOnlyTag]=EditorView.editable.of(!this.readOnly),r)})}};e.prototype.getContents=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){return[2,Promise.resolve({text:this.getContent(),language:this.activeLanguage})]}))}))};e.prototype.setContents=function(e){var t=this.editorRef.state;var r=t.update({changes:{from:0,to:t.doc.length,insert:e},scrollIntoView:true});this.editorRef.dispatch(r);return Promise.resolve(e)};e.prototype.componentDidLoad=function(){this.initCodeMirror();if(this.autofocus){this.focusEditor()}};e.prototype.disconnectedCallback=function(){this.editorRef.destroy()};e.prototype.render=function(){var e=this;return h(Host,null,h("div",{class:cssClasses.container},h("div",{class:cssClasses.editor,onKeyDown:this.stopEventPropagation,onClick:this.focusEditor},h("div",{class:"hidden"},h("slot",{name:slots$1.text})),h("div",{id:cssIds.editorTarget})),h("menu",null,h("label",{"aria-label":"Programming Language"},h("stencila-icon",{icon:"terminal"}),h("select",{onChange:this.setLanguage},this.languageCapabilities.map((function(t){return h("option",{value:t.toLowerCase(),selected:t.toLowerCase()===e.activeLanguage},t)})))))))};Object.defineProperty(e.prototype,"el",{get:function(){return getElement(this)},enumerable:false,configurable:true});Object.defineProperty(e,"watchers",{get:function(){return{readOnly:["readOnlyChanged"]}},enumerable:false,configurable:true});return e}();Editor.style={default:defaultEditorCss,material:editorMaterialCss};var Option$1=createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:true});t.apS=t.bind=t.bindTo=t.getRefinement=t.exists=t.elem=t.option=t.MonadThrow=t.Witherable=t.Traversable=t.Filterable=t.Compactable=t.Extend=t.Alternative=t.Alt=t.Foldable=t.Monad=t.Applicative=t.Functor=t.getMonoid=t.getLastMonoid=t.getFirstMonoid=t.getApplyMonoid=t.getApplySemigroup=t.getOrd=t.getEq=t.getShow=t.URI=t.wilt=t.wither=t.sequence=t.traverse=t.partitionMap=t.partition=t.filterMap=t.filter=t.separate=t.compact=t.reduceRight=t.foldMap=t.reduce=t.duplicate=t.extend=t.throwError=t.zero=t.alt=t.flatten=t.chainFirst=t.chain=t.of=t.apSecond=t.apFirst=t.ap=t.map=t.mapNullable=t.getOrElse=t.getOrElseW=t.toUndefined=t.toNullable=t.fold=t.fromEither=t.getRight=t.getLeft=t.tryCatch=t.fromPredicate=t.fromNullable=t.some=t.none=t.isNone=t.isSome=void 0;t.isSome=function(e){return e._tag==="Some"};t.isNone=function(e){return e._tag==="None"};t.none={_tag:"None"};t.some=function(e){return{_tag:"Some",value:e}};function r(e){return e==null?t.none:t.some(e)}t.fromNullable=r;function n(e){return function(r){return e(r)?t.some(r):t.none}}t.fromPredicate=n;function i(e){try{return t.some(e())}catch(r){return t.none}}t.tryCatch=i;function o(e){return e._tag==="Right"?t.none:t.some(e.left)}t.getLeft=o;function a(e){return e._tag==="Left"?t.none:t.some(e.right)}t.getRight=a;t.fromEither=function(e){return e._tag==="Left"?t.none:t.some(e.right)};function s(e,r){return function(n){return t.isNone(n)?e():r(n.value)}}t.fold=s;function l(e){return t.isNone(e)?null:e.value}t.toNullable=l;function c(e){return t.isNone(e)?undefined:e.value}t.toUndefined=c;t.getOrElseW=function(e){return function(r){return t.isNone(r)?e():r.value}};t.getOrElse=t.getOrElseW;function u(e){return function(n){return t.isNone(n)?t.none:r(e(n.value))}}t.mapNullable=u;var f=function(e,r){return t.isNone(e)?t.none:t.some(r(e.value))};var h=function(e,r){return t.isNone(e)?t.none:t.isNone(r)?t.none:t.some(e.value(r.value))};var d=function(e,r){return t.isNone(e)?t.none:r(e.value)};var p=function(e,r,n){return t.isNone(e)?r:n(r,e.value)};var g=function(e){return function(r,n){return t.isNone(r)?e.empty:n(r.value)}};var m=function(e,r,n){return t.isNone(e)?r:n(e.value,r)};var v=function(e){return function(r,n){return t.isNone(r)?e.of(t.none):e.map(n(r.value),t.some)}};var O=function(e,r){return t.isNone(e)?r():e};var y=function(e,r){return t.isNone(e)?t.none:r(e.value)?e:t.none};var b=function(e,r){return t.isNone(e)?t.none:r(e.value)};var S=function(e,r){return t.isNone(e)?t.none:t.some(r(e))};var w=function(e,t){return{left:y(e,(function(e){return!t(e)})),right:y(e,t)}};var x=function(e,r){return t.separate(f(e,r))};var k=function(e){return function(r,n){return t.isNone(r)?e.of(t.none):n(r.value)}};var P=function(e){return function(r,n){var i=f(r,(function(t){return e.map(n(t),(function(e){return{left:o(e),right:a(e)}}))}));return t.isNone(i)?e.of({left:t.none,right:t.none}):i.value}};t.map=function(e){return function(t){return f(t,e)}};t.ap=function(e){return function(t){return h(t,e)}};t.apFirst=function(e){return _function.flow(t.map((function(e){return function(){return e}})),t.ap(e))};t.apSecond=function(e){return _function.flow(t.map((function(){return function(e){return e}})),t.ap(e))};t.of=t.some;t.chain=function(e){return function(t){return d(t,e)}};t.chainFirst=function(e){return t.chain((function(r){return _function.pipe(e(r),t.map((function(){return r})))}))};t.flatten=t.chain(_function.identity);t.alt=function(e){return function(t){return O(t,e)}};t.zero=function(){return t.none};t.throwError=function(){return t.none};t.extend=function(e){return function(t){return S(t,e)}};t.duplicate=t.extend(_function.identity);t.reduce=function(e,t){return function(r){return p(r,e,t)}};t.foldMap=function(e){var t=g(e);return function(e){return function(r){return t(r,e)}}};t.reduceRight=function(e,t){return function(r){return m(r,e,t)}};t.compact=t.flatten;var C={left:t.none,right:t.none};t.separate=function(e){var r=f(e,(function(e){return{left:o(e),right:a(e)}}));return t.isNone(r)?C:r.value};t.filter=function(e){return function(t){return y(t,e)}};t.filterMap=function(e){return function(t){return b(t,e)}};t.partition=function(e){return function(t){return w(t,e)}};t.partitionMap=function(e){return function(t){return x(t,e)}};t.traverse=function(e){var t=v(e);return function(e){return function(r){return t(r,e)}}};t.sequence=function(e){return function(r){return t.isNone(r)?e.of(t.none):e.map(r.value,t.some)}};t.wither=function(e){var t=k(e);return function(e){return function(r){return t(r,e)}}};t.wilt=function(e){var t=P(e);return function(e){return function(r){return t(r,e)}}};t.URI="Option";function Q(e){return{show:function(r){return t.isNone(r)?"none":"some("+e.show(r.value)+")"}}}t.getShow=Q;function L(e){return{equals:function(r,n){return r===n||(t.isNone(r)?t.isNone(n):t.isNone(n)?false:e.equals(r.value,n.value))}}}t.getEq=L;function T(e){return{equals:L(e).equals,compare:function(r,n){return r===n?0:t.isSome(r)?t.isSome(n)?e.compare(r.value,n.value):1:-1}}}t.getOrd=T;function R(e){return{concat:function(r,n){return t.isSome(r)&&t.isSome(n)?t.some(e.concat(r.value,n.value)):t.none}}}t.getApplySemigroup=R;function $(e){return{concat:R(e).concat,empty:t.some(e.empty)}}t.getApplyMonoid=$;function A(){return{concat:function(e,r){return t.isNone(e)?r:e},empty:t.none}}t.getFirstMonoid=A;function M(){return{concat:function(e,r){return t.isNone(r)?e:r},empty:t.none}}t.getLastMonoid=M;function E(e){return{concat:function(r,n){return t.isNone(r)?n:t.isNone(n)?r:t.some(e.concat(r.value,n.value))},empty:t.none}}t.getMonoid=E;t.Functor={URI:t.URI,map:f};t.Applicative={URI:t.URI,map:f,ap:h,of:t.of};t.Monad={URI:t.URI,map:f,ap:h,of:t.of,chain:d};t.Foldable={URI:t.URI,reduce:p,foldMap:g,reduceRight:m};t.Alt={URI:t.URI,map:f,alt:O};t.Alternative={URI:t.URI,map:f,ap:h,of:t.of,alt:O,zero:t.zero};t.Extend={URI:t.URI,map:f,extend:S};t.Compactable={URI:t.URI,compact:t.compact,separate:t.separate};t.Filterable={URI:t.URI,map:f,compact:t.compact,separate:t.separate,filter:y,filterMap:b,partition:w,partitionMap:x};t.Traversable={URI:t.URI,map:f,reduce:p,foldMap:g,reduceRight:m,traverse:v,sequence:t.sequence};t.Witherable={URI:t.URI,map:f,reduce:p,foldMap:g,reduceRight:m,traverse:v,sequence:t.sequence,compact:t.compact,separate:t.separate,filter:y,filterMap:b,partition:w,partitionMap:x,wither:k,wilt:P};t.MonadThrow={URI:t.URI,map:f,ap:h,of:t.of,chain:d,throwError:t.throwError};t.option={URI:t.URI,map:f,of:t.of,ap:h,chain:d,reduce:p,foldMap:g,reduceRight:m,traverse:v,sequence:t.sequence,zero:t.zero,alt:O,extend:S,compact:t.compact,separate:t.separate,filter:y,filterMap:b,partition:w,partitionMap:x,wither:k,wilt:P,throwError:t.throwError};function I(e){return function(r,n){return t.isNone(n)?false:e.equals(r,n.value)}}t.elem=I;function D(e){return function(r){return t.isNone(r)?false:e(r.value)}}t.exists=D;function B(e){return function(r){return t.isSome(e(r))}}t.getRefinement=B;t.bindTo=function(e){return t.map(_function.bindTo_(e))};t.bind=function(e,r){return t.chain((function(n){return _function.pipe(r(n),t.map((function(t){return _function.bind_(n,e,t)})))}))};t.apS=function(e,r){return _function.flow(t.map((function(t){return function(r){return _function.bind_(t,e,r)}})),t.ap(r))}}));var Ordering=createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:true});t.invert=t.monoidOrdering=t.semigroupOrdering=t.eqOrdering=t.sign=void 0;function r(e){return e<=-1?-1:e>=1?1:0}t.sign=r;t.eqOrdering={equals:function(e,t){return e===t}};t.semigroupOrdering={concat:function(e,t){return e!==0?e:t}};t.monoidOrdering={concat:t.semigroupOrdering.concat,empty:0};function n(e){switch(e){case-1:return 1;case 1:return-1;default:return 0}}t.invert=n}));var Ord=createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:true});t.ord=t.Contravariant=t.ordDate=t.URI=t.contramap=t.getDualOrd=t.getTupleOrd=t.getMonoid=t.getSemigroup=t.fromCompare=t.between=t.clamp=t.max=t.min=t.geq=t.leq=t.gt=t.lt=t.ordBoolean=t.ordNumber=t.ordString=void 0;function r(e,t){return e<t?-1:e>t?1:0}function n(e,t){return e===t}t.ordString={equals:n,compare:r};t.ordNumber={equals:n,compare:r};t.ordBoolean={equals:n,compare:r};function i(e){return function(t,r){return e.compare(t,r)===-1}}t.lt=i;function o(e){return function(t,r){return e.compare(t,r)===1}}t.gt=o;function a(e){return function(t,r){return e.compare(t,r)!==1}}t.leq=a;function s(e){return function(t,r){return e.compare(t,r)!==-1}}t.geq=s;function l(e){return function(t,r){return e.compare(t,r)===1?r:t}}t.min=l;function c(e){return function(t,r){return e.compare(t,r)===-1?r:t}}t.max=c;function u(e){var t=l(e);var r=c(e);return function(e,n){return function(i){return r(t(i,n),e)}}}t.clamp=u;function f(e){var t=i(e);var r=o(e);return function(e,n){return function(i){return t(i,e)||r(i,n)?false:true}}}t.between=f;function h(e){var t=function(t,r){return t===r?0:e(t,r)};return{equals:function(e,r){return t(e,r)===0},compare:t}}t.fromCompare=h;function d(){return{concat:function(e,t){return h((function(r,n){return Ordering.monoidOrdering.concat(e.compare(r,n),t.compare(r,n))}))}}}t.getSemigroup=d;function p(){return{concat:d().concat,empty:h((function(){return 0}))}}t.getMonoid=p;function g(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}var r=e.length;return h((function(t,n){var i=0;for(;i<r-1;i++){var o=e[i].compare(t[i],n[i]);if(o!==0){return o}}return e[i].compare(t[i],n[i])}))}t.getTupleOrd=g;function m(e){return h((function(t,r){return e.compare(r,t)}))}t.getDualOrd=m;var v=function(e,r){return _function.pipe(e,t.contramap(r))};t.contramap=function(e){return function(t){return h((function(r,n){return t.compare(e(r),e(n))}))}};t.URI="Ord";t.ordDate=_function.pipe(t.ordNumber,t.contramap((function(e){return e.valueOf()})));t.Contravariant={URI:t.URI,contramap:v};t.ord=t.Contravariant}));var ReadonlyArray=createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:true});t.apS=t.bind=t.bindTo=t.empty=t.unsafeDeleteAt=t.unsafeUpdateAt=t.unsafeInsertAt=t.readonlyArray=t.Witherable=t.TraversableWithIndex=t.Traversable=t.FoldableWithIndex=t.Foldable=t.FilterableWithIndex=t.Filterable=t.Compactable=t.Extend=t.Alternative=t.Alt=t.Unfoldable=t.Monad=t.Applicative=t.FunctorWithIndex=t.Functor=t.URI=t.unfold=t.wilt=t.wither=t.traverseWithIndex=t.sequence=t.traverse=t.reduceRightWithIndex=t.reduceRight=t.reduceWithIndex=t.foldMap=t.reduce=t.foldMapWithIndex=t.duplicate=t.extend=t.filterWithIndex=t.partitionMapWithIndex=t.partitionMap=t.partitionWithIndex=t.partition=t.compact=t.filterMap=t.filterMapWithIndex=t.filter=t.separate=t.mapWithIndex=t.map=t.chainFirst=t.chainWithIndex=t.chain=t.apSecond=t.apFirst=t.ap=t.alt=t.zero=t.of=t.difference=t.intersection=t.union=t.comprehension=t.chunksOf=t.splitAt=t.chop=t.sortBy=t.uniq=t.elem=t.rotate=t.unzip=t.zip=t.zipWith=t.sort=t.lefts=t.rights=t.reverse=t.modifyAt=t.deleteAt=t.updateAt=t.insertAt=t.findLastIndex=t.findLastMap=t.findLast=t.findFirstMap=t.findFirst=t.findIndex=t.dropLeftWhile=t.dropRight=t.dropLeft=t.spanLeft=t.takeLeftWhile=t.takeRight=t.takeLeft=t.init=t.tail=t.last=t.head=t.snoc=t.cons=t.lookup=t.isOutOfBound=t.isNonEmpty=t.isEmpty=t.scanRight=t.scanLeft=t.foldRight=t.foldLeft=t.flatten=t.replicate=t.range=t.makeBy=t.getOrd=t.getEq=t.getMonoid=t.getShow=t.toArray=t.fromArray=void 0;function r(e){var r=e.length;if(r===0){return t.empty}var n=Array(r);for(var i=0;i<r;i++){n[i]=e[i]}return n}t.fromArray=r;function n(e){var t=e.length;var r=Array(t);for(var n=0;n<t;n++){r[n]=e[n]}return r}t.toArray=n;function i(e){return{show:function(t){return"["+t.map(e.show).join(", ")+"]"}}}t.getShow=i;var o=function(e,t){var r=e.length;if(r===0){return t}var n=t.length;if(n===0){return e}var i=Array(r+n);for(var o=0;o<r;o++){i[o]=e[o]}for(var o=0;o<n;o++){i[o+r]=t[o]}return i};function a(){return{concat:o,empty:t.empty}}t.getMonoid=a;function s(e){return{equals:function(t,r){return t===r||t.length===r.length&&t.every((function(t,n){return e.equals(t,r[n])}))}}}t.getEq=s;function l(e){return Ord.fromCompare((function(t,r){var n=t.length;var i=r.length;var o=Math.min(n,i);for(var a=0;a<o;a++){var s=e.compare(t[a],r[a]);if(s!==0){return s}}return Ord.ordNumber.compare(n,i)}))}t.getOrd=l;function c(e,t){var r=[];for(var n=0;n<e;n++){r.push(t(n))}return r}t.makeBy=c;function u(e,t){return c(t-e+1,(function(t){return e+t}))}t.range=u;function f(e,t){return c(e,(function(){return t}))}t.replicate=f;function h(e){var t=0;var r=e.length;for(var n=0;n<r;n++){t+=e[n].length}var i=Array(t);var o=0;for(var n=0;n<r;n++){var a=e[n];var s=a.length;for(var l=0;l<s;l++){i[l+o]=a[l]}o+=s}return i}t.flatten=h;function d(e,t){return function(r){return v(r)?e():t(r[0],r.slice(1))}}t.foldLeft=d;function p(e,t){return function(r){return v(r)?e():t(r.slice(0,r.length-1),r[r.length-1])}}t.foldRight=p;function g(e,t){return function(r){var n=r.length;var i=new Array(n+1);i[0]=e;for(var o=0;o<n;o++){i[o+1]=t(i[o],r[o])}return i}}t.scanLeft=g;function m(e,t){return function(r){var n=r.length;var i=new Array(n+1);i[n]=e;for(var o=n-1;o>=0;o--){i[o]=t(r[o],i[o+1])}return i}}t.scanRight=m;function v(e){return e.length===0}t.isEmpty=v;function O(e){return e.length>0}t.isNonEmpty=O;function y(e,t){return e<0||e>=t.length}t.isOutOfBound=y;function b(e,t){return t===undefined?function(t){return b(e,t)}:y(e,t)?Option$1.none:Option$1.some(t[e])}t.lookup=b;function S(e,t){if(t===undefined){return function(t){return S(e,t)}}var r=t.length;var n=Array(r+1);for(var i=0;i<r;i++){n[i+1]=t[i]}n[0]=e;return n}t.cons=S;function w(e,t){var r=e.length;var n=Array(r+1);for(var i=0;i<r;i++){n[i]=e[i]}n[r]=t;return n}t.snoc=w;function x(e){return v(e)?Option$1.none:Option$1.some(e[0])}t.head=x;function k(e){return b(e.length-1,e)}t.last=k;function P(e){return v(e)?Option$1.none:Option$1.some(e.slice(1))}t.tail=P;function C(e){var t=e.length;return t===0?Option$1.none:Option$1.some(e.slice(0,t-1))}t.init=C;function Q(e){return function(t){return t.slice(0,e)}}t.takeLeft=Q;function L(e){return function(r){return e===0?t.empty:r.slice(-e)}}t.takeRight=L;function T(e){return function(t){var r=R(t,e);var n=Array(r);for(var i=0;i<r;i++){n[i]=t[i]}return n}}t.takeLeftWhile=T;var R=function(e,t){var r=e.length;var n=0;for(;n<r;n++){if(!t(e[n])){break}}return n};function $(e){return function(t){var r=R(t,e);var n=Array(r);for(var i=0;i<r;i++){n[i]=t[i]}var o=t.length;var a=Array(o-r);for(var i=r;i<o;i++){a[i-r]=t[i]}return{init:n,rest:a}}}t.spanLeft=$;function A(e){return function(t){return t.slice(e,t.length)}}t.dropLeft=A;function M(e){return function(t){return t.slice(0,t.length-e)}}t.dropRight=M;function E(e){return function(t){var r=R(t,e);var n=t.length;var i=Array(n-r);for(var o=r;o<n;o++){i[o-r]=t[o]}return i}}t.dropLeftWhile=E;function I(e){return function(t){var r=t.length;for(var n=0;n<r;n++){if(e(t[n])){return Option$1.some(n)}}return Option$1.none}}t.findIndex=I;function D(e){return function(t){var r=t.length;for(var n=0;n<r;n++){if(e(t[n])){return Option$1.some(t[n])}}return Option$1.none}}t.findFirst=D;function B(e){return function(t){var r=t.length;for(var n=0;n<r;n++){var i=e(t[n]);if(Option$1.isSome(i)){return i}}return Option$1.none}}t.findFirstMap=B;function U(e){return function(t){var r=t.length;for(var n=r-1;n>=0;n--){if(e(t[n])){return Option$1.some(t[n])}}return Option$1.none}}t.findLast=U;function q(e){return function(t){var r=t.length;for(var n=r-1;n>=0;n--){var i=e(t[n]);if(Option$1.isSome(i)){return i}}return Option$1.none}}t.findLastMap=q;function _(e){return function(t){var r=t.length;for(var n=r-1;n>=0;n--){if(e(t[n])){return Option$1.some(n)}}return Option$1.none}}t.findLastIndex=_;function W(e,t){return function(r){return e<0||e>r.length?Option$1.none:Option$1.some($e(e,t,r))}}t.insertAt=W;function j(e,t){return function(r){return y(e,r)?Option$1.none:Option$1.some(Ae(e,t,r))}}t.updateAt=j;function X(e){return function(t){return y(e,t)?Option$1.none:Option$1.some(Me(e,t))}}t.deleteAt=X;function V(e,t){return function(r){return y(e,r)?Option$1.none:Option$1.some(Ae(e,t(r[e]),r))}}t.modifyAt=V;function N(e){if(v(e)){return e}return e.slice().reverse()}t.reverse=N;function F(e){var t=[];var r=e.length;for(var n=0;n<r;n++){var i=e[n];if(i._tag==="Right"){t.push(i.right)}}return t}t.rights=F;function z(e){var t=[];var r=e.length;for(var n=0;n<r;n++){var i=e[n];if(i._tag==="Left"){t.push(i.left)}}return t}t.lefts=z;t.sort=function(e){return function(t){return v(t)?t:t.slice().sort(e.compare)}};function G(e,t,r){var n=[];var i=Math.min(e.length,t.length);for(var o=0;o<i;o++){n[o]=r(e[o],t[o])}return n}t.zipWith=G;function H(e,t){if(t===undefined){return function(t){return H(t,e)}}return G(e,t,(function(e,t){return[e,t]}))}t.zip=H;function Y(e){var t=[];var r=[];for(var n=0;n<e.length;n++){t[n]=e[n][0];r[n]=e[n][1]}return[t,r]}t.unzip=Y;function Z(e){return function(t){var r=t.length;if(e===0||r<=1||r===Math.abs(e)){return t}else if(e<0){return Z(r+e)(t)}else{return t.slice(-e).concat(t.slice(0,r-e))}}}t.rotate=Z;function K(e){return function(t,r){if(r===undefined){var n=K(e);return function(e){return n(t,e)}}var i=function(r){return e.equals(r,t)};var o=0;var a=r.length;for(;o<a;o++){if(i(r[o])){return true}}return false}}t.elem=K;function J(e){var t=K(e);return function(e){var r=[];var n=e.length;var i=0;for(;i<n;i++){var o=e[i];if(!t(o,r)){r.push(o)}}return n===r.length?e:r}}t.uniq=J;function ee(e){var r=Ord.getMonoid();return t.sort(e.reduce(r.concat,r.empty))}t.sortBy=ee;t.chop=function(e){return function(t){var r=[];var n=t;while(O(n)){var i=e(n),o=i[0],a=i[1];r.push(o);n=a}return r}};function te(e){return function(t){return[t.slice(0,e),t.slice(e)]}}t.splitAt=te;function re(e){var r=t.chop(te(e));return function(n){return n.length===0?t.empty:y(e-1,n)?[n]:r(n)}}t.chunksOf=re;function ne(e,r,n){if(n===void 0){n=function(){return true}}var i=function(e,o){if(o.length===0){return n.apply(void 0,e)?[r.apply(void 0,e)]:t.empty}else{return ue(o[0],(function(t){return i(w(e,t),o.slice(1))}))}};return i(t.empty,e)}t.comprehension=ne;function ie(e){var t=K(e);return function(r,n){if(n===undefined){var i=ie(e);return function(e){return i(e,r)}}return o(r,n.filter((function(e){return!t(e,r)})))}}t.union=ie;function oe(e){var t=K(e);return function(r,n){if(n===undefined){var i=oe(e);return function(e){return i(e,r)}}return r.filter((function(e){return t(e,n)}))}}t.intersection=oe;function ae(e){var t=K(e);return function(r,n){if(n===undefined){var i=ae(e);return function(e){return i(e,r)}}return r.filter((function(e){return!t(e,n)}))}}t.difference=ae;t.of=function(e){return[e]};t.zero=function(){return t.empty};var se=function(e,r){return _function.pipe(e,t.map(r))};var le=function(e,r){return _function.pipe(e,t.mapWithIndex(r))};var ce=function(e,r){return _function.pipe(e,t.ap(r))};var ue=function(e,r){return _function.pipe(e,t.chain(r))};var fe=function(e,r){return _function.pipe(e,t.filter(r))};var he=function(e,r){return _function.pipe(e,t.filterMap(r))};var de=function(e,r){return _function.pipe(e,t.partitionWithIndex(r))};var pe=function(e,r){return _function.pipe(e,t.partition(r))};var ge=function(e,r){return _function.pipe(e,t.partitionMap(r))};var me=function(e,r){return _function.pipe(e,t.partitionMapWithIndex(r))};var ve=function(e,r){return _function.pipe(e,t.alt(r))};var Oe=function(e,r,n){return _function.pipe(e,t.reduce(r,n))};var ye=function(e){var r=t.foldMap(e);return function(e,t){return _function.pipe(e,r(t))}};var be=function(e,r,n){return _function.pipe(e,t.reduceRight(r,n))};var Se=function(e,t,r){var n=e.length;var i=t;for(var o=0;o<n;o++){i=r(o,i,e[o])}return i};var we=function(e){return function(t,r){return t.reduce((function(t,n,i){return e.concat(t,r(i,n))}),e.empty)}};var xe=function(e,r,n){return _function.pipe(e,t.reduceRightWithIndex(r,n))};var ke=function(e,r){return _function.pipe(e,t.filterMapWithIndex(r))};var Pe=function(e,r){return _function.pipe(e,t.filterWithIndex(r))};var Ce=function(e,r){return _function.pipe(e,t.extend(r))};var Qe=function(e){var r=t.traverse(e);return function(e,t){return _function.pipe(e,r(t))}};var Le=function(e){var r=t.traverseWithIndex(e);return function(e,t){return _function.pipe(e,r(t))}};var Te=function(e){var r=t.wither(e);return function(e,t){return _function.pipe(e,r(t))}};var Re=function(e){var r=t.wilt(e);return function(e,t){return _function.pipe(e,r(t))}};t.alt=function(e){return function(t){return o(t,e())}};t.ap=function(e){return t.chain((function(r){return _function.pipe(e,t.map(r))}))};t.apFirst=function(e){return _function.flow(t.map((function(e){return function(){return e}})),t.ap(e))};t.apSecond=function(e){return _function.flow(t.map((function(){return function(e){return e}})),t.ap(e))};t.chain=function(e){return function(r){return _function.pipe(r,t.chainWithIndex((function(t,r){return e(r)})))}};t.chainWithIndex=function(e){return function(t){var r=0;var n=t.length;var i=new Array(n);for(var o=0;o<n;o++){var a=t[o];var s=e(o,a);r+=s.length;i[o]=s}var l=Array(r);var c=0;for(var o=0;o<n;o++){var s=i[o];var u=s.length;for(var f=0;f<u;f++){l[f+c]=s[f]}c+=u}return l}};t.chainFirst=function(e){return t.chain((function(r){return _function.pipe(e(r),t.map((function(){return r})))}))};t.map=function(e){return function(t){return t.map((function(t){return e(t)}))}};t.mapWithIndex=function(e){return function(t){return t.map((function(t,r){return e(r,t)}))}};t.separate=function(e){var t=[];var r=[];for(var n=0,i=e;n<i.length;n++){var o=i[n];if(o._tag==="Left"){t.push(o.left)}else{r.push(o.right)}}return{left:t,right:r}};t.filter=function(e){return function(t){return t.filter(e)}};t.filterMapWithIndex=function(e){return function(t){var r=[];for(var n=0;n<t.length;n++){var i=e(n,t[n]);if(Option$1.isSome(i)){r.push(i.value)}}return r}};t.filterMap=function(e){return t.filterMapWithIndex((function(t,r){return e(r)}))};t.compact=t.filterMap(_function.identity);t.partition=function(e){return t.partitionWithIndex((function(t,r){return e(r)}))};t.partitionWithIndex=function(e){return function(t){var r=[];var n=[];for(var i=0;i<t.length;i++){var o=t[i];if(e(i,o)){n.push(o)}else{r.push(o)}}return{left:r,right:n}}};t.partitionMap=function(e){return t.partitionMapWithIndex((function(t,r){return e(r)}))};t.partitionMapWithIndex=function(e){return function(t){var r=[];var n=[];for(var i=0;i<t.length;i++){var o=e(i,t[i]);if(o._tag==="Left"){r.push(o.left)}else{n.push(o.right)}}return{left:r,right:n}}};t.filterWithIndex=function(e){return function(t){return t.filter((function(t,r){return e(r,t)}))}};t.extend=function(e){return function(t){return t.map((function(t,r,n){return e(n.slice(r))}))}};t.duplicate=t.extend(_function.identity);t.foldMapWithIndex=function(e){var t=we(e);return function(e){return function(r){return t(r,e)}}};t.reduce=function(e,r){return t.reduceWithIndex(e,(function(e,t,n){return r(t,n)}))};t.foldMap=function(e){var r=t.foldMapWithIndex(e);return function(e){return r((function(t,r){return e(r)}))}};t.reduceWithIndex=function(e,t){return function(r){return Se(r,e,t)}};t.reduceRight=function(e,r){return t.reduceRightWithIndex(e,(function(e,t,n){return r(t,n)}))};t.reduceRightWithIndex=function(e,t){return function(r){return r.reduceRight((function(e,r,n){return t(n,r,e)}),e)}};t.traverse=function(e){var r=t.traverseWithIndex(e);return function(e){return r((function(t,r){return e(r)}))}};t.sequence=function(e){return function(r){return Oe(r,e.of(t.zero()),(function(t,r){return e.ap(e.map(t,(function(e){return function(t){return w(e,t)}})),r)}))}};t.traverseWithIndex=function(e){return function(r){return t.reduceWithIndex(e.of(t.zero()),(function(t,n,i){return e.ap(e.map(n,(function(e){return function(t){return w(e,t)}})),r(t,i))}))}};t.wither=function(e){var r=t.traverse(e);return function(n){return function(i){return e.map(_function.pipe(i,r(n)),t.compact)}}};t.wilt=function(e){var r=t.traverse(e);return function(n){return function(i){return e.map(_function.pipe(i,r(n)),t.separate)}}};t.unfold=function(e,t){var r=[];var n=e;while(true){var i=t(n);if(Option$1.isSome(i)){var o=i.value,a=o[0],s=o[1];r.push(a);n=s}else{break}}return r};t.URI="ReadonlyArray";t.Functor={URI:t.URI,map:se};t.FunctorWithIndex={URI:t.URI,map:se,mapWithIndex:le};t.Applicative={URI:t.URI,map:se,ap:ce,of:t.of};t.Monad={URI:t.URI,map:se,ap:ce,of:t.of,chain:ue};t.Unfoldable={URI:t.URI,unfold:t.unfold};t.Alt={URI:t.URI,map:se,alt:ve};t.Alternative={URI:t.URI,map:se,ap:ce,of:t.of,alt:ve,zero:t.zero};t.Extend={URI:t.URI,map:se,extend:Ce};t.Compactable={URI:t.URI,compact:t.compact,separate:t.separate};t.Filterable={URI:t.URI,map:se,compact:t.compact,separate:t.separate,filter:fe,filterMap:he,partition:pe,partitionMap:ge};t.FilterableWithIndex={URI:t.URI,map:se,mapWithIndex:le,compact:t.compact,separate:t.separate,filter:fe,filterMap:he,partition:pe,partitionMap:ge,partitionMapWithIndex:me,partitionWithIndex:de,filterMapWithIndex:ke,filterWithIndex:Pe};t.Foldable={URI:t.URI,reduce:Oe,foldMap:ye,reduceRight:be};t.FoldableWithIndex={URI:t.URI,reduce:Oe,foldMap:ye,reduceRight:be,reduceWithIndex:Se,foldMapWithIndex:we,reduceRightWithIndex:xe};t.Traversable={URI:t.URI,map:se,reduce:Oe,foldMap:ye,reduceRight:be,traverse:Qe,sequence:t.sequence};t.TraversableWithIndex={URI:t.URI,map:se,mapWithIndex:le,reduce:Oe,foldMap:ye,reduceRight:be,reduceWithIndex:Se,foldMapWithIndex:we,reduceRightWithIndex:xe,traverse:Qe,sequence:t.sequence,traverseWithIndex:Le};t.Witherable={URI:t.URI,map:se,compact:t.compact,separate:t.separate,filter:fe,filterMap:he,partition:pe,partitionMap:ge,reduce:Oe,foldMap:ye,reduceRight:be,traverse:Qe,sequence:t.sequence,wither:Te,wilt:Re};t.readonlyArray={URI:t.URI,compact:t.compact,separate:t.separate,map:se,ap:ce,of:t.of,chain:ue,filter:fe,filterMap:he,partition:pe,partitionMap:ge,mapWithIndex:le,partitionMapWithIndex:me,partitionWithIndex:de,filterMapWithIndex:ke,filterWithIndex:Pe,alt:ve,zero:t.zero,unfold:t.unfold,reduce:Oe,foldMap:ye,reduceRight:be,traverse:Qe,sequence:t.sequence,reduceWithIndex:Se,foldMapWithIndex:we,reduceRightWithIndex:xe,traverseWithIndex:Le,extend:Ce,wither:Te,wilt:Re};function $e(e,t,r){var n=r.slice();n.splice(e,0,t);return n}t.unsafeInsertAt=$e;function Ae(e,t,r){if(r[e]===t){return r}else{var n=r.slice();n[e]=t;return n}}t.unsafeUpdateAt=Ae;function Me(e,t){var r=t.slice();r.splice(e,1);return r}t.unsafeDeleteAt=Me;t.empty=[];t.bindTo=function(e){return t.map(_function.bindTo_(e))};t.bind=function(e,r){return t.chain((function(n){return _function.pipe(r(n),t.map((function(t){return _function.bind_(n,e,t)})))}))};t.apS=function(e,r){return _function.flow(t.map((function(t){return function(r){return _function.bind_(t,e,r)}})),t.ap(r))}}));var _Array=createCommonjsModule((function(e,t){var r=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,n){if(n===undefined)n=r;Object.defineProperty(e,n,{enumerable:true,get:function(){return t[r]}})}:function(e,t,r,n){if(n===undefined)n=r;e[n]=t[r]});var n=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var i=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var i in e)if(i!=="default"&&Object.prototype.hasOwnProperty.call(e,i))r(t,e,i);n(t,e);return t};Object.defineProperty(t,"__esModule",{value:true});t.apS=t.bind=t.bindTo=t.empty=t.unsafeDeleteAt=t.unsafeUpdateAt=t.unsafeInsertAt=t.array=t.Witherable=t.TraversableWithIndex=t.Traversable=t.FoldableWithIndex=t.Foldable=t.FilterableWithIndex=t.Filterable=t.Compactable=t.Extend=t.Alternative=t.Alt=t.Unfoldable=t.Monad=t.Applicative=t.FunctorWithIndex=t.Functor=t.URI=t.zero=t.unfold=t.wilt=t.wither=t.traverseWithIndex=t.sequence=t.traverse=t.reduceRightWithIndex=t.reduceRight=t.reduceWithIndex=t.reduce=t.foldMapWithIndex=t.foldMap=t.duplicate=t.extend=t.filterWithIndex=t.filterMapWithIndex=t.alt=t.partitionMapWithIndex=t.partitionMap=t.partitionWithIndex=t.partition=t.filterMap=t.filter=t.separate=t.compact=t.mapWithIndex=t.chainFirst=t.chainWithIndex=t.chain=t.apSecond=t.apFirst=t.ap=t.map=t.of=t.difference=t.intersection=t.union=t.comprehension=t.chunksOf=t.splitAt=t.chop=t.sortBy=t.uniq=t.elem=t.rotate=t.unzip=t.zip=t.zipWith=t.sort=t.lefts=t.rights=t.reverse=t.modifyAt=t.deleteAt=t.updateAt=t.insertAt=t.copy=t.findLastIndex=t.findLastMap=t.findLast=t.findFirstMap=t.findFirst=t.findIndex=t.dropLeftWhile=t.dropRight=t.dropLeft=t.spanLeft=t.takeLeftWhile=t.takeRight=t.takeLeft=t.init=t.tail=t.last=t.head=t.snoc=t.cons=t.lookup=t.isOutOfBound=t.isNonEmpty=t.isEmpty=t.scanRight=t.scanLeft=t.foldRight=t.foldLeft=t.flatten=t.replicate=t.range=t.makeBy=t.getOrd=t.getEq=t.getMonoid=t.getShow=void 0;var o=i(ReadonlyArray);t.getShow=o.getShow;t.getMonoid=o.getMonoid;t.getEq=o.getEq;t.getOrd=o.getOrd;t.makeBy=o.makeBy;t.range=o.range;t.replicate=o.replicate;t.flatten=o.flatten;t.foldLeft=o.foldLeft;t.foldRight=o.foldRight;t.scanLeft=o.scanLeft;t.scanRight=o.scanRight;t.isEmpty=o.isEmpty;t.isNonEmpty=o.isNonEmpty;t.isOutOfBound=o.isOutOfBound;t.lookup=o.lookup;t.cons=o.cons;t.snoc=o.snoc;t.head=o.head;t.last=o.last;t.tail=o.tail;t.init=o.init;t.takeLeft=o.takeLeft;t.takeRight=o.takeRight;function a(e){return o.takeLeftWhile(e)}t.takeLeftWhile=a;function s(e){return o.spanLeft(e)}t.spanLeft=s;t.dropLeft=o.dropLeft;t.dropRight=o.dropRight;t.dropLeftWhile=o.dropLeftWhile;t.findIndex=o.findIndex;function l(e){return o.findFirst(e)}t.findFirst=l;t.findFirstMap=o.findFirstMap;function c(e){return o.findLast(e)}t.findLast=c;t.findLastMap=o.findLastMap;t.findLastIndex=o.findLastIndex;t.copy=o.toArray;t.insertAt=o.insertAt;t.updateAt=o.updateAt;t.deleteAt=o.deleteAt;t.modifyAt=o.modifyAt;t.reverse=o.reverse;t.rights=o.rights;t.lefts=o.lefts;t.sort=o.sort;t.zipWith=o.zipWith;t.zip=o.zip;t.unzip=o.unzip;t.rotate=o.rotate;t.elem=o.elem;t.uniq=o.uniq;t.sortBy=o.sortBy;t.chop=o.chop;t.splitAt=o.splitAt;t.chunksOf=o.chunksOf;function u(e,t,r){if(r===void 0){r=function(){return true}}return o.comprehension(e,t,r)}t.comprehension=u;t.union=o.union;t.intersection=o.intersection;t.difference=o.difference;t.of=o.of;var f=o.Monad.map;var h=o.Monad.ap;var d=o.Monad.chain;var p=o.FunctorWithIndex.mapWithIndex;var g=o.Filterable.filter;var m=o.Filterable.filterMap;var v=o.Filterable.partition;var O=o.Filterable.partitionMap;var y=o.FilterableWithIndex.filterWithIndex;var b=o.FilterableWithIndex.filterMapWithIndex;var S=o.FilterableWithIndex.partitionWithIndex;var w=o.FilterableWithIndex.partitionMapWithIndex;var x=o.Foldable.reduce;var k=o.Foldable.foldMap;var P=o.Foldable.reduceRight;var C=o.Traversable.traverse;var Q=o.Alternative.alt;var L=o.FoldableWithIndex.reduceWithIndex;var T=o.FoldableWithIndex.foldMapWithIndex;var R=o.FoldableWithIndex.reduceRightWithIndex;var $=o.TraversableWithIndex.traverseWithIndex;var A=o.Extend.extend;var M=o.Witherable.wither;var E=o.Witherable.wilt;t.map=o.map;t.ap=o.ap;t.apFirst=o.apFirst;t.apSecond=o.apSecond;t.chain=o.chain;t.chainWithIndex=o.chainWithIndex;t.chainFirst=o.chainFirst;t.mapWithIndex=o.mapWithIndex;t.compact=o.compact;t.separate=o.separate;t.filter=o.filter;t.filterMap=o.filterMap;t.partition=o.partition;t.partitionWithIndex=o.partitionWithIndex;t.partitionMap=o.partitionMap;t.partitionMapWithIndex=o.partitionMapWithIndex;t.alt=o.alt;t.filterMapWithIndex=o.filterMapWithIndex;t.filterWithIndex=o.filterWithIndex;t.extend=o.extend;t.duplicate=o.duplicate;t.foldMap=o.foldMap;t.foldMapWithIndex=o.foldMapWithIndex;t.reduce=o.reduce;t.reduceWithIndex=o.reduceWithIndex;t.reduceRight=o.reduceRight;t.reduceRightWithIndex=o.reduceRightWithIndex;t.traverse=o.traverse;t.sequence=o.sequence;t.traverseWithIndex=o.traverseWithIndex;t.wither=o.wither;t.wilt=o.wilt;t.unfold=o.unfold;t.zero=o.Alternative.zero;t.URI="Array";t.Functor={URI:t.URI,map:f};t.FunctorWithIndex={URI:t.URI,map:f,mapWithIndex:p};t.Applicative={URI:t.URI,map:f,ap:h,of:t.of};t.Monad={URI:t.URI,map:f,ap:h,of:t.of,chain:d};t.Unfoldable={URI:t.URI,unfold:t.unfold};t.Alt={URI:t.URI,map:f,alt:Q};t.Alternative={URI:t.URI,map:f,ap:h,of:t.of,alt:Q,zero:t.zero};t.Extend={URI:t.URI,map:f,extend:A};t.Compactable={URI:t.URI,compact:t.compact,separate:t.separate};t.Filterable={URI:t.URI,map:f,compact:t.compact,separate:t.separate,filter:g,filterMap:m,partition:v,partitionMap:O};t.FilterableWithIndex={URI:t.URI,map:f,mapWithIndex:p,compact:t.compact,separate:t.separate,filter:g,filterMap:m,partition:v,partitionMap:O,partitionMapWithIndex:w,partitionWithIndex:S,filterMapWithIndex:b,filterWithIndex:y};t.Foldable={URI:t.URI,reduce:x,foldMap:k,reduceRight:P};t.FoldableWithIndex={URI:t.URI,reduce:x,foldMap:k,reduceRight:P,reduceWithIndex:L,foldMapWithIndex:T,reduceRightWithIndex:R};t.Traversable={URI:t.URI,map:f,reduce:x,foldMap:k,reduceRight:P,traverse:C,sequence:t.sequence};t.TraversableWithIndex={URI:t.URI,map:f,mapWithIndex:p,reduce:x,foldMap:k,reduceRight:P,reduceWithIndex:L,foldMapWithIndex:T,reduceRightWithIndex:R,traverse:C,sequence:t.sequence,traverseWithIndex:$};t.Witherable={URI:t.URI,map:f,compact:t.compact,separate:t.separate,filter:g,filterMap:m,partition:v,partitionMap:O,reduce:x,foldMap:k,reduceRight:P,traverse:C,sequence:t.sequence,wither:M,wilt:E};t.array={URI:t.URI,compact:t.compact,separate:t.separate,map:f,ap:h,of:t.of,chain:d,filter:g,filterMap:m,partition:v,partitionMap:O,mapWithIndex:p,partitionMapWithIndex:w,partitionWithIndex:S,filterMapWithIndex:b,filterWithIndex:y,alt:Q,zero:t.zero,unfold:t.unfold,reduce:x,foldMap:k,reduceRight:P,traverse:C,sequence:t.sequence,reduceWithIndex:L,foldMapWithIndex:T,reduceRightWithIndex:R,traverseWithIndex:$,extend:A,wither:M,wilt:E};t.unsafeInsertAt=o.unsafeInsertAt;t.unsafeUpdateAt=o.unsafeUpdateAt;t.unsafeDeleteAt=o.unsafeDeleteAt;t.empty=[];t.bindTo=o.bindTo;t.bind=o.bind;t.apS=o.apS}));var defaultNodeListCss="*.sc-stencila-node-list-default,.sc-stencila-node-list-default:after,.sc-stencila-node-list-default:before{-webkit-box-sizing:border-box;box-sizing:border-box;border:0 solid}html.sc-stencila-node-list-default{font-size:16px}.hidden.sc-stencila-node-list-default{display:none}code.sc-stencila-node-list-default,code[class*=language-].sc-stencila-node-list-default,output.sc-stencila-node-list-default{font-family:monospace;font-family:var(--font-family-mono,monospace);font-size:75%}pre.sc-stencila-node-list-default{border:1px solid #e2e8f0;border-color:var(--color-neutral-300,#e2e8f0);border-radius:.25rem;padding:.5rem;margin:.5rem;overflow:auto}.sc-stencila-node-list-default-h,stencila-node-list.sc-stencila-node-list-default{display:block}.sc-stencila-node-list-default-h .hidden.sc-stencila-node-list-default+.sc-stencila-node-list-default:nth-child(2),.sc-stencila-node-list-default-h>.sc-stencila-node-list-default:first-child,stencila-node-list.sc-stencila-node-list-default .hidden.sc-stencila-node-list-default+.sc-stencila-node-list-default:nth-child(2),stencila-node-list.sc-stencila-node-list-default>.sc-stencila-node-list-default:first-child{padding-top:0;margin-top:0;border-top-width:0}.sc-stencila-node-list-default-h>.sc-stencila-node-list-default:last-child,stencila-node-list.sc-stencila-node-list-default>.sc-stencila-node-list-default:last-child{margin-bottom:0}.sc-stencila-node-list-default-h .hidden.sc-stencila-node-list-default,stencila-node-list.sc-stencila-node-list-default .hidden.sc-stencila-node-list-default{display:none}.sc-stencila-node-list-default-h .emptyContentMessage.sc-stencila-node-list-default,stencila-node-list.sc-stencila-node-list-default .emptyContentMessage.sc-stencila-node-list-default{color:#718096;color:var(--color-neutral-600,#718096)}.sc-stencila-node-list-default-h stencila-code-error.sc-stencila-node-list-default,stencila-node-list.sc-stencila-node-list-default stencila-code-error.sc-stencila-node-list-default{border-width:0}.sc-stencila-node-list-default-h stencila-image-object.sc-stencila-node-list-default,stencila-node-list.sc-stencila-node-list-default stencila-image-object.sc-stencila-node-list-default{display:block;height:auto;max-width:100%}.sc-stencila-node-list-default-h .sc-stencila-node-list-default-s>[slot=outputs],.sc-stencila-node-list-default-h>*.sc-stencila-node-list-default,.sc-stencila-node-list-default-h figure.sc-stencila-node-list-default,stencila-node-list.sc-stencila-node-list-default-s>[slot=outputs],stencila-node-list .sc-stencila-node-list-default-s>[slot=outputs],stencila-node-list.sc-stencila-node-list-default>*.sc-stencila-node-list-default,stencila-node-list.sc-stencila-node-list-default figure.sc-stencila-node-list-default{padding:0;margin:0;overflow:auto}.sc-stencila-node-list-default-h .sc-stencila-node-list-default-s>[slot=outputs]:first-child,.sc-stencila-node-list-default-h>.sc-stencila-node-list-default:first-child,.sc-stencila-node-list-default-h figure.sc-stencila-node-list-default:first-child,stencila-node-list.sc-stencila-node-list-default-s>[slot=outputs]:first-child,stencila-node-list .sc-stencila-node-list-default-s>[slot=outputs]:first-child,stencila-node-list.sc-stencila-node-list-default>.sc-stencila-node-list-default:first-child,stencila-node-list.sc-stencila-node-list-default figure.sc-stencila-node-list-default:first-child{margin-top:0}.sc-stencila-node-list-default-h .sc-stencila-node-list-default-s>[slot=outputs]:last-child,.sc-stencila-node-list-default-h>.sc-stencila-node-list-default:last-child,.sc-stencila-node-list-default-h figure.sc-stencila-node-list-default:last-child,stencila-node-list.sc-stencila-node-list-default-s>[slot=outputs]:last-child,stencila-node-list .sc-stencila-node-list-default-s>[slot=outputs]:last-child,stencila-node-list.sc-stencila-node-list-default>.sc-stencila-node-list-default:last-child,stencila-node-list.sc-stencila-node-list-default figure.sc-stencila-node-list-default:last-child{margin-bottom:0}.sc-stencila-node-list-default-h .sc-stencila-node-list-default-s>[slot=outputs] pre,.sc-stencila-node-list-default-h>*.sc-stencila-node-list-default pre.sc-stencila-node-list-default,.sc-stencila-node-list-default-h figure.sc-stencila-node-list-default pre.sc-stencila-node-list-default,stencila-node-list.sc-stencila-node-list-default-s>[slot=outputs] pre,stencila-node-list .sc-stencila-node-list-default-s>[slot=outputs] pre,stencila-node-list.sc-stencila-node-list-default>*.sc-stencila-node-list-default pre.sc-stencila-node-list-default,stencila-node-list.sc-stencila-node-list-default figure.sc-stencila-node-list-default pre.sc-stencila-node-list-default{padding:0;margin:0;border-width:0}.sc-stencila-node-list-default-h .sc-stencila-node-list-default-s>[slot=outputs] img,.sc-stencila-node-list-default-h>*.sc-stencila-node-list-default img.sc-stencila-node-list-default,.sc-stencila-node-list-default-h figure.sc-stencila-node-list-default img.sc-stencila-node-list-default,stencila-node-list.sc-stencila-node-list-default-s>[slot=outputs] img,stencila-node-list .sc-stencila-node-list-default-s>[slot=outputs] img,stencila-node-list.sc-stencila-node-list-default>*.sc-stencila-node-list-default img.sc-stencila-node-list-default,stencila-node-list.sc-stencila-node-list-default figure.sc-stencila-node-list-default img.sc-stencila-node-list-default{border-bottom-width:0;border-left-width:0;border-right-width:0}.sc-stencila-node-list-default-h .sc-stencila-node-list-default-s>[slot=outputs]>:not(figcaption),.sc-stencila-node-list-default-h>*.sc-stencila-node-list-default>.sc-stencila-node-list-default:not(figcaption),.sc-stencila-node-list-default-h figure.sc-stencila-node-list-default>.sc-stencila-node-list-default:not(figcaption),stencila-node-list.sc-stencila-node-list-default-s>[slot=outputs]>:not(figcaption),stencila-node-list .sc-stencila-node-list-default-s>[slot=outputs]>:not(figcaption),stencila-node-list.sc-stencila-node-list-default>*.sc-stencila-node-list-default>.sc-stencila-node-list-default:not(figcaption),stencila-node-list.sc-stencila-node-list-default figure.sc-stencila-node-list-default>.sc-stencila-node-list-default:not(figcaption){padding-top:.75rem;margin-top:.75rem;margin-bottom:.75rem;border:0 dashed #e2e8f0;border-color:var(--color-neutral-300,#e2e8f0);border-top:1px dashed var(--color-neutral-300,#e2e8f0)}.sc-stencila-node-list-default-h .sc-stencila-node-list-default-s>[slot=outputs]>:not(figcaption):first-child,.sc-stencila-node-list-default-h>*.sc-stencila-node-list-default>.sc-stencila-node-list-default:not(figcaption):first-child,.sc-stencila-node-list-default-h figure.sc-stencila-node-list-default>.sc-stencila-node-list-default:not(figcaption):first-child,stencila-node-list.sc-stencila-node-list-default-s>[slot=outputs]>:not(figcaption):first-child,stencila-node-list .sc-stencila-node-list-default-s>[slot=outputs]>:not(figcaption):first-child,stencila-node-list.sc-stencila-node-list-default>*.sc-stencila-node-list-default>.sc-stencila-node-list-default:not(figcaption):first-child,stencila-node-list.sc-stencila-node-list-default figure.sc-stencila-node-list-default>.sc-stencila-node-list-default:not(figcaption):first-child{padding-top:0;margin-top:0;border-top-width:0}.sc-stencila-node-list-default-h .sc-stencila-node-list-default-s>[slot=outputs]>:not(figcaption):last-child,.sc-stencila-node-list-default-h>*.sc-stencila-node-list-default>.sc-stencila-node-list-default:not(figcaption):last-child,.sc-stencila-node-list-default-h figure.sc-stencila-node-list-default>.sc-stencila-node-list-default:not(figcaption):last-child,stencila-node-list.sc-stencila-node-list-default-s>[slot=outputs]>:not(figcaption):last-child,stencila-node-list .sc-stencila-node-list-default-s>[slot=outputs]>:not(figcaption):last-child,stencila-node-list.sc-stencila-node-list-default>*.sc-stencila-node-list-default>.sc-stencila-node-list-default:not(figcaption):last-child,stencila-node-list.sc-stencila-node-list-default figure.sc-stencila-node-list-default>.sc-stencila-node-list-default:not(figcaption):last-child{margin-bottom:0}";var materialNodeListCss="*.sc-stencila-node-list-material,.sc-stencila-node-list-material:after,.sc-stencila-node-list-material:before{-webkit-box-sizing:border-box;box-sizing:border-box;border:0 solid}html.sc-stencila-node-list-material{font-size:16px}.hidden.sc-stencila-node-list-material{display:none}code.sc-stencila-node-list-material,code[class*=language-].sc-stencila-node-list-material,output.sc-stencila-node-list-material{font-family:monospace;font-family:var(--font-family-mono,monospace);font-size:75%}pre.sc-stencila-node-list-material{border:1px solid #e2e8f0;border-color:var(--color-neutral-300,#e2e8f0);border-radius:.25rem;padding:.5rem;margin:.5rem;overflow:auto}.sc-stencila-node-list-material-h,stencila-node-list.sc-stencila-node-list-material{display:block}.sc-stencila-node-list-material-h .hidden.sc-stencila-node-list-material+.sc-stencila-node-list-material:nth-child(2),.sc-stencila-node-list-material-h>.sc-stencila-node-list-material:first-child,stencila-node-list.sc-stencila-node-list-material .hidden.sc-stencila-node-list-material+.sc-stencila-node-list-material:nth-child(2),stencila-node-list.sc-stencila-node-list-material>.sc-stencila-node-list-material:first-child{padding-top:0;margin-top:0;border-top-width:0}.sc-stencila-node-list-material-h>.sc-stencila-node-list-material:last-child,stencila-node-list.sc-stencila-node-list-material>.sc-stencila-node-list-material:last-child{margin-bottom:0}.sc-stencila-node-list-material-h .hidden.sc-stencila-node-list-material,stencila-node-list.sc-stencila-node-list-material .hidden.sc-stencila-node-list-material{display:none}.sc-stencila-node-list-material-h .emptyContentMessage.sc-stencila-node-list-material,stencila-node-list.sc-stencila-node-list-material .emptyContentMessage.sc-stencila-node-list-material{color:#718096;color:var(--color-neutral-600,#718096)}.sc-stencila-node-list-material-h stencila-code-error.sc-stencila-node-list-material,stencila-node-list.sc-stencila-node-list-material stencila-code-error.sc-stencila-node-list-material{border-width:0}.sc-stencila-node-list-material-h stencila-image-object.sc-stencila-node-list-material,stencila-node-list.sc-stencila-node-list-material stencila-image-object.sc-stencila-node-list-material{display:block;height:auto;max-width:100%}.sc-stencila-node-list-material-h .sc-stencila-node-list-material-s>[slot=outputs],.sc-stencila-node-list-material-h>*.sc-stencila-node-list-material,.sc-stencila-node-list-material-h figure.sc-stencila-node-list-material,stencila-node-list.sc-stencila-node-list-material-s>[slot=outputs],stencila-node-list .sc-stencila-node-list-material-s>[slot=outputs],stencila-node-list.sc-stencila-node-list-material>*.sc-stencila-node-list-material,stencila-node-list.sc-stencila-node-list-material figure.sc-stencila-node-list-material{padding:0;margin:0;overflow:auto}.sc-stencila-node-list-material-h .sc-stencila-node-list-material-s>[slot=outputs]:first-child,.sc-stencila-node-list-material-h>.sc-stencila-node-list-material:first-child,.sc-stencila-node-list-material-h figure.sc-stencila-node-list-material:first-child,stencila-node-list.sc-stencila-node-list-material-s>[slot=outputs]:first-child,stencila-node-list .sc-stencila-node-list-material-s>[slot=outputs]:first-child,stencila-node-list.sc-stencila-node-list-material>.sc-stencila-node-list-material:first-child,stencila-node-list.sc-stencila-node-list-material figure.sc-stencila-node-list-material:first-child{margin-top:0}.sc-stencila-node-list-material-h .sc-stencila-node-list-material-s>[slot=outputs]:last-child,.sc-stencila-node-list-material-h>.sc-stencila-node-list-material:last-child,.sc-stencila-node-list-material-h figure.sc-stencila-node-list-material:last-child,stencila-node-list.sc-stencila-node-list-material-s>[slot=outputs]:last-child,stencila-node-list .sc-stencila-node-list-material-s>[slot=outputs]:last-child,stencila-node-list.sc-stencila-node-list-material>.sc-stencila-node-list-material:last-child,stencila-node-list.sc-stencila-node-list-material figure.sc-stencila-node-list-material:last-child{margin-bottom:0}.sc-stencila-node-list-material-h .sc-stencila-node-list-material-s>[slot=outputs] pre,.sc-stencila-node-list-material-h>*.sc-stencila-node-list-material pre.sc-stencila-node-list-material,.sc-stencila-node-list-material-h figure.sc-stencila-node-list-material pre.sc-stencila-node-list-material,stencila-node-list.sc-stencila-node-list-material-s>[slot=outputs] pre,stencila-node-list .sc-stencila-node-list-material-s>[slot=outputs] pre,stencila-node-list.sc-stencila-node-list-material>*.sc-stencila-node-list-material pre.sc-stencila-node-list-material,stencila-node-list.sc-stencila-node-list-material figure.sc-stencila-node-list-material pre.sc-stencila-node-list-material{padding:0;margin:0;border-width:0}.sc-stencila-node-list-material-h .sc-stencila-node-list-material-s>[slot=outputs] img,.sc-stencila-node-list-material-h>*.sc-stencila-node-list-material img.sc-stencila-node-list-material,.sc-stencila-node-list-material-h figure.sc-stencila-node-list-material img.sc-stencila-node-list-material,stencila-node-list.sc-stencila-node-list-material-s>[slot=outputs] img,stencila-node-list .sc-stencila-node-list-material-s>[slot=outputs] img,stencila-node-list.sc-stencila-node-list-material>*.sc-stencila-node-list-material img.sc-stencila-node-list-material,stencila-node-list.sc-stencila-node-list-material figure.sc-stencila-node-list-material img.sc-stencila-node-list-material{border-bottom-width:0;border-left-width:0;border-right-width:0}.sc-stencila-node-list-material-h .sc-stencila-node-list-material-s>[slot=outputs]>:not(figcaption),.sc-stencila-node-list-material-h>*.sc-stencila-node-list-material>.sc-stencila-node-list-material:not(figcaption),.sc-stencila-node-list-material-h figure.sc-stencila-node-list-material>.sc-stencila-node-list-material:not(figcaption),stencila-node-list.sc-stencila-node-list-material-s>[slot=outputs]>:not(figcaption),stencila-node-list .sc-stencila-node-list-material-s>[slot=outputs]>:not(figcaption),stencila-node-list.sc-stencila-node-list-material>*.sc-stencila-node-list-material>.sc-stencila-node-list-material:not(figcaption),stencila-node-list.sc-stencila-node-list-material figure.sc-stencila-node-list-material>.sc-stencila-node-list-material:not(figcaption){padding-top:.75rem;margin-top:.75rem;margin-bottom:.75rem;border:0 dashed #e2e8f0;border-color:var(--color-neutral-300,#e2e8f0);border-top:1px dashed var(--color-neutral-300,#e2e8f0)}.sc-stencila-node-list-material-h .sc-stencila-node-list-material-s>[slot=outputs]>:not(figcaption):first-child,.sc-stencila-node-list-material-h>*.sc-stencila-node-list-material>.sc-stencila-node-list-material:not(figcaption):first-child,.sc-stencila-node-list-material-h figure.sc-stencila-node-list-material>.sc-stencila-node-list-material:not(figcaption):first-child,stencila-node-list.sc-stencila-node-list-material-s>[slot=outputs]>:not(figcaption):first-child,stencila-node-list .sc-stencila-node-list-material-s>[slot=outputs]>:not(figcaption):first-child,stencila-node-list.sc-stencila-node-list-material>*.sc-stencila-node-list-material>.sc-stencila-node-list-material:not(figcaption):first-child,stencila-node-list.sc-stencila-node-list-material figure.sc-stencila-node-list-material>.sc-stencila-node-list-material:not(figcaption):first-child{padding-top:0;margin-top:0;border-top-width:0}.sc-stencila-node-list-material-h .sc-stencila-node-list-material-s>[slot=outputs]>:not(figcaption):last-child,.sc-stencila-node-list-material-h>*.sc-stencila-node-list-material>.sc-stencila-node-list-material:not(figcaption):last-child,.sc-stencila-node-list-material-h figure.sc-stencila-node-list-material>.sc-stencila-node-list-material:not(figcaption):last-child,stencila-node-list.sc-stencila-node-list-material-s>[slot=outputs]>:not(figcaption):last-child,stencila-node-list .sc-stencila-node-list-material-s>[slot=outputs]>:not(figcaption):last-child,stencila-node-list.sc-stencila-node-list-material>*.sc-stencila-node-list-material>.sc-stencila-node-list-material:not(figcaption):last-child,stencila-node-list.sc-stencila-node-list-material figure.sc-stencila-node-list-material>.sc-stencila-node-list-material:not(figcaption):last-child{margin-bottom:0}";var slots$2={nodes:"outputs",errors:"errors"};var OutputsList=function(){function e(e){var t=this;registerInstance(this,e);this.nodes=undefined;this.isEmpty=this.nodes===undefined||this.nodes!==undefined&&_Array.isEmpty(this.nodes);this.checkIfEmpty=function(){var e;if(t.nodes!==undefined){e=_Array.isEmpty(t.nodes);t.isEmpty=e;return e}var r=t.el.querySelector("[slot="+slots$2.nodes+"]");e=r===null?true:r.innerHTML.trim()==="";t.isEmpty=e;return e};this.emptyOutputMessage="No output to show";this.renderNodes=function(e){return e===null||e===void 0?void 0:e.map((function(e){return t.renderNode(e)}))};this.renderNode=function(e){if(zt(e)){var t=typeof e==="string"||typeof e==="number"?e:JSON.stringify(e);return h("pre",null,h("output",null,t))}else if(Ut(e)){return h("pre",null,h("output",null,e.text))}else if(Nt("ImageObject",e)){return h("stencila-image-object",{image:e})}else if(Nt("Datatable",e)){return h("stencila-data-table",{table:e})}return JSON.stringify(e)}}e.prototype.componentDidLoad=function(){this.checkIfEmpty()};e.prototype.componentWillUpdate=function(){this.checkIfEmpty()};e.prototype.render=function(){return h(Host,null,h("div",{class:{hidden:this.nodes!==undefined,slot:true}},h("slot",{name:slots$2.nodes})),this.isEmpty&&h("em",{class:"emptyContentMessage"},this.emptyOutputMessage),!this.isEmpty&&h("figure",null,this.renderNodes(this.nodes)),h("slot",null))};Object.defineProperty(e.prototype,"el",{get:function(){return getElement(this)},enumerable:false,configurable:true});return e}();OutputsList.style={default:defaultNodeListCss,material:materialNodeListCss};export{ActionMenu as stencila_action_menu,Error$1 as stencila_code_error,Editor as stencila_editor,OutputsList as stencila_node_list};